import 'dart:convert';
import 'dart:developer';
import 'dart:html';
import 'dart:io';

import 'package:auto_size_text/auto_size_text.dart';
import 'package:dropdown_button2/dropdown_button2.dart';
import 'package:file_saver/file_saver.dart';
import 'package:fine_bar_chart/fine_bar_chart.dart';
import 'package:fl_pin_code/pin_code.dart';
import 'package:fl_pin_code/styles.dart';
import 'package:flutter/cupertino.dart';
import 'package:flutter/gestures.dart';
import 'package:flutter/material.dart';
import 'package:flutter/services.dart';
import 'package:flutter/src/widgets/container.dart';
import 'package:flutter/src/widgets/framework.dart';
import 'package:flutter_admin_scaffold/admin_scaffold.dart';
import 'package:group_radio_button/group_radio_button.dart';
import 'package:path_provider/path_provider.dart';
import 'package:pdf/pdf.dart';
import 'package:printing/printing.dart';
import 'package:shared_preferences/shared_preferences.dart';
import 'package:syncfusion_flutter_pdf/pdf.dart';

import '../Account/Account_Screen.dart';
import '../AdminScaffold/AdminScaffold.dart';
import '../ChaoArea/ChaoArea_Screen.dart';
import '../Constant/Myconstant.dart';
import '../Home/Home_Screen.dart';
import '../INSERT_Log/Insert_log.dart';
import '../Manage/Manage_Screen.dart';
import '../Model/GetArea_Model.dart';
import '../Model/GetContractx_Model.dart';
import '../Model/GetCustomer_Model.dart';
import '../Model/GetRenTal_Model.dart';
import '../Model/GetTeNant_Model.dart';
import '../Model/Get_SCReportTotal_Model.dart';
import '../Model/trans_re_bill_history_model.dart';
import '../Model/trans_re_bill_model.dart';
import '../PDF/pdf_Quotation.dart';
import '../PeopleChao/PeopleChao_Screen.dart';
import '../Responsive/responsive.dart';
import '../Setting/SettingScreen.dart';
import '../Style/colors.dart';
import 'package:syncfusion_flutter_xlsio/xlsio.dart' as x;
import 'package:pdf/widgets.dart' as pw;
import 'dart:math' as math;
import 'package:intl/intl.dart';
import 'package:http/http.dart' as http;

import 'Excel_Bankmovemen_Report_cm.dart';
import 'Excel_Custo_Report_cm.dart';
import 'Excel_Daily_Report_cm.dart';
import 'Excel_Daily_Report_cus_cm.dart';
import 'Excel_Expense_Report_cm.dart';
import 'Excel_Income_Report_cm.dart';
import 'Excel_Tax_Report_cm.dart';
import 'Pdf_Bank_Report_cm.dart';
import 'Pdf_Expen_Report_cm.dart';
import 'Pdf_IC_Report_cm.dart';
import 'Pdf__Daily_Report_cm.dart';

class Report_cm_Screen extends StatefulWidget {
  const Report_cm_Screen({super.key});

  @override
  State<Report_cm_Screen> createState() => _Report_cm_ScreenState();
}

class _Report_cm_ScreenState extends State<Report_cm_Screen> {
  DateTime datex = DateTime.now();
  int Status_ = 1;
  int PerandDow_ = 1;
  var Value_selectDate;
  var Value_selectDate_daly_cus;
  var Value_selectDate1;
  var Value_selectDate2;
///////-------------------------------------------
  List<Map<String, dynamic>> datalist001_Incom = [];
  List<RenTalModel> renTalModels = [];
  List<CustomerModel> customerModels = [];
  List<ContractxModel> contractxModels = [];
  List<TeNantModel> teNantModels = [];
  List<TeNantModel> _teNantModels = <TeNantModel>[];
  List<AreaModel> areaModels = [];
  List<AreaModel> areaModels1 = [];
  List<AreaModel> areaModels2 = [];
  List<AreaModel> areaModels3 = [];
  // List<CustomerModel> customerModels = [];
  List<TransReBillHistoryModel> _TransReBillHistoryModels = [];
  List<TransReBillModel> _TransReBillModels = [];
  List<TransReBillModel> _TransReBillModels_cus = [];
  List<SCReportTotalModel> sCReportTotalModels = [];
  List<SCReportTotalModel> sCReportTotalModels2 = [];

  List<TransReBillModel> _TransReBillModels_Income = [];
  List<TransReBillHistoryModel> _TransReBillHistoryModels_Income = [];
  List<TransReBillModel> _TransReBillModels_Bankmovemen = [];
  List<TransReBillHistoryModel> _TransReBillHistoryModels_Bankmovemen = [];
  late List<List<dynamic>> TransReBillModels_Income;
  late List<List<dynamic>> TransReBillModels_Bankmovemen;
  late List<List<dynamic>> TransReBillModels;
  late List<List<dynamic>> TransReBillModels_cus;

  List<List<TransReBillHistoryModel>> custo_TransReBillHistoryModels = [];

  //////////////////////----------------------------------
  String? renTal_user, renTal_name, zone_ser, zone_name, total1_, total2_;
  String? numinvoice;
  int select_1 = 0;
  int select_2 = 0;
  int TransReBillModel_index = 0;
  double sum_pvat = 0.00,
      sum_vat = 0.00,
      sum_wht = 0.00,
      sum_amt = 0.00,
      sum_dis = 0.00,
      sum_disamt = 0.00,
      sum_disp = 0;
  var nFormat = NumberFormat("#,##0.00", "en_US");
  var nFormat2 = NumberFormat("#,##0", "en_US");
  // late List<List<TransReBillModel>> TransReBillModels;

  String _verticalGroupValue_PassW = "EXCEL";
  String _verticalGroupValue_NameFile = "จากระบบ";
  String Value_Report = ' ';
  String NameFile_ = '';
  String Pre_and_Dow = '';
  final _formKey = GlobalKey<FormState>();
  final FormNameFile_text = TextEditingController();
  ///////---------------------------------------------------->
  String? rtname,
      type,
      typex,
      renname,
      bill_name,
      bill_addr,
      bill_tax,
      bill_tel,
      bill_email,
      expbill,
      expbill_name,
      bill_default,
      bill_tser,
      foder;
  List newValuePDFimg = [];
  String? bills_name_;
  String? name_slip, name_slip_ser;
  String? base64_Slip, fileName_Slip;
  String? YE_;
  String? Mon_;
  List<String> YE_Th = [];
  List<String> Mont_Th = [];
  String? ciddoc_Cusdaly_Cm;
  @override
  void initState() {
    super.initState();
    // GC_coutumer();
    checkPreferance();
    read_GC_rental();
    // read_customer();
    read_GC_area1();
    read_GC_area2();
    red_SCReport_Total1();
    red_SCReport_Total2();
    GC_coutumer_daly_CM();
    // red_Trans_billIncome();
    // red_Trans_bill();
    TransReBillModels_Income = [];
    TransReBillModels_Bankmovemen = [];
    TransReBillModels = [];
    TransReBillModels_cus = [];
    rent_CM = [];
    tank_CM = [];
    electricity_CM = [];
    MOMO_CM = [];
    rent_area_CM = [];

    rent_CM_cus = [];
    tank_CM_cus = [];
    electricity_CM_cus = [];
    MOMO_CM_cus = [];
    rent_area_CM_cus = [];
    // contractx_expneme = [];
    coutumer_rent_CM = [];
    coutumer_tank_CM = [];
    coutumer_electricity_CM = [];
    coutumer_MOMO_CM = [];
    coutumer_rent_area_CM = [];
    coutumer_total_sum_CM = [];

    // fetchAlbum();
  }

  Future<Null> checkPreferance() async {
    int currentYear = DateTime.now().year;
    for (int i = currentYear; i >= currentYear - 10; i--) {
      YE_Th.add(i.toString());
    }
    for (int i2 = 0; i2 < 12; i2++) {
      Mont_Th.add('${i2 + 1}');
    }
    SharedPreferences preferences = await SharedPreferences.getInstance();
    setState(() {
      renTal_user = preferences.getString('renTalSer');
      renTal_name = preferences.getString('renTalName');
    });
  }

  Future<Null> read_GC_rental() async {
    if (renTalModels.isNotEmpty) {
      renTalModels.clear();
    }

    SharedPreferences preferences = await SharedPreferences.getInstance();
    var ren = preferences.getString('renTalSer');
    String url =
        '${MyConstant().domain}/GC_rental_setring.php?isAdd=true&ren=$ren';
    renTal_name = preferences.getString('renTalName');
    try {
      var response = await http.get(Uri.parse(url));

      var result = json.decode(response.body);
      // print(result);
      if (result != null) {
        for (var map in result) {
          RenTalModel renTalModel = RenTalModel.fromJson(map);
          var rtnamex = renTalModel.rtname!.trim();
          var typexs = renTalModel.type!.trim();
          var typexx = renTalModel.typex!.trim();
          var bill_namex = renTalModel.bill_name!.trim();
          var bill_addrx = renTalModel.bill_addr!.trim();
          var bill_taxx = renTalModel.bill_tax!.trim();
          var bill_telx = renTalModel.bill_tel!.trim();
          var bill_emailx = renTalModel.bill_email!.trim();
          var bill_defaultx = renTalModel.bill_default;
          var bill_tserx = renTalModel.tser;
          var name = renTalModel.pn!.trim();
          var foderx = renTalModel.dbn;
          setState(() {
            foder = foderx;
            rtname = rtnamex;
            type = typexs;
            typex = typexx;
            renname = name;
            bill_name = bill_namex;
            bill_addr = bill_addrx;
            bill_tax = bill_taxx;
            bill_tel = bill_telx;
            bill_email = bill_emailx;
            bill_default = bill_defaultx;
            bill_tser = bill_tserx;
            renTalModels.add(renTalModel);
            if (bill_defaultx == 'P') {
              bills_name_ = 'บิลธรรมดา';
            } else {
              bills_name_ = 'ใบกำกับภาษี';
            }
          });
        }

        for (int index = 0; index < 1; index++) {
          if (renTalModels[0].imglogo!.trim() == '') {
            // newValuePDFimg.add(
            //     'https://png.pngtree.com/png-vector/20190820/ourmid/pngtree-no-image-vector-illustration-isolated-png-image_1694547.jpg');
          } else {
            newValuePDFimg.add(
                '${MyConstant().domain}/files/$foder/logo/${renTalModels[0].imglogo!.trim()}');
          }
        }
      } else {}
    } catch (e) {}
    print('name>>>>>  $renname');
  }

/////////////////----------------------------------->(รวมรายรับ ชำระแล้ว)
  Future<Null> red_SCReport_Total1() async {
    if (sCReportTotalModels.length != 0) {
      setState(() {
        sCReportTotalModels.clear();
      });
    }
    SharedPreferences preferences = await SharedPreferences.getInstance();
    var ren = preferences.getString('renTalSer');
    // var ciddoc = widget.Get_Value_cid;
    // var qutser = widget.Get_Value_NameShop_index;

    // String url =
    //     '${MyConstant().domain}/GC_bill_pay_BC.php?isAdd=true&ren=$ren';
    String url =
        '${MyConstant().domain}/GC_SCReport_total1.php?isAdd=true&ren=$ren';
    try {
      var response = await http.get(Uri.parse(url));

      var result = json.decode(response.body);
      // print('result $ciddoc');
      if (result.toString() != 'null') {
        for (var map in result) {
          SCReportTotalModel sCReportTotalModel =
              SCReportTotalModel.fromJson(map);

          setState(() {
            total1_ = sCReportTotalModel.total.toString();
            sCReportTotalModels.add(sCReportTotalModel);

            // _TransBillModels.add(_TransBillModel);
          });
        }

        print('red_SCReport_Total1 ${sCReportTotalModels.length}');
      }
    } catch (e) {}
  }

/////////////////----------------------------------->(รวมรายรับ ทั้งหมด)
  Future<Null> red_SCReport_Total2() async {
    if (sCReportTotalModels2.length != 0) {
      setState(() {
        sCReportTotalModels2.clear();
      });
    }
    SharedPreferences preferences = await SharedPreferences.getInstance();
    var ren = preferences.getString('renTalSer');
    // var ciddoc = widget.Get_Value_cid;
    // var qutser = widget.Get_Value_NameShop_index;

    // String url =
    //     '${MyConstant().domain}/GC_bill_pay_BC.php?isAdd=true&ren=$ren';
    String url =
        '${MyConstant().domain}/GC_SCReport_total2.php?isAdd=true&ren=$ren';
    try {
      var response = await http.get(Uri.parse(url));

      var result = json.decode(response.body);
      // print('result $ciddoc');
      if (result.toString() != 'null') {
        for (var map in result) {
          SCReportTotalModel sCReportTotalModel =
              SCReportTotalModel.fromJson(map);
          setState(() {
            total2_ = sCReportTotalModel.total.toString();
            sCReportTotalModels2.add(sCReportTotalModel);

            // _TransBillModels.add(_TransBillModel);
          });
        }

        print('red_SCReport_Total1 ${sCReportTotalModels.length}');
      }
    } catch (e) {}
  }

///////////--------------------------------------------->(รายงานรายรับ)
  Future<Null> red_Trans_billIncome() async {
    if (_TransReBillModels_Income.length != 0) {
      setState(() {
        _TransReBillModels_Income.clear();
        TransReBillModels_Income = [];
      });
    }
    SharedPreferences preferences = await SharedPreferences.getInstance();
    var ren = preferences.getString('renTalSer');
    // var ciddoc = widget.Get_Value_cid;
    // var qutser = widget.Get_Value_NameShop_index;

    // String url =
    //     '${MyConstant().domain}/GC_bill_pay_BC.php?isAdd=true&ren=$ren';
    String url =
        '${MyConstant().domain}/GC_bill_pay_BC_IncomeReport.php?isAdd=true&ren=$ren&sdate=$Value_selectDate1&ldate=$Value_selectDate2';
    try {
      var response = await http.get(Uri.parse(url));

      var result = json.decode(response.body);
      // print('result $ciddoc');
      if (result.toString() != 'null') {
        for (var map in result) {
          TransReBillModel _TransReBillModels_Incomes =
              TransReBillModel.fromJson(map);
          setState(() {
            _TransReBillModels_Income.add(_TransReBillModels_Incomes);

            // _TransBillModels.add(_TransBillModel);
          });
        }

        print('result ${_TransReBillModels_Income.length}');
        // setState(() {
        //   TransReBillModels =
        //       List.generate(_TransReBillModels.length, (_) => []);
        // });
        TransReBillModels_Income =
            List.generate(_TransReBillModels_Income.length, (_) => []);
        red_Trans_selectIncome();
        // for (int index = 0; index < _TransReBillModels.length; index++) {
        //   red_Trans_select(index);
        // }
      }
    } catch (e) {}
  }

///////////--------------------------------------------->(รายงานรายรับ)
  Future<Null> red_Trans_selectIncome() async {
    for (int index = 0; index < _TransReBillModels_Income.length; index++) {
      if (_TransReBillHistoryModels_Income.length != 0) {
        setState(() {
          _TransReBillHistoryModels_Income.clear();

          sum_pvat = 0;
          sum_vat = 0;
          sum_wht = 0;
          sum_amt = 0;
          // sum_disamt = 0;
          // sum_disp = 0;
        });
      }
      if (TransReBillModels_Income[index].length != 0) {
        TransReBillModels_Income[index].clear();
      }

      SharedPreferences preferences = await SharedPreferences.getInstance();
      var ren = preferences.getString('renTalSer');
      var user = preferences.getString('ser');
      var ciddoc = _TransReBillModels_Income[index].ser;
      var qutser = _TransReBillModels_Income[index].ser_in;
      var docnoin = (_TransReBillModels_Income[index].docno == null)
          ? _TransReBillModels_Income[index].refno
          : _TransReBillModels_Income[index].docno;
      String url =
          '${MyConstant().domain}/GC_bill_pay_history_DailyReport.php?isAdd=true&ren=$ren&user=$user&ciddoc=$ciddoc&docnoin=$docnoin';
      try {
        var response = await http.get(Uri.parse(url));

        var result = json.decode(response.body);
        print(result);
        if (result.toString() != 'null') {
          for (var map in result) {
            TransReBillHistoryModel _TransReBillHistoryModels_Incomes =
                TransReBillHistoryModel.fromJson(map);

            var sum_pvatx =
                double.parse(_TransReBillHistoryModels_Incomes.pvat!);
            var sum_vatx = double.parse(_TransReBillHistoryModels_Incomes.vat!);
            var sum_whtx = double.parse(_TransReBillHistoryModels_Incomes.wht!);
            var sum_amtx =
                double.parse(_TransReBillHistoryModels_Incomes.total!);
            // var sum_disamtx = double.parse(_InvoiceHistoryModel.disendbill!);
            // var sum_dispx = double.parse(_InvoiceHistoryModel.disendbillper!);
            var numinvoiceent = _TransReBillHistoryModels_Incomes.docno;
            setState(() {
              sum_pvat = sum_pvat + sum_pvatx;
              sum_vat = sum_vat + sum_vatx;
              sum_wht = sum_wht + sum_whtx;
              sum_amt = sum_amt + sum_amtx;
              // sum_disamt = sum_disamtx;
              // sum_disp = sum_dispx;
              numinvoice = _TransReBillHistoryModels_Incomes.docno;
              _TransReBillHistoryModels_Income.add(
                  _TransReBillHistoryModels_Incomes);
              TransReBillModels_Income[index]
                  .add(_TransReBillHistoryModels_Incomes);
            });
          }
          // PDf_AdddataList_bill_Income();
        }
        // setState(() {
        //   red_Invoice();
        // });
      } catch (e) {}
    }
  }

///////////--------------------------------------------->(รายงานการเคลื่อนไหวธนาคาร)
  Future<Null> red_Trans_billMovemen() async {
    if (_TransReBillModels_Bankmovemen.length != 0) {
      setState(() {
        _TransReBillModels_Bankmovemen.clear();
        TransReBillModels_Bankmovemen = [];
      });
    }
    SharedPreferences preferences = await SharedPreferences.getInstance();
    var ren = preferences.getString('renTalSer');
    // var ciddoc = widget.Get_Value_cid;
    // var qutser = widget.Get_Value_NameShop_index;

    // String url =
    //     '${MyConstant().domain}/GC_bill_pay_BC.php?isAdd=true&ren=$ren';
    String url =
        '${MyConstant().domain}/GC_bill_pay_BC_BankmovemenReport_CMma.php?isAdd=true&ren=$ren&sdate=$Value_selectDate1&ldate=$Value_selectDate2';
    try {
      var response = await http.get(Uri.parse(url));

      var result = json.decode(response.body);
      // print('result $ciddoc');
      if (result.toString() != 'null') {
        for (var map in result) {
          TransReBillModel _TransReBillModels_Bankmovemens =
              TransReBillModel.fromJson(map);
          setState(() {
            _TransReBillModels_Bankmovemen.add(_TransReBillModels_Bankmovemens);

            // _TransBillModels.add(_TransBillModel);
          });
        }

        print('result ${_TransReBillModels_Bankmovemen.length}');
        // setState(() {
        //   TransReBillModels =
        //       List.generate(_TransReBillModels.length, (_) => []);
        // });
        TransReBillModels_Bankmovemen =
            List.generate(_TransReBillModels_Bankmovemen.length, (_) => []);
        red_Trans_selectMovemen();
        // for (int index = 0; index < _TransReBillModels.length; index++) {
        //   red_Trans_select(index);
        // }
      }
    } catch (e) {}
  }

  ///////////--------------------------------------------->(รายงานการเคลื่อนไหวธนาคาร)
  Future<Null> red_Trans_selectMovemen() async {
    for (int index = 0;
        index < _TransReBillModels_Bankmovemen.length;
        index++) {
      if (_TransReBillHistoryModels_Bankmovemen.length != 0) {
        setState(() {
          _TransReBillHistoryModels_Bankmovemen.clear();

          sum_pvat = 0;
          sum_vat = 0;
          sum_wht = 0;
          sum_amt = 0;
          // sum_disamt = 0;
          // sum_disp = 0;
        });
      }
      if (TransReBillModels_Bankmovemen[index].length != 0) {
        TransReBillModels_Bankmovemen[index].clear();
      }

      SharedPreferences preferences = await SharedPreferences.getInstance();
      var ren = preferences.getString('renTalSer');
      var user = preferences.getString('ser');
      var ciddoc = _TransReBillModels_Bankmovemen[index].ser;
      var qutser = _TransReBillModels_Bankmovemen[index].ser_in;
      var docnoin = (_TransReBillModels_Bankmovemen[index].docno == null)
          ? _TransReBillModels_Bankmovemen[index].refno
          : _TransReBillModels_Bankmovemen[index].docno;
      String url =
          '${MyConstant().domain}/GC_bill_pay_history_MovemenReport_CMma.php?isAdd=true&ren=$ren&user=$user&ciddoc=$ciddoc&docnoin=$docnoin';
      try {
        var response = await http.get(Uri.parse(url));

        var result = json.decode(response.body);
        print(result);
        if (result.toString() != 'null') {
          for (var map in result) {
            TransReBillHistoryModel _TransReBillHistoryModels_Bankmovemens =
                TransReBillHistoryModel.fromJson(map);

            var sum_pvatx =
                double.parse(_TransReBillHistoryModels_Bankmovemens.pvat!);
            var sum_vatx =
                double.parse(_TransReBillHistoryModels_Bankmovemens.vat!);
            var sum_whtx =
                double.parse(_TransReBillHistoryModels_Bankmovemens.wht!);
            var sum_amtx =
                double.parse(_TransReBillHistoryModels_Bankmovemens.total!);
            // var sum_disamtx = double.parse(_InvoiceHistoryModel.disendbill!);
            // var sum_dispx = double.parse(_InvoiceHistoryModel.disendbillper!);
            var numinvoiceent = _TransReBillHistoryModels_Bankmovemens.docno;
            setState(() {
              sum_pvat = sum_pvat + sum_pvatx;
              sum_vat = sum_vat + sum_vatx;
              sum_wht = sum_wht + sum_whtx;
              sum_amt = sum_amt + sum_amtx;
              // sum_disamt = sum_disamtx;
              // sum_disp = sum_dispx;
              numinvoice = _TransReBillHistoryModels_Bankmovemens.docno;
              _TransReBillHistoryModels_Bankmovemen.add(
                  _TransReBillHistoryModels_Bankmovemens);
              TransReBillModels_Bankmovemen[index]
                  .add(_TransReBillHistoryModels_Bankmovemens);
            });
          }
          // PDf_AdddataList_bill_Income();
        }
        // setState(() {
        //   red_Invoice();
        // });
      } catch (e) {}
    }
  }

///////////////------------------------------------------------------------->
  // void PDf_AdddataList_bill_Income() async {
  //   if (datalist001_Incom.length > 0) {
  //     setState(() {
  //       datalist001_Incom = [];
  //     });
  //   }
  //   for (int index1 = 0; index1 < _TransReBillModels_Income.length; index1++) {
  //     for (int index2 = 0;
  //         index2 < TransReBillModels_Income[index1].length;
  //         index2++) {
  //       //   _TransReBillModels_Income[index1].docno == '' ? '${index1 + 1}. เลขที่: ${_TransReBillModels_Income[index1].docno}' : '${index1 + 1}. เลขที่: ${_TransReBillModels_Income[index1].refno}',
  //       Map<String, dynamic> newHeader = {
  //         'index': '${(index2 + 1)}',
  //         'docno': _TransReBillModels_Income[index1].docno == ''
  //             ? '${_TransReBillModels_Income[index1].docno}'
  //             : '${_TransReBillModels_Income[index1].refno}',
  //         'date': '${TransReBillModels_Income[index1][index2].date}',
  //         'type': '${TransReBillModels_Income[index1][index2].type}',
  //         'expname': '${TransReBillModels_Income[index1][index2].expname}',
  //         'nvat': '${TransReBillModels_Income[index1][index2].nvat}',
  //         'vtype': '${TransReBillModels_Income[index1][index2].vtype}',
  //         'vat':
  //             '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].vat!))}',
  //         'ramt': (TransReBillModels_Income[index1][index2].ramt.toString() ==
  //                 'null')
  //             ? '-'
  //             : '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].ramt!))}',
  //         'ramtd': (TransReBillModels_Income[index1][index2].ramtd.toString() ==
  //                 'null')
  //             ? '-'
  //             : '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].ramtd!))}',
  //         'amt':
  //             '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].amt!))}',
  //         'total':
  //             '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].total!))}',
  //         'sname': (TransReBillModels_Income[index1][index2].sname == null)
  //             ? '${TransReBillModels_Income[index1][index2].remark}'
  //             : '${TransReBillModels_Income[index1][index2].sname}'
  //       };
  //       datalist001_Incom.add(newHeader);
  //     }
  //   }
  // }

///////////--------------------------------------------->(รายงานประจำวัน)
  Future<Null> red_Trans_bill() async {
    if (_TransReBillModels.length != 0) {
      setState(() {
        _TransReBillModels.clear();
        TransReBillModels = [];
      });
    }
    SharedPreferences preferences = await SharedPreferences.getInstance();
    var ren = preferences.getString('renTalSer');
    // var ciddoc = widget.Get_Value_cid;
    // var qutser = widget.Get_Value_NameShop_index;

    // String url =
    //     '${MyConstant().domain}/GC_bill_pay_BC.php?isAdd=true&ren=$ren';
    String url =
        '${MyConstant().domain}/GC_bill_pay_BC_DailyReport_CMma.php?isAdd=true&ren=$ren&date=$Value_selectDate';
    try {
      var response = await http.get(Uri.parse(url));

      var result = json.decode(response.body);
      // print('result $ciddoc');
      if (result.toString() != 'null') {
        for (var map in result) {
          TransReBillModel transReBillModel = TransReBillModel.fromJson(map);
          setState(() {
            _TransReBillModels.add(transReBillModel);

            // _TransBillModels.add(_TransBillModel);
          });
        }

        print('result ${_TransReBillModels.length}');
        // setState(() {
        //   TransReBillModels =
        //       List.generate(_TransReBillModels.length, (_) => []);
        // });
        TransReBillModels = List.generate(_TransReBillModels.length, (_) => []);
        rent_CM = List.generate(_TransReBillModels.length, (_) => []);
        tank_CM = List.generate(_TransReBillModels.length, (_) => []);
        electricity_CM = List.generate(_TransReBillModels.length, (_) => []);
        MOMO_CM = List.generate(_TransReBillModels.length, (_) => []);
        rent_area_CM = List.generate(_TransReBillModels.length, (_) => []);

        red_Trans_select();
        // for (int index = 0; index < _TransReBillModels.length; index++) {
        //   red_Trans_select(index);
        // }
      }
    } catch (e) {}
  }

///////////--------------------------------------------->(รายงานประจำวันรายบุคคล)
  late List<List<dynamic>> rent_CM_cus;
  late List<List<dynamic>> tank_CM_cus;
  late List<List<dynamic>> electricity_CM_cus;
  late List<List<dynamic>> MOMO_CM_cus;
  late List<List<dynamic>> rent_area_CM_cus;
  Future<Null> red_Trans_bill_custo_Cm() async {
    if (_TransReBillModels_cus.length != 0) {
      setState(() {
        _TransReBillModels_cus.clear();
        TransReBillModels_cus = [];
      });
    }
    SharedPreferences preferences = await SharedPreferences.getInstance();
    var ren = preferences.getString('renTalSer');
    // var ciddoc = widget.Get_Value_cid;
    // var qutser = widget.Get_Value_NameShop_index;

    // String url =
    //     '${MyConstant().domain}/GC_bill_pay_BC.php?isAdd=true&ren=$ren';
    String url =
        '${MyConstant().domain}/GC_bill_pay_BC_DailyReport_Custo_CMma.php?isAdd=true&ren=$ren&date=$Value_selectDate_daly_cus&ciddoc=$ciddoc_Cusdaly_Cm';
    try {
      var response = await http.get(Uri.parse(url));

      var result = json.decode(response.body);
      // print('result $ciddoc');
      if (result.toString() != 'null') {
        for (var map in result) {
          TransReBillModel transReBillModel = TransReBillModel.fromJson(map);
          setState(() {
            _TransReBillModels_cus.add(transReBillModel);

            // _TransBillModels.add(_TransBillModel);
          });
        }

        print('result ${_TransReBillModels_cus.length}');

        TransReBillModels_cus =
            List.generate(_TransReBillModels_cus.length, (_) => []);
        rent_CM_cus = List.generate(_TransReBillModels_cus.length, (_) => []);
        tank_CM_cus = List.generate(_TransReBillModels_cus.length, (_) => []);
        electricity_CM_cus =
            List.generate(_TransReBillModels_cus.length, (_) => []);
        MOMO_CM_cus = List.generate(_TransReBillModels_cus.length, (_) => []);
        rent_area_CM_cus =
            List.generate(_TransReBillModels_cus.length, (_) => []);

        red_Trans_select_cus();
      }
    } catch (e) {}
  }

  Future<Null> red_Trans_select_cus() async {
    for (int index = 0; index < TransReBillModels_cus.length; index++) {
      if (_TransReBillHistoryModels.length != 0) {
        setState(() {
          _TransReBillHistoryModels.clear();

          sum_pvat = 0;
          sum_vat = 0;
          sum_wht = 0;
          sum_amt = 0;
          // sum_disamt = 0;
          // sum_disp = 0;
        });
      }
      if (TransReBillModels_cus[index].length != 0) {
        TransReBillModels_cus[index].clear();
        rent_CM_cus[index].clear();
        tank_CM_cus[index].clear();
        electricity_CM_cus[index].clear();
        MOMO_CM_cus[index].clear();
        rent_area_CM_cus[index].clear();
      }

      SharedPreferences preferences = await SharedPreferences.getInstance();
      var ren = preferences.getString('renTalSer');
      var user = preferences.getString('ser');
      var ciddoc = _TransReBillModels_cus[index].ser;
      var qutser = _TransReBillModels_cus[index].ser_in;
      var docnoin = _TransReBillModels_cus[index].docno;
      String url =
          '${MyConstant().domain}/GC_bill_pay_history_DailyReport_CMma.php?isAdd=true&ren=$ren&user=$user&ciddoc=$ciddoc&docnoin=$docnoin';
      int ii = 0;
      try {
        var response = await http.get(Uri.parse(url));

        var result = json.decode(response.body);
        print(result);
        if (result.toString() != 'null') {
          for (var map in result) {
            TransReBillHistoryModel _TransReBillHistoryModel =
                TransReBillHistoryModel.fromJson(map);

            var sum_pvatx = double.parse(_TransReBillHistoryModel.pvat!);
            var sum_vatx = double.parse(_TransReBillHistoryModel.vat!);
            var sum_whtx = double.parse(_TransReBillHistoryModel.wht!);
            var sum_amtx = double.parse(_TransReBillHistoryModel.total!);
            // var sum_disamtx = double.parse(_InvoiceHistoryModel.disendbill!);
            // var sum_dispx = double.parse(_InvoiceHistoryModel.disendbillper!);
            var numinvoiceent = _TransReBillHistoryModel.docno;
            setState(() {
              sum_pvat = sum_pvat + sum_pvatx;
              sum_vat = sum_vat + sum_vatx;
              sum_wht = sum_wht + sum_whtx;
              sum_amt = sum_amt + sum_amtx;
              // sum_disamt = sum_disamtx;
              // sum_disp = sum_dispx;
              numinvoice = _TransReBillHistoryModel.docno;

              _TransReBillHistoryModels.add(_TransReBillHistoryModel);
              TransReBillModels_cus[index].add(_TransReBillHistoryModel);
            });

            if (_TransReBillHistoryModel.expname.toString() == 'ค่าเช่า') {
              rent_CM_cus[index].add('${_TransReBillHistoryModel.total_sum}');
            } else if (_TransReBillHistoryModel.expname.toString() == 'ถัง') {
              tank_CM_cus[index].add('${_TransReBillHistoryModel.total_sum}');
            } else if (_TransReBillHistoryModel.expname.toString() ==
                    'ค่าไฟ่' ||
                _TransReBillHistoryModel.expname.toString() == 'ค่าไฟ') {
              electricity_CM_cus[index]
                  .add('${_TransReBillHistoryModel.total_sum}');
            } else if (_TransReBillHistoryModel.expname.toString() == 'โม่') {
              MOMO_CM_cus[index].add('${_TransReBillHistoryModel.total_sum}');
            } else if (_TransReBillHistoryModel.expname.toString() ==
                'เช่าพื้นที่') {
              rent_area_CM_cus[index]
                  .add('${_TransReBillHistoryModel.total_sum}');
            }

            print(
                '**********///${electricity_CM_cus[index]}///99999999999999999999999999999999999999${_TransReBillHistoryModel.expname}');
            print(
                '**********///${electricity_CM_cus[index]}/**99999999999999999999999999999999999999${_TransReBillHistoryModel.expname}');
            print(
                '**********///${electricity_CM_cus[index]}/**99999999999999999999999999999999999999${_TransReBillHistoryModel.expname}');
          }
        }
        // setState(() {
        //   red_Invoice();
        // });
      } catch (e) {}
    }
  }

  /////------------------------------------------------------------->(รายชื่อผู้เช่า //รายงานประจำวันรายบุคคล)
  Future<Null> GC_coutumer_daly_CM() async {
    if (teNantModels.isNotEmpty) {
      setState(() {
        teNantModels.clear();
      });
    }

    SharedPreferences preferences = await SharedPreferences.getInstance();
    String? ren = preferences.getString('renTalSer');
    String url =
        '${MyConstant().domain}/GC_custo_se_daly_CMma.php?isAdd=true&ren=$ren&datexS=$Value_selectDate_daly_cus';

    try {
      var response = await http.get(Uri.parse(url));

      var result = json.decode(response.body);
      print(result);
      if (result.toString() != 'null') {
        // for (var map in result) {
        //   CustomerModel customerModel = CustomerModel.fromJson(map);
        //   setState(() {
        //     customerModels.add(customerModel);
        //   });
        // }
        for (var map in result) {
          TeNantModel teNantModel = TeNantModel.fromJson(map);
          setState(() {
            teNantModels.add(teNantModel);
          });

          // GC_coutumer_select_c_contractx('${teNantModel.cid}');
        }
        setState(() {
          _teNantModels = teNantModels;
        });
        coutumer_rent_CM = List.generate(teNantModels.length, (_) => []);
        coutumer_tank_CM = List.generate(teNantModels.length, (_) => []);
        coutumer_electricity_CM = List.generate(teNantModels.length, (_) => []);
        coutumer_MOMO_CM = List.generate(teNantModels.length, (_) => []);
        coutumer_rent_area_CM = List.generate(teNantModels.length, (_) => []);
        coutumer_total_sum_CM = List.generate(teNantModels.length, (_) => []);
        custo_TransReBillHistoryModels =
            List.generate(teNantModels.length, (_) => []);
        await GC_coutumer_select_c_contractx();
        await red_select_Custo_Trans();
      }
    } catch (e) {}
    // red_Trans_bill_custo_Cm();
  }
  ////////----------------------------------------->
  // String electricity_CM = '';
  // String MOMO_CM = '';
  // String tank_CM = '';
  // String rent_CM = '';
  // List<dynamic> electricity_CM = [];
  // List<dynamic> MOMO_CM = [];
  // List<dynamic> tank_CM = [];
  // List<dynamic> rent_CM = [];

  late List<List<dynamic>> rent_CM;
  late List<List<dynamic>> tank_CM;
  late List<List<dynamic>> electricity_CM;
  late List<List<dynamic>> MOMO_CM;
  late List<List<dynamic>> rent_area_CM;

///////////--------------------------------------------->(รายงานประจำวัน)
  Future<Null> red_Trans_select() async {
    for (int index = 0; index < _TransReBillModels.length; index++) {
      if (_TransReBillHistoryModels.length != 0) {
        setState(() {
          _TransReBillHistoryModels.clear();

          sum_pvat = 0;
          sum_vat = 0;
          sum_wht = 0;
          sum_amt = 0;
          // sum_disamt = 0;
          // sum_disp = 0;
        });
      }
      if (TransReBillModels[index].length != 0) {
        TransReBillModels[index].clear();
        rent_CM[index].clear();
        tank_CM[index].clear();
        electricity_CM[index].clear();
        MOMO_CM[index].clear();
        rent_area_CM[index].clear();
      }

      SharedPreferences preferences = await SharedPreferences.getInstance();
      var ren = preferences.getString('renTalSer');
      var user = preferences.getString('ser');
      var ciddoc = _TransReBillModels[index].ser;
      var qutser = _TransReBillModels[index].ser_in;
      var docnoin = _TransReBillModels[index].docno;
      String url =
          '${MyConstant().domain}/GC_bill_pay_history_DailyReport_CMma.php?isAdd=true&ren=$ren&user=$user&ciddoc=$ciddoc&docnoin=$docnoin';
      int ii = 0;
      try {
        var response = await http.get(Uri.parse(url));

        var result = json.decode(response.body);
        print(result);
        if (result.toString() != 'null') {
          for (var map in result) {
            TransReBillHistoryModel _TransReBillHistoryModel =
                TransReBillHistoryModel.fromJson(map);

            var sum_pvatx = double.parse(_TransReBillHistoryModel.pvat!);
            var sum_vatx = double.parse(_TransReBillHistoryModel.vat!);
            var sum_whtx = double.parse(_TransReBillHistoryModel.wht!);
            var sum_amtx = double.parse(_TransReBillHistoryModel.total!);
            // var sum_disamtx = double.parse(_InvoiceHistoryModel.disendbill!);
            // var sum_dispx = double.parse(_InvoiceHistoryModel.disendbillper!);
            var numinvoiceent = _TransReBillHistoryModel.docno;
            setState(() {
              sum_pvat = sum_pvat + sum_pvatx;
              sum_vat = sum_vat + sum_vatx;
              sum_wht = sum_wht + sum_whtx;
              sum_amt = sum_amt + sum_amtx;
              // sum_disamt = sum_disamtx;
              // sum_disp = sum_dispx;
              numinvoice = _TransReBillHistoryModel.docno;

              _TransReBillHistoryModels.add(_TransReBillHistoryModel);
              TransReBillModels[index].add(_TransReBillHistoryModel);
            });

            if (_TransReBillHistoryModel.expname.toString() == 'ค่าเช่า') {
              rent_CM[index].add('${_TransReBillHistoryModel.total_sum}');
            } else if (_TransReBillHistoryModel.expname.toString() == 'ถัง') {
              tank_CM[index].add('${_TransReBillHistoryModel.total_sum}');
            } else if (_TransReBillHistoryModel.expname.toString() ==
                    'ค่าไฟ่' ||
                _TransReBillHistoryModel.expname.toString() == 'ค่าไฟ') {
              electricity_CM[index]
                  .add('${_TransReBillHistoryModel.total_sum}');
            } else if (_TransReBillHistoryModel.expname.toString() == 'โม่') {
              MOMO_CM[index].add('${_TransReBillHistoryModel.total_sum}');
            } else if (_TransReBillHistoryModel.expname.toString() ==
                'เช่าพื้นที่') {
              rent_area_CM[index].add('${_TransReBillHistoryModel.total_sum}');
            }

            print(
                '**********///${electricity_CM[index]}///99999999999999999999999999999999999999${_TransReBillHistoryModel.expname}');
            print(
                '**********///${electricity_CM[index]}/**99999999999999999999999999999999999999${_TransReBillHistoryModel.expname}');
            print(
                '**********///${electricity_CM[index]}/**99999999999999999999999999999999999999${_TransReBillHistoryModel.expname}');
          }
        }
        // setState(() {
        //   red_Invoice();
        // });
      } catch (e) {}
    }
  }

  // Future<Null> read_GC_Sum_expname_CM() async {
  //   for (int index = 0; index < _TransReBillModels.length; index++) {}
  // }

///////////--------------------------------------------->(รวม ใกล้หมดสัญญา)
  Future<Null> read_GC_area1() async {
    var start = DateTime.now();
    if (areaModels1.length != 0) {
      areaModels1.clear();
    }
    SharedPreferences preferences = await SharedPreferences.getInstance();

    var ren = preferences.getString('renTalSer');
    var zone = preferences.getString('zoneSer');

    print('zone >>>>>> $zone');

    String url =
        '${MyConstant().domain}/GC_areaAll.php?isAdd=true&ren=$ren&zone=$zone';

    try {
      var response = await http.get(Uri.parse(url));

      var result = json.decode(response.body);
      // print(result);
      if (result != null) {
        for (var map in result) {
          AreaModel areaModel = AreaModel.fromJson(map);
          setState(() {
            areaModels.add(areaModel);
          });
          if (areaModel.ldate != null) {
            String lastdate = '${areaModel.ldate}';
            var formatter = DateFormat('yyyy-MM-dd');
            var lastDateObject = formatter.parse(lastdate);
            var now = DateTime.now();
            var difference = lastDateObject.difference(now).inDays;
            if (difference == 0) {
              print('หมดสัญญาวันนี้');
            } else if (difference <= 90 && difference > 0) {
              setState(() {
                areaModels1.add(areaModel);
              });
              print('ใกล้หมดสัญญา');
            } else if (difference < 0) {
              print('หมดสัญญา');
            } else {
              print('ไม่ใกล้หมดสัญญา');
            }
          } else {}
        }
      } else {
        setState(() {
          if (areaModels1.isEmpty) {
            preferences.remove('zoneSer');
            preferences.remove('zonesName');
            zone_ser = null;
            zone_name = null;
          }
        });
      }
      setState(() {
        // _areaModels = areaModels;
        zone_ser = preferences.getString('zoneSer');
        zone_name = preferences.getString('zonesName');
      });
    } catch (e) {}
    var end = DateTime.now();
    var difference = end.difference(start);
    print('Time read_GC_area(): ${difference.inSeconds} seconds');
    print('Time read_GC_area(): ${difference.inSeconds} seconds');
    print('Time read_GC_area(): ${difference.inSeconds} seconds');
  }

///////////--------------------------------------------->(รวม ว่าง ให้เช่า)
  Future<Null> read_GC_area2() async {
    //     quantity
// 1 = เช่าอยู่
// 2 = เสนอราคา
// 3 = เสนอราคามัดจำ
// null = ว่าง
    var start = DateTime.now();
    if (areaModels2.length != 0) {
      areaModels2.clear();
    }
    SharedPreferences preferences = await SharedPreferences.getInstance();

    var ren = preferences.getString('renTalSer');
    var zone = preferences.getString('zoneSer');

    print('zone >>>>>> $zone');

    String url = zone == null
        ? '${MyConstant().domain}/GC_areaAll.php?isAdd=true&ren=$ren&zone=$zone'
        : zone == '0'
            ? '${MyConstant().domain}/GC_areaAll.php?isAdd=true&ren=$ren&zone=$zone'
            : '${MyConstant().domain}/GC_area.php?isAdd=true&ren=$ren&zone=$zone';

    try {
      var response = await http.get(Uri.parse(url));

      var result = json.decode(response.body);
      print(result);
      if (result != null) {
        for (var map in result) {
          AreaModel areaModel = AreaModel.fromJson(map);
          if (areaModel.quantity == null) {
            setState(() {
              areaModels2.add(areaModel);
            });
          } else if (int.parse(areaModel.quantity!) == 1) {
            setState(() {
              areaModels3.add(areaModel);
            });
          }
        }
      } else {
        setState(() {
          if (areaModels2.isEmpty) {
            preferences.remove('zoneSer');
            preferences.remove('zonesName');
            zone_ser = null;
            zone_name = null;
          }
        });
      }
      setState(() {
        // _areaModels = areaModels;
        zone_ser = preferences.getString('zoneSer');
        zone_name = preferences.getString('zonesName');
      });
    } catch (e) {}
    var end = DateTime.now();
    var difference = end.difference(start);
    print('Time read_GC_area(): ${difference.inSeconds} seconds');
    print('Time read_GC_area(): ${difference.inSeconds} seconds');
    print('Time read_GC_area(): ${difference.inSeconds} seconds');
  }

/////------------------------------------------------------------->
  Future<Null> GC_coutumer() async {
    if (teNantModels.isNotEmpty) {
      setState(() {
        teNantModels.clear();
      });
    }

    SharedPreferences preferences = await SharedPreferences.getInstance();
    String? ren = preferences.getString('renTalSer');
    String url =
        '${MyConstant().domain}/GC_custo_se_CMma.php?isAdd=true&ren=$ren&monthS=$Mon_&yearS=$YE_&type=1';

    try {
      var response = await http.get(Uri.parse(url));

      var result = json.decode(response.body);
      print(result);
      if (result.toString() != 'null') {
        // for (var map in result) {
        //   CustomerModel customerModel = CustomerModel.fromJson(map);
        //   setState(() {
        //     customerModels.add(customerModel);
        //   });
        // }
        for (var map in result) {
          TeNantModel teNantModel = TeNantModel.fromJson(map);
          setState(() {
            teNantModels.add(teNantModel);
          });

          // GC_coutumer_select_c_contractx('${teNantModel.cid}');
        }
        coutumer_rent_CM = List.generate(teNantModels.length, (_) => []);
        coutumer_tank_CM = List.generate(teNantModels.length, (_) => []);
        coutumer_electricity_CM = List.generate(teNantModels.length, (_) => []);
        coutumer_MOMO_CM = List.generate(teNantModels.length, (_) => []);
        coutumer_rent_area_CM = List.generate(teNantModels.length, (_) => []);
        coutumer_total_sum_CM = List.generate(teNantModels.length, (_) => []);
        custo_TransReBillHistoryModels =
            List.generate(teNantModels.length, (_) => []);
        await GC_coutumer_select_c_contractx();
        await red_select_Custo_Trans();
      }
    } catch (e) {}
  }

  Future<Null> red_select_Custo_Trans() async {
    for (int index = 0; index < teNantModels.length; index++) {
      if (custo_TransReBillHistoryModels[index].length != 0) {
        setState(() {
          custo_TransReBillHistoryModels[index].clear();
        });
      }
      SharedPreferences preferences = await SharedPreferences.getInstance();
      var ren = preferences.getString('renTalSer');
      var user = preferences.getString('ser');
      // var ciddoc = widget.Get_Value_cid;
      // var qutser = widget.Get_Value_NameShop_index;

      String url =
          '${MyConstant().domain}/GC_custo_bill_pay_history_ReportCM.php?isAdd=true&ren=$ren&cidser=${teNantModels[index].cid}&montser=${Mon_}&yearser=${YE_}';
      try {
        var response = await http.get(Uri.parse(url));

        var result = json.decode(response.body);
        print(result);
        if (result.toString() != 'null') {
          for (var map in result) {
            TransReBillHistoryModel _TransReBillHistoryModel =
                TransReBillHistoryModel.fromJson(map);
            print(
                '${index + 1}/${teNantModels.length} : docno***docno*docno***${_TransReBillHistoryModel.docno}');
            setState(() {
              custo_TransReBillHistoryModels[index]
                  .add(_TransReBillHistoryModel);
            });
          }
        }
        // setState(() {
        //   red_Invoice();
        // });
      } catch (e) {}
    }
  }

  // late List<List<dynamic>> rent_CM;
  // late List<List<dynamic>> tank_CM;
  // late List<List<dynamic>> electricity_CM;
  // late List<List<dynamic>> MOMO_CM;
  // late List<List<dynamic>> rent_area_CM;
  // late List<List<dynamic>> contractx_expneme;

  late List<List<dynamic>> coutumer_rent_CM;
  late List<List<dynamic>> coutumer_tank_CM;
  late List<List<dynamic>> coutumer_electricity_CM;
  late List<List<dynamic>> coutumer_MOMO_CM;
  late List<List<dynamic>> coutumer_rent_area_CM;
  late List<List<dynamic>> coutumer_total_sum_CM;

  Future<Null> GC_coutumer_select_c_contractx() async {
    // var ciddoc = widget.Get_Value_cid;
    // var qutser = widget.Get_Value_NameShop_index;
    for (int index = 0; index < teNantModels.length; index++) {
      print(
          'GC_coutumer_select_c_contractxGC_coutumer_select_c_contractxGC_coutumer_select_c_contractx//GC_coutumer_select_c_contractx');
      if (contractxModels.length != 0) {
        setState(() {
          contractxModels.clear();
          coutumer_rent_CM[index].clear();
          coutumer_tank_CM[index].clear();
          coutumer_electricity_CM[index].clear();
          coutumer_MOMO_CM[index].clear();
          coutumer_rent_area_CM[index].clear();
          coutumer_total_sum_CM[index].clear();
        });
      }
      double Sumsum = 0.00;
      SharedPreferences preferences = await SharedPreferences.getInstance();
      var ren = preferences.getString('renTalSer');
      String url =
          '${MyConstant().domain}/GC_custo_select_c_contractx_CMma.php?isAdd=true&ren=$ren&sercid=${teNantModels[index].cid}';
      try {
        var response = await http.get(Uri.parse(url));

        var result = json.decode(response.body);
        // print('result $ciddoc');
        if (result.toString() != 'null') {
          for (var map in result) {
            ContractxModel contractxModel = ContractxModel.fromJson(map);
            setState(() {
              contractxModels.add(contractxModel);

              // _TransBillModels.add(_TransBillModel);
            });

            // var map1 = {
            //   'cid': '${contractxModel.cid}',
            //   for (int index = 0; index < 5; index++)
            //     'expser$index': '${contractxModel.expser}',
            //   'expname': '${contractxModel.expname}',
            // };
            // var mapList = [map1];

            // contractx_expneme.add(mapList);

            if (contractxModel.expname.toString() == 'ค่าเช่า') {
              coutumer_rent_CM[index].add('${contractxModel.amt}');
              // setState(() {
              //   Sumsum = Sumsum + double.parse(contractxModel.amt!);
              // });
            } else if (contractxModel.expname.toString() == 'ถัง') {
              coutumer_tank_CM[index].add('${contractxModel.amt}');
              setState(() {
                Sumsum = Sumsum + double.parse(contractxModel.amt!);
              });
            } else if (contractxModel.expname.toString() == 'ค่าไฟ่' ||
                contractxModel.expname.toString() == 'ค่าไฟ') {
              coutumer_electricity_CM[index].add('${contractxModel.amt}');
              setState(() {
                Sumsum = Sumsum + double.parse(contractxModel.amt!);
              });
            } else if (contractxModel.expname.toString() == 'โม่') {
              coutumer_MOMO_CM[index].add('${contractxModel.amt}');
              if (contractxModel.amt != null)
                setState(() {
                  Sumsum = Sumsum + double.parse(contractxModel.amt!);
                });
            } else if (contractxModel.expname.toString() == 'เช่าพื้นที่') {
              coutumer_rent_area_CM[index].add('${contractxModel.amt}');
              if (contractxModel.amt != null)
                setState(() {
                  Sumsum = Sumsum + double.parse(contractxModel.amt!);
                });
            }
            //coutumer_total_sum_CM.add('${contractxModel.sum_total}');

            print(
                '*coutumer_tank_CM*********///${contractxModel.cid}///99999999999999999999999999999999999999//${Sumsum}');
            print(
                '*****coutumer_tank_CM*****///${coutumer_tank_CM[index]}/**99999999999999999999999999999999999999//${contractxModel.amt}');
            print(
                '******coutumer_tank_CM****///${coutumer_tank_CM[index]}/**99999999999999999999999999999999999999//${contractxModel.amt}');
          }
          coutumer_total_sum_CM[index].add('${Sumsum}');
          print('contractxModel.length : ${contractxModels.length}');
        }
      } catch (e) {}
    }
  }
  ///////---------------------------------------------------->

  _searchBar() {
    return TextField(
      autofocus: false,
      keyboardType: TextInputType.text,
      style: const TextStyle(fontSize: 22.0, color: Colors.black),
      decoration: InputDecoration(
        filled: true,
        // fillColor: Colors.white,
        hintText: ' Search...',
        hintStyle: const TextStyle(fontSize: 20.0, color: Colors.black),
        contentPadding:
            const EdgeInsets.only(left: 14.0, bottom: 8.0, top: 8.0),
        // focusedBorder: OutlineInputBorder(
        //   borderSide: const BorderSide(color: Colors.white),
        //   borderRadius: BorderRadius.circular(10),
        // ),
        enabledBorder: UnderlineInputBorder(
          borderSide: const BorderSide(color: Colors.black),
          borderRadius: BorderRadius.circular(10),
        ),
      ),
      onChanged: (text) {
        text = text.toLowerCase();
        setState(() {
          teNantModels = _teNantModels.where((teNantModelss) {
            var notTitle = teNantModelss.cid!.toLowerCase();
            var notTitle2 = teNantModelss.cname!.toLowerCase();
            var notTitle3 = teNantModelss.sname!.toLowerCase();
            var notTitle4 = teNantModelss.ln!.toLowerCase();
            return notTitle.contains(text) ||
                notTitle2.contains(text) ||
                notTitle3.contains(text) ||
                notTitle4.contains(text);
          }).toList();

          // }
        });
      },
    );
  }
//////////////-----------------------------------------------------ฬ>

////////////------------------------------------------------------->()
  /// This decides which day will be enabled
  /// This will be called every time while displaying day in calender.
  bool _decideWhichDayToEnable(DateTime day) {
    if ((day.isAfter(DateTime.now().subtract(const Duration(days: 1))) &&
        day.isBefore(DateTime.now().add(const Duration(days: 10))))) {
      return true;
    }
    return false;
  }

  Future<Null> _select_Date(BuildContext context) async {
    final Future<DateTime?> picked = showDatePicker(
      locale: const Locale('th', 'TH'),
      helpText: 'เลือกวันที่เริ่มต้น', confirmText: 'ตกลง',
      cancelText: 'ยกเลิก',
      context: context,
      initialDate: DateTime(
          DateTime.now().year, DateTime.now().month, DateTime.now().day - 1),
      initialDatePickerMode: DatePickerMode.day,
      firstDate: DateTime(2023, 1, 1),
      lastDate: DateTime(
          DateTime.now().year, DateTime.now().month, DateTime.now().day),
      // selectableDayPredicate: _decideWhichDayToEnable,
      builder: (context, child) {
        return Theme(
          data: Theme.of(context).copyWith(
            colorScheme: const ColorScheme.light(
              primary: AppBarColors.ABar_Colors, // header background color
              onPrimary: Colors.white, // header text color
              onSurface: Colors.black, // body text color
            ),
            textButtonTheme: TextButtonThemeData(
              style: TextButton.styleFrom(
                primary: Colors.black, // button text color
              ),
            ),
          ),
          child: child!,
        );
      },
    );
    picked.then((result) {
      if (picked != null) {
        TransReBillModels = [];

        var formatter = DateFormat('y-MM-d');
        print("${formatter.format(result!)}");
        setState(() {
          Value_selectDate_daly_cus = null;
          Value_selectDate = "${formatter.format(result)}";
        });
        red_Trans_bill();
      }
    });
  }

  Future<Null> _select_Date_daly_cus(BuildContext context) async {
    final Future<DateTime?> picked = showDatePicker(
      locale: const Locale('th', 'TH'),
      helpText: 'เลือกวันที่เริ่มต้น', confirmText: 'ตกลง',
      cancelText: 'ยกเลิก',
      context: context,
      initialDate: DateTime(
          DateTime.now().year, DateTime.now().month, DateTime.now().day - 1),
      initialDatePickerMode: DatePickerMode.day,
      firstDate: DateTime(2023, 1, 1),
      lastDate: DateTime(
          DateTime.now().year, DateTime.now().month, DateTime.now().day),
      // selectableDayPredicate: _decideWhichDayToEnable,
      builder: (context, child) {
        return Theme(
          data: Theme.of(context).copyWith(
            colorScheme: const ColorScheme.light(
              primary: AppBarColors.ABar_Colors, // header background color
              onPrimary: Colors.white, // header text color
              onSurface: Colors.black, // body text color
            ),
            textButtonTheme: TextButtonThemeData(
              style: TextButton.styleFrom(
                primary: Colors.black, // button text color
              ),
            ),
          ),
          child: child!,
        );
      },
    );
    picked.then((result) {
      if (picked != null) {
        TransReBillModels_cus = [];

        var formatter = DateFormat('y-MM-d');
        print("${formatter.format(result!)}");
        setState(() {
          Value_selectDate = null;
          Value_selectDate_daly_cus = "${formatter.format(result)}";
        });
        red_Trans_bill_custo_Cm();
      }
    });
  }

////////////------------------------------------------>()
  Future<Null> _select_StartDate(BuildContext context) async {
    final Future<DateTime?> picked = showDatePicker(
      locale: const Locale('th', 'TH'),
      helpText: 'เลือกวันที่เริ่มต้น', confirmText: 'ตกลง',
      cancelText: 'ยกเลิก',
      context: context,
      initialDate: DateTime(
          DateTime.now().year, DateTime.now().month, DateTime.now().day - 1),
      initialDatePickerMode: DatePickerMode.day,
      firstDate: DateTime(2023, 1, 1),
      lastDate: DateTime(
          DateTime.now().year, DateTime.now().month, DateTime.now().day - 1),
      // selectableDayPredicate: _decideWhichDayToEnable,
      builder: (context, child) {
        return Theme(
          data: Theme.of(context).copyWith(
            colorScheme: const ColorScheme.light(
              primary: AppBarColors.ABar_Colors, // header background color
              onPrimary: Colors.white, // header text color
              onSurface: Colors.black, // body text color
            ),
            textButtonTheme: TextButtonThemeData(
              style: TextButton.styleFrom(
                primary: Colors.black, // button text color
              ),
            ),
          ),
          child: child!,
        );
      },
    );
    picked.then((result) {
      if (picked != null) {
        var formatter = DateFormat('y-MM-d');
        print("${formatter.format(result!)}");
        setState(() {
          Value_selectDate1 = "${formatter.format(result)}";
          Value_selectDate2 = null;
          _TransReBillModels_Income = [];
          _TransReBillHistoryModels_Income = [];
          _TransReBillModels_Bankmovemen = [];
          _TransReBillHistoryModels_Bankmovemen = [];
          TransReBillModels_Income = [];
          TransReBillModels_Bankmovemen = [];
          // TransReBillModels = [];
        });

        // List<TransReBillModel> _TransReBillModels_Income = [];
        // List<TransReBillHistoryModel> _TransReBillHistoryModels_Income = [];
        // List<TransReBillModel> _TransReBillModels_Bankmovemen = [];
        // List<TransReBillHistoryModel> _TransReBillHistoryModels_Bankmovemen = [];
        // late List<List<dynamic>> TransReBillModels_Income;
        // late List<List<dynamic>> TransReBillModels_Bankmovemen;
        //   late List<List<dynamic>> TransReBillModels;
      }
    });
  }

////////////------------------------------------------->()
  Future<Null> _select_EndDate(BuildContext context) async {
    final Future<DateTime?> picked = showDatePicker(
      locale: const Locale('th', 'TH'),
      helpText: 'เลือกวันที่สุดท้าย', confirmText: 'ตกลง', cancelText: 'ยกเลิก',
      context: context,
      initialDate: DateTime.now(),
      initialDatePickerMode: DatePickerMode.day,
      firstDate: DateTime(2023, 1, 1),
      lastDate: DateTime(
          DateTime.now().year, DateTime.now().month, DateTime.now().day),
      // selectableDayPredicate: _decideWhichDayToEnable,
      builder: (context, child) {
        return Theme(
          data: Theme.of(context).copyWith(
            colorScheme: const ColorScheme.light(
              primary: AppBarColors.ABar_Colors, // header background color
              onPrimary: Colors.white, // header text color
              onSurface: Colors.black, // body text color
            ),
            textButtonTheme: TextButtonThemeData(
              style: TextButton.styleFrom(
                primary: Colors.black, // button text color
              ),
            ),
          ),
          child: child!,
        );
      },
    );
    picked.then((result) {
      if (picked != null) {
        var formatter = DateFormat('y-MM-d');
        print("${formatter.format(result!)}");
        setState(() {
          Value_selectDate2 = "${formatter.format(result)}";
        });
        red_Trans_billIncome();

        red_Trans_billMovemen();
      }
    });
  }

////////////------------------------------------------------------>(Export file)
  Future<void> _showMyDialog_SAVE() async {
    return showDialog<void>(
      context: context,
      barrierDismissible: false, // user must tap button!
      builder: (BuildContext context) {
        return StreamBuilder(
          stream: Stream.periodic(const Duration(seconds: 0)),
          builder: (context, snapshot) {
            return Form(
              key: _formKey,
              child: AlertDialog(
                shape: const RoundedRectangleBorder(
                    borderRadius: BorderRadius.all(Radius.circular(15.0))),
                title: Container(
                  width: 300,
                  height: 50,
                  child: Stack(
                    children: [
                      Container(
                        width: 200,
                        child: Center(
                          child: Text(
                            '$Value_Report',
                            style: const TextStyle(
                              color: ReportScreen_Color.Colors_Text1_,
                              fontWeight: FontWeight.bold,
                              fontFamily: FontWeight_.Fonts_T,
                            ),
                          ),
                        ),
                      ),
                      Positioned(
                        top: 0,
                        right: 0,
                        child: Container(
                            // width: 100,
                            decoration: const BoxDecoration(
                              color: Colors.black,
                              borderRadius: BorderRadius.only(
                                  topLeft: Radius.circular(10),
                                  topRight: Radius.circular(10),
                                  bottomLeft: Radius.circular(10),
                                  bottomRight: Radius.circular(10)),
                            ),
                            padding: const EdgeInsets.all(8.0),
                            child: InkWell(
                              onTap: () => Navigator.pop(context, 'OK'),
                              child: const Text(
                                'ปิด',
                                style: TextStyle(
                                  color: Colors.white,
                                  //fontWeight: FontWeight.bold, color:

                                  // fontWeight: FontWeight.bold,
                                  fontFamily: Font_.Fonts_T,
                                ),
                              ),
                            )),
                      )
                    ],
                  ),
                ),
                content: SingleChildScrollView(
                  child: ListBody(
                    children: <Widget>[
                      const Text(
                        'สกุลไฟล์ :',
                        style: TextStyle(
                          color: ReportScreen_Color.Colors_Text2_,
                          // fontWeight: FontWeight.bold,
                          fontFamily: Font_.Fonts_T,
                        ),
                      ),
                      Container(
                        decoration: BoxDecoration(
                          color: Colors.white.withOpacity(0.3),
                          borderRadius: const BorderRadius.only(
                            topLeft: Radius.circular(15),
                            topRight: Radius.circular(15),
                            bottomLeft: Radius.circular(15),
                            bottomRight: Radius.circular(15),
                          ),
                          border: Border.all(color: Colors.grey, width: 1),
                        ),
                        padding: const EdgeInsets.all(8.0),
                        child: RadioGroup<String>.builder(
                          direction: Axis.horizontal,
                          groupValue: _verticalGroupValue_PassW,
                          horizontalAlignment: MainAxisAlignment.spaceAround,
                          onChanged: (value) {
                            setState(() {
                              FormNameFile_text.clear();
                            });
                            setState(() {
                              _verticalGroupValue_PassW = value ?? '';
                            });
                          },
                          items: const <String>[
                            // "PDF",
                            "EXCEL",
                          ],
                          textStyle: const TextStyle(
                            fontSize: 15,
                            color: ReportScreen_Color.Colors_Text2_,
                            // fontWeight: FontWeight.bold,
                            fontFamily: Font_.Fonts_T,
                          ),
                          itemBuilder: (item) => RadioButtonBuilder(
                            item,
                          ),
                        ),
                      ),
                    ],
                  ),
                ),
                actions: <Widget>[
                  Center(
                    child: Padding(
                      padding: const EdgeInsets.all(8.0),
                      child: Container(
                        width: 180,
                        decoration: const BoxDecoration(
                          color: Colors.black,
                          borderRadius: BorderRadius.only(
                            topLeft: Radius.circular(10),
                            topRight: Radius.circular(10),
                            bottomLeft: Radius.circular(10),
                            bottomRight: Radius.circular(10),
                          ),
                        ),
                        padding: const EdgeInsets.all(8.0),
                        child: TextButton(
                          onPressed: () async {
                            InkWell_onTap(context);
                          },
                          child: Row(
                            crossAxisAlignment: CrossAxisAlignment.center,
                            mainAxisAlignment: MainAxisAlignment.center,
                            children: [
                              CircleAvatar(
                                backgroundColor: Colors.black,
                                radius: 25,
                                backgroundImage: (_verticalGroupValue_PassW ==
                                        'PDF')
                                    ? const AssetImage('images/IconPDF.gif')
                                    : const AssetImage('images/excel_icon.gif'),
                              ),
                              Container(
                                width: 80,
                                child: const Text(
                                  'Download',
                                  style: TextStyle(
                                    color: Colors.white,
                                    fontWeight: FontWeight.bold,
                                    fontFamily: FontWeight_.Fonts_T,
                                  ),
                                ),
                                // decoration: const BoxDecoration(
                                //   border: Border(
                                //     bottom: BorderSide(
                                //         color: Colors.white),
                                //   ),
                                // ),
                              ),
                            ],
                          ),
                        ),
                      ),
                    ),
                  ),
                ],
              ),
            );
          },
        );
      },
    );
  }

////////////------------------------------------------>
  void InkWell_onTap(context) async {
    setState(() {
      NameFile_ = '';
      NameFile_ = FormNameFile_text.text;
    });

    if (_verticalGroupValue_NameFile == 'กำหนดเอง') {
    } else {
      if (_verticalGroupValue_PassW == 'PDF') {
        if (Value_Report == 'ภาษี') {
          _displayPdf_();
        } else if (Value_Report == 'รายงานรายรับ') {
          _displayPdf_();
        } else if (Value_Report == 'รายงานรายจ่าย') {
          _displayPdf_();
        } else if (Value_Report == 'รายงานการเคลื่อนไหวธนาคาร') {
          _displayPdf_();
        } else if (Value_Report == 'รายงานประจำวัน') {
          _displayPdf_();
        }

        Navigator.of(context).pop();
      } else {
        if (Value_Report == 'ภาษี') {
          Excgen_TaxReport_cm.exportExcel_TaxReport_cm(
              context, NameFile_, _verticalGroupValue_NameFile, Value_Report);
        } else if (Value_Report == 'รายงานรายรับ') {
          Excgen_IncomeReport_cm.exportExcel_IncomeReport_cm(
              context,
              NameFile_,
              _verticalGroupValue_NameFile,
              Value_Report,
              _TransReBillModels_Income,
              TransReBillModels_Income,
              renTal_name,
              Value_selectDate1,
              Value_selectDate2);
        } else if (Value_Report == 'รายงานรายจ่าย') {
          Excgen_ExpenseReport_cm.exportExcel_ExpenseReport_cm(
              context, NameFile_, _verticalGroupValue_NameFile, Value_Report);
        } else if (Value_Report == 'รายงานการเคลื่อนไหวธนาคาร') {
          Excgen_BankmovemenReport_cm.exportExcel_BankmovemenReport_cm(
              context,
              NameFile_,
              _verticalGroupValue_NameFile,
              Value_Report,
              _TransReBillModels_Bankmovemen,
              TransReBillModels_Bankmovemen,
              renTal_name,
              Value_selectDate1,
              Value_selectDate2);
        } else if (Value_Report == 'รายงานประจำวัน') {
          Excgen_DailyReport_cm.exportExcel_DailyReport_cm(
              context,
              NameFile_,
              _verticalGroupValue_NameFile,
              Value_Report,
              _TransReBillModels,
              TransReBillModels,
              renTal_name,
              Value_selectDate,
              rent_CM,
              tank_CM,
              electricity_CM,
              MOMO_CM,
              rent_area_CM);
        } else if (Value_Report == 'รายงานประจำวันรายบุคคล') {
          Excgen_DailyReport_cus_cm.exportExcel_DailyReport_cus_cm(
              context,
              NameFile_,
              _verticalGroupValue_NameFile,
              Value_Report,
              _TransReBillModels_cus,
              TransReBillModels_cus,
              renTal_name,
              Value_selectDate_daly_cus,
              rent_CM_cus,
              tank_CM_cus,
              electricity_CM_cus,
              MOMO_CM_cus,
              rent_area_CM_cus);
        } else if (Value_Report == 'รายงานผู้เช่า') {
          Excgen_Custo_cm.exportExcel_Custo_cm(
              context,
              NameFile_,
              _verticalGroupValue_NameFile,
              Value_Report,
              teNantModels,
              renTal_name,
              Value_selectDate,
              coutumer_MOMO_CM,
              coutumer_tank_CM,
              coutumer_rent_area_CM,
              coutumer_electricity_CM,
              coutumer_total_sum_CM,
              custo_TransReBillHistoryModels,
              YE_,
              Mon_);
        }

        Navigator.of(context).pop();
      }
    }
  }

///////////-------------------------------------------------------------->(PDF)
  void _displayPdf_() async {
    var bill_addr = ' ${renTalModels[0].bill_addr}';
    var bill_email = ' ${renTalModels[0].bill_email}';
    var bill_tel = ' ${renTalModels[0].bill_tel}';
    var bill_tax = ' ${renTalModels[0].bill_tax}';
    var bill_name = ' ${renTalModels[0].bill_name}';
//_TransReBillModels_Income,TransReBillModels_Income
    //    'index': '${(index2 + 1)}',
    // 'docno': _TransReBillModels_Income[index1].docno == ''
    //     ? '${_TransReBillModels_Income[index1].docno}'
    //     : '${_TransReBillModels_Income[index1].refno}',
    // 'date': '${TransReBillModels_Income[index1][index2].date}',
    // 'type': '${TransReBillModels_Income[index1][index2].type}',
    // 'expname': '${TransReBillModels_Income[index1][index2].expname}',
    // 'nvat': '${TransReBillModels_Income[index1][index2].nvat}',
    // 'vtype': '${TransReBillModels_Income[index1][index2].vtype}',
    // 'vat':
    //     '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].vat!))}',
    // 'ramt': (TransReBillModels_Income[index1][index2].ramt.toString() ==
    //         'null')
    //     ? '-'
    //     : '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].ramt!))}',
    // 'ramtd': (TransReBillModels_Income[index1][index2].ramtd.toString() ==
    //         'null')
    //     ? '-'
    //     : '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].ramtd!))}',
    // 'amt':
    //     '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].amt!))}',
    // 'total':
    //     '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].total!))}',
    // 'sname': (TransReBillModels_Income[index1][index2].sname == null)
    //     ? '${TransReBillModels_Income[index1][index2].remark}'
    //     : '${TransReBillModels_Income[index1][index2].sname}'
    if (Value_Report == 'รายงานรายรับ') {
      // _displayPdf_IncomeReport();
      Pdfgen_IncomeReport_cm.displayPdf_IncomeReport_cm(
          context,
          renTal_name,
          Value_Report,
          Pre_and_Dow,
          _verticalGroupValue_NameFile,
          NameFile_,
          _TransReBillModels_Income,
          TransReBillModels_Income,
          datalist001_Incom,
          bill_addr,
          bill_email,
          bill_tel,
          bill_tax,
          bill_name,
          newValuePDFimg,
          Value_selectDate1,
          Value_selectDate2);
///////////------------------------------>
    } else if (Value_Report == 'รายงานรายจ่าย') {
      // _displayPdf_ExpenseReport();
      Pdfgen_ExpenseReport_cm.displayPdf_ExpenseReport_cm(context, renTal_name,
          Value_Report, Pre_and_Dow, _verticalGroupValue_NameFile, NameFile_);
///////////------------------------------------------>
    } else if (Value_Report == 'รายงานการเคลื่อนไหวธนาคาร') {
      // _displayPdf_BankmovementReport();
      Pdfgen_BankmovementReport_cm.displayPdf_BankmovementReport_cm(
          context,
          renTal_name,
          Value_Report,
          Pre_and_Dow,
          _verticalGroupValue_NameFile,
          NameFile_);
///////////--------------------------------------->
    } else if (Value_Report == 'รายงานภาษี') {
///////////----------------------------------------->
    } else {
      // _displayPdf_DailyReport();
      Pdfgen_DailyReport_cm.displayPdf_DailyReport_cm(
          context,
          renTal_name,
          Value_Report,
          Pre_and_Dow,
          _verticalGroupValue_NameFile,
          NameFile_,
          _TransReBillModels,
          TransReBillModels,
          bill_addr,
          bill_email,
          bill_tel,
          bill_tax,
          bill_name,
          newValuePDFimg,
          Value_selectDate);
    }
  }
//////////------------------------------------>(โหลดเอกสารในโปรเจกต)

  // Future<void> Dload_Document() async {
  //   // Get the file path
  //   var filePath = 'downloadFile/ใบเสนอราคาdownloadFile.pdf';
  //   // Open the file
  //   var bytes = await rootBundle.load(filePath);
  //   // Create a new anchor element
  //   var anchor = AnchorElement(
  //       href: Url.createObjectUrlFromBlob(
  //           Blob([bytes.buffer.asUint8List()], 'application/pdf')))
  //     ..setAttribute("download", "ใบเสนอราคาdownloadFile.pdf")
  //     ..style.display = "none";
  //   // Add the anchor element to the body
  //   document.body!.append(anchor);
  //   // Click the anchor element to start the download
  //   anchor.click();
  //   // Remove the anchor element from the body
  //   anchor.remove();
  // }

//////////////////////////////////----------------------------------------->
  // void sendLineMessage() async {
  //   final String accessToken =
  //       'KchNl5VVm7MpMWLGHxX2xmp0CTfSUTysguDgXZIV9qEZAMuQk12wqPriDWMc6Eu3IJqkSYXcWkbTIgA2IGHm/4mjAMAF+JQqORMyRMsLwj+MmVIxwK2rfcRZhZMzfnuydAdDJpqx8VzFS6/1p7zg7wdB04t89/1O/w1cDnyilFU=';
  //   final String groupId = 'b4ba579bcf3d6222060a14ed6c9815a9';

  //   final url = 'https://api.line.me/v2/bot/message/push';
  //   final headers = {
  //     'Content-Type': 'application/json',
  //     'Authorization': 'Bearer $accessToken',
  //   };

  //   final payload = {
  //     "to": "U05bc300eb177919af60f4a07517eca59",
  //     "messages": [
  //       {"type": "text", "text": "Hello, world1"},
  //       {"type": "text", "text": "Hello, worl3d2"}
  //     ]
  //   };

  //   final response = await http.post(
  //     Uri.parse(url),
  //     headers: headers,
  //     body: jsonEncode(payload),
  //   );

  //   if (response.statusCode == 200) {
  //     print('Message sent successfully.');
  //     print('Failed to send message: ${response.body}');
  //   } else {
  //     print('Failed to send message: ${response}');
  //   }
  // }

  // void sendLineMessage() async {
  //   final String accessToken =
  //       'KchNl5VVm7MpMWLGHxX2xmp0CTfSUTysguDgXZIV9qEZAMuQk12wqPriDWMc6Eu3IJqkSYXcWkbTIgA2IGHm/4mjAMAF+JQqORMyRMsLwj+MmVIxwK2rfcRZhZMzfnuydAdDJpqx8VzFS6/1p7zg7wdB04t89/1O/w1cDnyilFU=';
  //   final String groupId = 'b4ba579bcf3d6222060a14ed6c9815a9';

  //   final url = 'https://api.line.me/v2/bot/message/broadcast';
  //   final headers = {
  //     'Content-Type': 'application/json',
  //     'Authorization': 'Bearer $accessToken',
  //   };

  //   final payload = {
  //     "messages": [
  //       {
  //         "type": "text",
  //         "text":
  //             "ลุงตู่ ลุงตู่อยู่ไหน อยู่ไม่ใกล้ ไม่ไกล อยู่รวมไทยสร้างชาติ เลือกลุงตู่ เลือกคนดีมือสะอาด เลือกรวมไทยสร้างชาติ ได้ลุงตู่ ได้ลุงตู่ ลุงตู่เบอร์ 22 พ่อแม่พี่น้องเบอร์ 22 ได้ลุงตู่ เลือกลุงตู่",
  //         "sender": {"name": "ลุงตู่ คิดถึงคุณ"}
  //       },
  //       {
  //         "type": "video",
  //         "originalContentUrl":
  //             "https://www.youtube.com/live/fJaGk7ZeL54?feature=share",
  //         "previewImageUrl":
  //             "https://www.youtube.com/live/fJaGk7ZeL54?feature=share"
  //       },
  //       {
  //         "type": "image",
  //         "originalContentUrl":
  //             "https://storage.thaipost.net/main/uploads/photos/big/20190412/image_big_5caff2dcf29fe.jpg",
  //         "previewImageUrl":
  //             "https://storage.thaipost.net/main/uploads/photos/big/20190412/image_big_5caff2dcf29fe.jpg",
  //         "contentProvider": {
  //           "type": "external",
  //           "originalContentUrl":
  //               "https://storage.thaipost.net/main/uploads/photos/big/20190412/image_big_5caff2dcf29fe.jpg",
  //           "previewImageUrl":
  //               "https://storage.thaipost.net/main/uploads/photos/big/20190412/image_big_5caff2dcf29fe.jpg"
  //         }
  //       }
  //     ]
  //   };

  //   final response = await http.post(
  //     Uri.parse(url),
  //     headers: headers,
  //     body: jsonEncode(payload),
  //   );

  //   if (response.statusCode == 200) {
  //     print('Message sent successfully.');
  //   } else {
  //     print('Failed to send message: ${response.reasonPhrase}');
  //   }
  // }

  // void sendFlexMessage() async {
  //   final String accessToken =
  //       'KchNl5VVm7MpMWLGHxX2xmp0CTfSUTysguDgXZIV9qEZAMuQk12wqPriDWMc6Eu3IJqkSYXcWkbTIgA2IGHm/4mjAMAF+JQqORMyRMsLwj+MmVIxwK2rfcRZhZMzfnuydAdDJpqx8VzFS6/1p7zg7wdB04t89/1O/w1cDnyilFU=';
  //   final String groupId = 'b4ba579bcf3d6222060a14ed6c9815a9';

  //   final url = 'https://api.line.me/v2/bot/message/broadcast';
  //   final headers = {
  //     'Content-Type': 'application/json',
  //     'Authorization': 'Bearer $accessToken',
  //   };

  //   final payload = {
  //     // 'to': userId,
  //     'messages': [
  //       {
  //         'type': 'flex',
  //         'altText': 'Flex Message Example',
  //         'contents': {
  //           'type': 'bubble',
  //           'direction': 'ltr',
  //           'body': {
  //             'type': 'box',
  //             'layout': 'vertical',
  //             'contents': [
  //               {
  //                 'type': 'text',
  //                 'text': 'Hello, world!',
  //               },
  //               {
  //                 'type': 'text',
  //                 'text': 'This is a Flex Message example.',
  //               },
  //               {
  //                 'type': 'image',
  //                 'url':
  //                     'https://storage.thaipost.net/main/uploads/photos/big/20190412/image_big_5caff2dcf29fe.jpg',
  //                 'size': 'full',
  //                 'aspectRatio': '2:1',
  //                 'aspectMode': 'cover',
  //                 'action': {
  //                   'type': 'uri',
  //                   'label': 'View Image',
  //                   'uri':
  //                       'https://storage.thaipost.net/main/uploads/photos/big/20190412/image_big_5caff2dcf29fe.jpg'
  //                 }
  //               },
  //             ],
  //           },
  //         },
  //       },
  //     ],
  //   };

  //   final response = await http.post(
  //     Uri.parse(url),
  //     headers: headers,
  //     body: jsonEncode(payload),
  //   );

  //   if (response.statusCode == 200) {
  //     print('Flex Message sent successfully.');
  //   } else {
  //     print('Failed to send Flex Message: ${response.reasonPhrase}');
  //   }
  // }

  // void sendLineMessageToUser() async {
  //   final String accessToken = '<YOUR_CHANNEL_ACCESS_TOKEN>';
  //   final String url = 'https://api.line.me/v2/bot/message/push';

  //   final headers = {
  //     'Content-Type': 'application/json',
  //     'Authorization': 'Bearer $accessToken',
  //   };

  //   final payload = {
  //     'to': 'wawiser',
  //     'messages': [
  //       {'type': 'text', 'text': 'Hello, world!'}
  //     ]
  //   };

  //   final response = await http.post(
  //     Uri.parse(url),
  //     headers: headers,
  //     body: jsonEncode(payload),
  //   );

  //   if (response.statusCode == 200) {
  //     print('Message sent successfully.');
  //   } else {
  //     print('Failed to send message: ${response.reasonPhrase}');
  //   }
  // }

  Widget build(BuildContext context) {
    return SingleChildScrollView(
      child: Container(
        // height: MediaQuery.of(context).size.height,
        // width: MediaQuery.of(context).size.width,
        child: Column(
          children: [
            Padding(
              padding: const EdgeInsets.fromLTRB(8, 8, 8, 0),
              child: Align(
                alignment: Alignment.topLeft,
                child: Padding(
                  padding: const EdgeInsets.fromLTRB(8, 8, 2, 0),
                  child: Container(
                    width: 100,
                    decoration: BoxDecoration(
                      color: AppbackgroundColor.TiTile_Colors,
                      borderRadius: const BorderRadius.only(
                        topLeft: Radius.circular(10),
                        topRight: Radius.circular(10),
                        bottomLeft: Radius.circular(10),
                        bottomRight: Radius.circular(10),
                      ),
                      border: Border.all(color: Colors.white, width: 2),
                    ),
                    padding: const EdgeInsets.all(5.0),
                    child: Row(
                      mainAxisAlignment: MainAxisAlignment.center,
                      children: [
                        InkWell(
                          onTap: () {
                            //sendLineMessage();
                            // sendLineMessageToUser();
                            // sendLineMessage();
                          },
                          child: AutoSizeText(
                            'รายงาน ',
                            overflow: TextOverflow.ellipsis,
                            minFontSize: 8,
                            maxFontSize: 20,
                            style: TextStyle(
                              decoration: TextDecoration.underline,
                              color: ReportScreen_Color.Colors_Text1_,
                              fontWeight: FontWeight.bold,
                              fontFamily: FontWeight_.Fonts_T,
                            ),
                          ),
                        ),
                        const AutoSizeText(
                          ' > > ',
                          overflow: TextOverflow.ellipsis,
                          minFontSize: 8,
                          maxFontSize: 20,
                          style: TextStyle(
                            color: Colors.green,
                            fontWeight: FontWeight.bold,
                            fontFamily: FontWeight_.Fonts_T,
                          ),
                        ),
                      ],
                    ),
                  ),
                ),
              ),
            ),
            Padding(
                padding: const EdgeInsets.fromLTRB(8, 8, 8, 0),
                child: Row(
                  mainAxisAlignment: MainAxisAlignment.start,
                  children: [
                    Expanded(
                      flex: 4,
                      child: Column(
                        children: const [
                          Align(
                            alignment: Alignment.topLeft,
                            child: Padding(
                              padding: EdgeInsets.fromLTRB(8, 8, 2, 8),
                              child: AutoSizeText(
                                'ภาพรวมการดำเนินการเดือนปัจจุบัน ',
                                overflow: TextOverflow.ellipsis,
                                minFontSize: 8,
                                maxFontSize: 20,
                                style: TextStyle(
                                  color: ReportScreen_Color.Colors_Text1_,
                                  fontWeight: FontWeight.bold,
                                  fontFamily: FontWeight_.Fonts_T,
                                ),
                              ),
                            ),
                          ),
                        ],
                      ),
                    ),
                  ],
                )),
/////---------------------------------------------->
            (!Responsive.isDesktop(context))
                ? BodyHome_mobile()
                : BodyHome_Web(),
////---------------------------------------------->
            Padding(
              padding: const EdgeInsets.fromLTRB(8, 8, 8, 0),
              child: Container(
                height: MediaQuery.of(context).size.height * 0.6,
                decoration: const BoxDecoration(
                  color: Colors.white,
                  borderRadius: BorderRadius.only(
                      topLeft: Radius.circular(10),
                      topRight: Radius.circular(10),
                      bottomLeft: Radius.circular(10),
                      bottomRight: Radius.circular(10)),
                  // border: Border.all(color: Colors.grey, width: 1),
                ),
                child: ListView(
                  padding: const EdgeInsets.all(8),
                  children: <Widget>[
                    Row(
                      children: [
                        Padding(
                          padding: const EdgeInsets.all(8.0),
                          child: Text(
                            'รายงานรูปแบบพิเศษเฉพาะ \"ตลาดประตูเชียงใหม่ (ser : ${renTal_user})"',
                            style: const TextStyle(
                              color: ReportScreen_Color.Colors_Text1_,
                              fontWeight: FontWeight.bold,
                              fontFamily: FontWeight_.Fonts_T,
                            ),
                          ),
                        ),
                      ],
                    ),
                    Row(
                      children: [
                        const Padding(
                          padding: EdgeInsets.all(8.0),
                          child: Text(
                            'วันที่ :',
                            style: TextStyle(
                              color: ReportScreen_Color.Colors_Text2_,
                              // fontWeight: FontWeight.bold,
                              fontFamily: Font_.Fonts_T,
                            ),
                          ),
                        ),
                        Padding(
                          padding: const EdgeInsets.all(8.0),
                          child: InkWell(
                            onTap: () {
                              _select_StartDate(context);
                            },
                            child: Container(
                                decoration: BoxDecoration(
                                  color: AppbackgroundColor.Sub_Abg_Colors,
                                  borderRadius: const BorderRadius.only(
                                      topLeft: Radius.circular(10),
                                      topRight: Radius.circular(10),
                                      bottomLeft: Radius.circular(10),
                                      bottomRight: Radius.circular(10)),
                                  border:
                                      Border.all(color: Colors.grey, width: 1),
                                ),
                                width: 120,
                                padding: const EdgeInsets.all(8.0),
                                child: Center(
                                  child: Text(
                                    (Value_selectDate1 == null)
                                        ? 'เลือก'
                                        : '$Value_selectDate1',
                                    style: const TextStyle(
                                      color: ReportScreen_Color.Colors_Text2_,
                                      // fontWeight: FontWeight.bold,
                                      fontFamily: Font_.Fonts_T,
                                    ),
                                  ),
                                )),
                          ),
                        ),
                        const Padding(
                          padding: EdgeInsets.all(8.0),
                          child: Text(
                            'ถึง',
                            style: TextStyle(
                              color: ReportScreen_Color.Colors_Text1_,
                              fontWeight: FontWeight.bold,
                              fontFamily: FontWeight_.Fonts_T,
                            ),
                          ),
                        ),
                        Padding(
                          padding: const EdgeInsets.all(8.0),
                          child: InkWell(
                            onTap: () {
                              _select_EndDate(context);
                            },
                            child: Container(
                                decoration: BoxDecoration(
                                  color: AppbackgroundColor.Sub_Abg_Colors,
                                  borderRadius: const BorderRadius.only(
                                      topLeft: Radius.circular(10),
                                      topRight: Radius.circular(10),
                                      bottomLeft: Radius.circular(10),
                                      bottomRight: Radius.circular(10)),
                                  border:
                                      Border.all(color: Colors.grey, width: 1),
                                ),
                                width: 120,
                                padding: const EdgeInsets.all(8.0),
                                child: Center(
                                  child: Text(
                                    (Value_selectDate2 == null)
                                        ? 'เลือก'
                                        : '$Value_selectDate2',
                                    style: const TextStyle(
                                      color: ReportScreen_Color.Colors_Text2_,
                                      // fontWeight: FontWeight.bold,
                                      fontFamily: Font_.Fonts_T,
                                    ),
                                  ),
                                )),
                          ),
                        ),
                      ],
                    ),
                    Padding(
                      padding: const EdgeInsets.all(8.0),
                      child: Row(
                        children: [
                          // (_TransReBillModels_Income.isEmpty)
                          //     ? Container(
                          //         decoration: BoxDecoration(
                          //           color: Colors.yellow[600],
                          //           borderRadius: const BorderRadius.only(
                          //               topLeft: Radius.circular(10),
                          //               topRight: Radius.circular(10),
                          //               bottomLeft: Radius.circular(10),
                          //               bottomRight: Radius.circular(10)),
                          //           border: Border.all(
                          //               color: Colors.grey, width: 1),
                          //         ),
                          //         padding: const EdgeInsets.all(8.0),
                          //         child: Center(
                          //           child: Row(
                          //             mainAxisAlignment:
                          //                 MainAxisAlignment.center,
                          //             children: const [
                          //               Text(
                          //                 'เรียกดู',
                          //                 style: TextStyle(
                          //                   color: ReportScreen_Color
                          //                       .Colors_Text1_,
                          //                   fontWeight: FontWeight.bold,
                          //                   fontFamily: FontWeight_.Fonts_T,
                          //                 ),
                          //               ),
                          //               Icon(
                          //                 Icons.navigate_next,
                          //                 color: Colors.grey,
                          //               )
                          //             ],
                          //           ),
                          //         ),
                          //       )
                          //     : (TransReBillModels_Income[
                          //                     _TransReBillModels_Income.length -
                          //                         1]
                          //                 .length ==
                          //             0)
                          //         ? Text('data')
                          //         :
                          InkWell(
                            child: Container(
                              decoration: BoxDecoration(
                                color: Colors.yellow[600],
                                borderRadius: const BorderRadius.only(
                                    topLeft: Radius.circular(10),
                                    topRight: Radius.circular(10),
                                    bottomLeft: Radius.circular(10),
                                    bottomRight: Radius.circular(10)),
                                border:
                                    Border.all(color: Colors.grey, width: 1),
                              ),
                              padding: const EdgeInsets.all(8.0),
                              child: Center(
                                child: Row(
                                  mainAxisAlignment: MainAxisAlignment.center,
                                  children: const [
                                    Text(
                                      'เรียกดู',
                                      style: TextStyle(
                                        color: ReportScreen_Color.Colors_Text1_,
                                        fontWeight: FontWeight.bold,
                                        fontFamily: FontWeight_.Fonts_T,
                                      ),
                                    ),
                                    Icon(
                                      Icons.navigate_next,
                                      color: Colors.grey,
                                    )
                                  ],
                                ),
                              ),
                            ),
                            onTap: (_TransReBillModels_Income.isEmpty)
                                ? null
                                : (TransReBillModels_Income[
                                            _TransReBillModels_Income.length -
                                                1]
                                        .isEmpty)
                                    ? null
                                    : () async {
                                        Insert_log.Insert_logs(
                                            'รายงาน', 'กดดูรายงานรายรับ');
                                        // List show_more = [];
                                        int? show_more;

                                        double Sum_Ramt_ = 0.0;
                                        double Sum_Ramtd_ = 0.0;
                                        double Sum_Amt_ = 0.0;
                                        double Sum_Total_ = 0.0;

                                        for (int indexsum1 = 0;
                                            indexsum1 <
                                                _TransReBillModels_Income
                                                    .length;
                                            indexsum1++) {
                                          Sum_Ramt_ = Sum_Ramt_ +
                                              double.parse(
                                                  _TransReBillModels_Income[
                                                          indexsum1]
                                                      .ramt!);

                                          Sum_Ramtd_ = Sum_Ramtd_ +
                                              double.parse(
                                                  _TransReBillModels_Income[
                                                          indexsum1]
                                                      .ramtd!);

                                          Sum_Amt_ = Sum_Amt_ +
                                              double.parse(
                                                  _TransReBillModels_Income[
                                                          indexsum1]
                                                      .amt!);

                                          Sum_Total_ = Sum_Total_ +
                                              double.parse(
                                                  _TransReBillModels_Income[
                                                          indexsum1]
                                                      .total!);
                                          // for (int indexsum2 = 0;
                                          //     indexsum2 <
                                          //         TransReBillModels[indexsum1].length;
                                          //     indexsum2++) {
                                          //   Sum_Ramt_ = Sum_Ramt_ +
                                          //       double.parse(TransReBillModels[indexsum1]
                                          //               [indexsum2]
                                          //           .ramt!);
                                          //   Sum_Ramtd_ = Sum_Ramtd_ +
                                          //       double.parse(TransReBillModels[indexsum1]
                                          //               [indexsum2]
                                          //           .ramtd!);
                                          //   Sum_Amt_ = Sum_Amt_ +
                                          //       double.parse(TransReBillModels[indexsum1]
                                          //               [indexsum2]
                                          //           .amt!);
                                          //   Sum_Total_ = Sum_Total_ +
                                          //       double.parse(TransReBillModels[indexsum1]
                                          //               [indexsum2]
                                          //           .total!);
                                          // }
                                        }

                                        showDialog<void>(
                                          context: context,
                                          barrierDismissible:
                                              false, // user must tap button!
                                          builder: (BuildContext context) {
                                            return AlertDialog(
                                              shape:
                                                  const RoundedRectangleBorder(
                                                      borderRadius:
                                                          BorderRadius.all(
                                                              Radius.circular(
                                                                  20.0))),
                                              title: Column(
                                                children: [
                                                  const Center(
                                                      child: Text(
                                                    'รายงานรายรับ',
                                                    style: TextStyle(
                                                      color: ReportScreen_Color
                                                          .Colors_Text1_,
                                                      fontWeight:
                                                          FontWeight.bold,
                                                      fontFamily:
                                                          FontWeight_.Fonts_T,
                                                    ),
                                                  )),
                                                  Row(
                                                    children: [
                                                      Expanded(
                                                          flex: 1,
                                                          child: Text(
                                                            (Value_selectDate1 ==
                                                                        null &&
                                                                    Value_selectDate2 ==
                                                                        null)
                                                                ? 'วันที่: ? ถึง ?'
                                                                : (Value_selectDate1 ==
                                                                        null)
                                                                    ? 'วันที่: ? ถึง $Value_selectDate2'
                                                                    : (Value_selectDate2 ==
                                                                            null)
                                                                        ? 'วันที่: $Value_selectDate1 ถึง ?'
                                                                        : 'วันที่: $Value_selectDate1 ถึง $Value_selectDate2',
                                                            textAlign:
                                                                TextAlign.start,
                                                            style:
                                                                const TextStyle(
                                                              color: ReportScreen_Color
                                                                  .Colors_Text1_,
                                                              fontSize: 14,
                                                              // fontWeight: FontWeight.bold,
                                                              fontFamily:
                                                                  FontWeight_
                                                                      .Fonts_T,
                                                            ),
                                                          )),
                                                      Expanded(
                                                          flex: 1,
                                                          child: Text(
                                                            'ทั้งหมด: ${_TransReBillModels_Income.length}',
                                                            textAlign:
                                                                TextAlign.end,
                                                            style:
                                                                const TextStyle(
                                                              fontSize: 14,
                                                              color: ReportScreen_Color
                                                                  .Colors_Text1_,
                                                              // fontWeight: FontWeight.bold,
                                                              fontFamily:
                                                                  FontWeight_
                                                                      .Fonts_T,
                                                            ),
                                                          )),
                                                    ],
                                                  ),
                                                  const SizedBox(height: 1),
                                                  const Divider(),
                                                  const SizedBox(height: 1),
                                                ],
                                              ),
                                              content: StreamBuilder(
                                                  stream: Stream.periodic(
                                                      const Duration(
                                                          seconds: 0)),
                                                  builder: (context, snapshot) {
                                                    return ScrollConfiguration(
                                                      behavior:
                                                          ScrollConfiguration
                                                                  .of(context)
                                                              .copyWith(
                                                                  dragDevices: {
                                                            PointerDeviceKind
                                                                .touch,
                                                            PointerDeviceKind
                                                                .mouse,
                                                          }),
                                                      child:
                                                          SingleChildScrollView(
                                                        scrollDirection:
                                                            Axis.horizontal,
                                                        child: Row(
                                                          children: [
                                                            Container(
                                                              // color: Colors.grey[50],
                                                              width: (Responsive
                                                                      .isDesktop(
                                                                          context))
                                                                  ? MediaQuery.of(
                                                                              context)
                                                                          .size
                                                                          .width *
                                                                      0.9
                                                                  : (_TransReBillModels_Income
                                                                              .length ==
                                                                          0)
                                                                      ? MediaQuery.of(
                                                                              context)
                                                                          .size
                                                                          .width
                                                                      : 800,
                                                              // height:
                                                              //     MediaQuery.of(context)
                                                              //             .size
                                                              //             .height *
                                                              //         0.3,
                                                              child: (_TransReBillModels_Income
                                                                          .length ==
                                                                      0)
                                                                  ? Column(
                                                                      mainAxisAlignment:
                                                                          MainAxisAlignment
                                                                              .center,
                                                                      children: const [
                                                                        Center(
                                                                          child:
                                                                              Text(
                                                                            'ไม่พบข้อมูล ณ วันที่เลือก',
                                                                            style:
                                                                                TextStyle(
                                                                              color: ReportScreen_Color.Colors_Text1_,
                                                                              fontWeight: FontWeight.bold,
                                                                              fontFamily: FontWeight_.Fonts_T,
                                                                            ),
                                                                          ),
                                                                        ),
                                                                      ],
                                                                    )
                                                                  : Column(
                                                                      children: <
                                                                          Widget>[
                                                                        // for (int index1 = 0;
                                                                        //     index1 <
                                                                        //         _TransReBillModels
                                                                        //             .length;
                                                                        //     index1++)
                                                                        Container(
                                                                            height: MediaQuery.of(context).size.height *
                                                                                0.45,
                                                                            child:
                                                                                ListView.builder(
                                                                              itemCount: _TransReBillModels_Income.length,
                                                                              itemBuilder: (BuildContext context, int index1) {
                                                                                return ListTile(
                                                                                  title: SizedBox(
                                                                                    child: Column(
                                                                                      children: [
                                                                                        Container(
                                                                                          child: Row(
                                                                                            mainAxisAlignment: MainAxisAlignment.start,
                                                                                            children: [
                                                                                              Container(
                                                                                                decoration: const BoxDecoration(
                                                                                                  color: AppbackgroundColor.TiTile_Colors,
                                                                                                  borderRadius: BorderRadius.only(topLeft: Radius.circular(5), topRight: Radius.circular(5), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                ),
                                                                                                padding: const EdgeInsets.all(4.0),
                                                                                                child: Text(
                                                                                                  //            '${_TransReBillModels_Income[index1].docno}',
                                                                                                  _TransReBillModels_Income[index1].docno == '' ? '${index1 + 1}. เลขที่: ${_TransReBillModels_Income[index1].docno}' : '${index1 + 1}. เลขที่: ${_TransReBillModels_Income[index1].refno}',
                                                                                                  style: const TextStyle(
                                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                                    fontWeight: FontWeight.bold,
                                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                                  ),
                                                                                                ),
                                                                                              ),
                                                                                              // Expanded(
                                                                                              //   child: Text(
                                                                                              //     (_TransReBillModels_Income[index1].sname == null || _TransReBillModels_Income[index1].sname == Null) ? '${_TransReBillModels_Income[index1].remark1}' : '${_TransReBillModels_Income[index1].sname}',
                                                                                              //     textAlign: TextAlign.end,
                                                                                              //     style: const TextStyle(
                                                                                              //       color: ReportScreen_Color.Colors_Text1_,
                                                                                              //       fontWeight: FontWeight.bold,
                                                                                              //       fontFamily: FontWeight_.Fonts_T,
                                                                                              //     ),
                                                                                              //   ),
                                                                                              // )
                                                                                            ],
                                                                                          ),
                                                                                        ),
                                                                                        if (show_more != index1)
                                                                                          SizedBox(
                                                                                            child: Column(
                                                                                              children: [
                                                                                                Container(
                                                                                                  decoration: BoxDecoration(
                                                                                                    color: AppbackgroundColor.TiTile_Colors.withOpacity(0.7),
                                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                  ),
                                                                                                  // padding: const EdgeInsets.all(4.0),
                                                                                                  child: Row(
                                                                                                    children: const [
                                                                                                      SizedBox(
                                                                                                        width: 20,
                                                                                                      ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     'รหัสพื้นที่',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: FontWeight_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     'ชื่อร้านค้า',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: FontWeight_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'วันที่',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'ชื่อร้านค้า',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'รูปแบบชำระ',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     'ธนาคาร',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: FontWeight_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),

                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'รายการทั้งหมด',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'รวม70%',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'รวม30%',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'รวม',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          '...',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                    ],
                                                                                                  ),
                                                                                                ),
                                                                                                Container(
                                                                                                  decoration: BoxDecoration(
                                                                                                    color: Colors.grey[200],
                                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                  ),
                                                                                                  // padding: const EdgeInsets.all(4.0),
                                                                                                  child: Row(
                                                                                                    children: [
                                                                                                      const SizedBox(
                                                                                                        width: 20,
                                                                                                      ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     (_TransReBillModels[index1].ln == null) ? '' : '${_TransReBillModels[index1].ln}',
                                                                                                      //     // '${TransReBillModels[index1].length}',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: const TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       // fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: Font_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     (_TransReBillModels[index1].sname == null) ? '' : '${_TransReBillModels[index1].sname}',
                                                                                                      //     // '${TransReBillModels[index1].length}',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: const TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       // fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: Font_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          '${_TransReBillModels_Income[index1].daterec}',
                                                                                                          // '${TransReBillModels[index1].length}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          (_TransReBillModels_Income[index1].sname == null || _TransReBillModels_Income[index1].sname.toString() == '') ? '${_TransReBillModels_Income[index1].remark1}' : '${_TransReBillModels_Income[index1].sname}',
                                                                                                          // '${TransReBillModels[index1].length}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          '${_TransReBillModels_Income[index1].type}',
                                                                                                          // '${TransReBillModels[index1].length}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     '${_TransReBillModels[index1].bank}',
                                                                                                      //     // '${TransReBillModels[index1].length}',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: const TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       // fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: Font_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          //'ttt',
                                                                                                          '${nFormat2.format(double.parse(TransReBillModels_Income[index1].length.toString()))}',
                                                                                                          // '${TransReBillModels[index1].length}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          // '${_TransReBillModels_Income[index1].ramt}',
                                                                                                          (_TransReBillModels_Income[index1].ramt == null) ? '' : '${nFormat.format(double.parse(_TransReBillModels_Income[index1].ramt!))}',
                                                                                                          // '${_TransReBillModels[index1].ramt}',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          // '${_TransReBillModels_Income[index1].ramtd}',
                                                                                                          (_TransReBillModels_Income[index1].ramtd == null) ? '' : '${nFormat.format(double.parse(_TransReBillModels_Income[index1].ramtd!))}',
                                                                                                          //'${nFormat.format(double.parse(_TransReBillModels_Income[index1].ramtd!))}',
                                                                                                          //  '${_TransReBillModels[index1].ramtd}',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          '${nFormat.format(double.parse(_TransReBillModels_Income[index1].total!))}',
                                                                                                          // '${_TransReBillModels[index1].total_bill}',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Padding(
                                                                                                          padding: const EdgeInsets.all(8.0),
                                                                                                          child: Row(
                                                                                                            mainAxisAlignment: MainAxisAlignment.center,
                                                                                                            children: [
                                                                                                              InkWell(
                                                                                                                onTap: () {
                                                                                                                  setState(() {
                                                                                                                    show_more = index1;
                                                                                                                  });
                                                                                                                },
                                                                                                                child: Container(
                                                                                                                  width: 100,
                                                                                                                  decoration: BoxDecoration(
                                                                                                                    color: Colors.green[300],
                                                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(10), topRight: Radius.circular(10), bottomLeft: Radius.circular(10), bottomRight: Radius.circular(10)),
                                                                                                                  ),
                                                                                                                  padding: const EdgeInsets.all(4.0),
                                                                                                                  child: const Center(
                                                                                                                    child: Text(
                                                                                                                      'ดูเพิ่มเติม',
                                                                                                                      style: TextStyle(
                                                                                                                        color: ReportScreen_Color.Colors_Text1_,
                                                                                                                        // fontWeight: FontWeight.bold,
                                                                                                                        fontFamily: Font_.Fonts_T,
                                                                                                                      ),
                                                                                                                    ),
                                                                                                                  ),
                                                                                                                ),
                                                                                                              ),
                                                                                                            ],
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                    ],
                                                                                                  ),
                                                                                                ),
                                                                                              ],
                                                                                            ),
                                                                                          ),
                                                                                        if (show_more == index1)
                                                                                          SizedBox(
                                                                                            child: Column(
                                                                                              children: [
                                                                                                Stack(
                                                                                                  children: [
                                                                                                    Container(
                                                                                                      decoration: BoxDecoration(
                                                                                                        color: AppbackgroundColor.TiTile_Colors.withOpacity(0.7),
                                                                                                        borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                      ),
                                                                                                      padding: const EdgeInsets.all(4.0),
                                                                                                      child: Row(
                                                                                                        children: const [
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ลำดับ',
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'วันที่',
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'รายการ',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'Vat%',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'หน่วย',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'VAT',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              '70 %',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              '30 %',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ราคาก่อน Vat',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ราคารวม Vat',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                        ],
                                                                                                      ),
                                                                                                    ),
                                                                                                    Positioned(
                                                                                                        top: 0,
                                                                                                        right: 2,
                                                                                                        child: InkWell(
                                                                                                          onTap: () {
                                                                                                            setState(() {
                                                                                                              show_more = null;
                                                                                                            });
                                                                                                          },
                                                                                                          child: const Icon(
                                                                                                            Icons.cancel,
                                                                                                            color: Colors.red,
                                                                                                          ),
                                                                                                        ))
                                                                                                  ],
                                                                                                ),
                                                                                                for (int index2 = 0; index2 < TransReBillModels_Income[index1].length; index2++)
                                                                                                  Container(
                                                                                                    color: Colors.green[100]!.withOpacity(0.5),
                                                                                                    padding: const EdgeInsets.fromLTRB(5, 0, 5, 0),
                                                                                                    // padding: const EdgeInsets.all(4.0),
                                                                                                    child: Column(
                                                                                                      children: [
                                                                                                        Row(
                                                                                                          children: [
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${index1 + 1}.${index2 + 1}',
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${TransReBillModels_Income[index1][index2].date}',
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${TransReBillModels_Income[index1][index2].expname}',
                                                                                                                textAlign: TextAlign.center,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${TransReBillModels_Income[index1][index2].nvat}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${TransReBillModels_Income[index1][index2].vtype}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].vat!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                (TransReBillModels_Income[index1][index2].ramt.toString() == 'null') ? '-' : '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].ramt!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                (TransReBillModels_Income[index1][index2].ramtd.toString() == 'null') ? '-' : '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].ramtd!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].amt!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${nFormat.format(double.parse(TransReBillModels_Income[index1][index2].total!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            // Expanded(
                                                                                                            //   flex: 1,
                                                                                                            //   child: Text(
                                                                                                            //     (TransReBillModels[index1][index2].sname == null) ? '' : '**${TransReBillModels[index1][index2].sname!}',
                                                                                                            //     style: const TextStyle(
                                                                                                            //       color: ReportScreen_Color.Colors_Text2_,
                                                                                                            //       // fontWeight:
                                                                                                            //       //     FontWeight.bold,
                                                                                                            //       fontFamily: Font_.Fonts_T,
                                                                                                            //     ),
                                                                                                            //   ),
                                                                                                            // ),
                                                                                                          ],
                                                                                                        ),
                                                                                                        const SizedBox(
                                                                                                          height: 10,
                                                                                                        )
                                                                                                      ],
                                                                                                    ),
                                                                                                  ),
                                                                                              ],
                                                                                            ),
                                                                                          ),
                                                                                      ],
                                                                                    ),
                                                                                  ),
                                                                                );
                                                                              },
                                                                            )),
                                                                      ],
                                                                    ),
                                                            ),
                                                          ],
                                                        ),
                                                      ),
                                                    );
                                                  }),
                                              actions: <Widget>[
                                                Padding(
                                                  padding:
                                                      const EdgeInsets.fromLTRB(
                                                          8, 0, 20, 4),
                                                  child: Row(
                                                    mainAxisAlignment:
                                                        MainAxisAlignment.end,
                                                    children: [
                                                      StreamBuilder(
                                                          stream:
                                                              Stream.periodic(
                                                                  const Duration(
                                                                      seconds:
                                                                          0)),
                                                          builder: (context,
                                                              snapshot) {
                                                            return Padding(
                                                              padding:
                                                                  const EdgeInsets
                                                                          .fromLTRB(
                                                                      8,
                                                                      0,
                                                                      20,
                                                                      4),
                                                              child: Row(
                                                                mainAxisAlignment:
                                                                    MainAxisAlignment
                                                                        .end,
                                                                children: [
                                                                  SizedBox(
                                                                    height: 120,
                                                                    width: 240,
                                                                    child:
                                                                        Column(
                                                                      children: [
                                                                        Row(
                                                                          children: [
                                                                            Expanded(
                                                                                child: Container(
                                                                              decoration: const BoxDecoration(
                                                                                color: AppbackgroundColor.TiTile_Colors,
                                                                                borderRadius: BorderRadius.only(topLeft: Radius.circular(5), topRight: Radius.circular(5), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                              ),
                                                                              child: const Center(
                                                                                child: Text(
                                                                                  'รวม',
                                                                                  maxLines: 1,
                                                                                  textAlign: TextAlign.start,
                                                                                  style: TextStyle(
                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                    fontWeight: FontWeight.bold,
                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                  ),
                                                                                ),
                                                                              ),
                                                                            ))
                                                                          ],
                                                                        ),
                                                                        Row(
                                                                          children: [
                                                                            Expanded(
                                                                              flex: 1,
                                                                              child: Container(
                                                                                  decoration: BoxDecoration(
                                                                                    color: Colors.grey[300],
                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                  ),
                                                                                  child: const Text(
                                                                                    'รวม 70%',
                                                                                    maxLines: 1,
                                                                                    textAlign: TextAlign.start,
                                                                                    style: TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text1_,
                                                                                      fontWeight: FontWeight.bold,
                                                                                      fontFamily: FontWeight_.Fonts_T,
                                                                                    ),
                                                                                  )),
                                                                            ),
                                                                            Expanded(
                                                                              flex: 1,
                                                                              child: Container(
                                                                                  color: Colors.grey[200],
                                                                                  child: Text(
                                                                                    '${nFormat.format(Sum_Ramt_)}',
                                                                                    maxLines: 1,
                                                                                    textAlign: TextAlign.end,
                                                                                    style: const TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                      fontWeight: FontWeight.bold,
                                                                                      fontFamily: Font_.Fonts_T,
                                                                                    ),
                                                                                  )),
                                                                            ),
                                                                          ],
                                                                        ),
                                                                        Row(
                                                                          children: [
                                                                            Expanded(
                                                                              flex: 1,
                                                                              child: Container(
                                                                                  decoration: BoxDecoration(
                                                                                    color: Colors.grey[300],
                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                  ),
                                                                                  child: const Text(
                                                                                    'รวม 30%',
                                                                                    maxLines: 1,
                                                                                    textAlign: TextAlign.start,
                                                                                    style: TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text1_,
                                                                                      fontWeight: FontWeight.bold,
                                                                                      fontFamily: FontWeight_.Fonts_T,
                                                                                    ),
                                                                                  )),
                                                                            ),
                                                                            Expanded(
                                                                              flex: 1,
                                                                              child: Container(
                                                                                  color: Colors.grey[200],
                                                                                  child: Text(
                                                                                    '${nFormat.format(Sum_Ramtd_)}',
                                                                                    maxLines: 1,
                                                                                    textAlign: TextAlign.end,
                                                                                    style: const TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                      fontWeight: FontWeight.bold,
                                                                                      fontFamily: Font_.Fonts_T,
                                                                                    ),
                                                                                  )),
                                                                            ),
                                                                          ],
                                                                        ),
                                                                        // Row(
                                                                        //   children: [
                                                                        //     Expanded(
                                                                        //       flex: 1,
                                                                        //       child: Container(
                                                                        //           decoration:
                                                                        //               BoxDecoration(
                                                                        //             color: Colors
                                                                        //                     .grey[
                                                                        //                 300],
                                                                        //             borderRadius: const BorderRadius
                                                                        //                     .only(
                                                                        //                 topLeft:
                                                                        //                     Radius.circular(
                                                                        //                         0),
                                                                        //                 topRight:
                                                                        //                     Radius.circular(
                                                                        //                         0),
                                                                        //                 bottomLeft:
                                                                        //                     Radius.circular(
                                                                        //                         0),
                                                                        //                 bottomRight:
                                                                        //                     Radius.circular(0)),
                                                                        //           ),
                                                                        //           child:
                                                                        //               const Text(
                                                                        //             'รวมราคาก่อน Vat',
                                                                        //             maxLines: 1,
                                                                        //             textAlign:
                                                                        //                 TextAlign
                                                                        //                     .start,
                                                                        //             style:
                                                                        //                 TextStyle(
                                                                        //               color: ReportScreen_Color
                                                                        //                   .Colors_Text1_,
                                                                        //               fontWeight:
                                                                        //                   FontWeight
                                                                        //                       .bold,
                                                                        //               fontFamily:
                                                                        //                   FontWeight_
                                                                        //                       .Fonts_T,
                                                                        //             ),
                                                                        //           )),
                                                                        //     ),
                                                                        //     Expanded(
                                                                        //       flex: 1,
                                                                        //       child: Container(
                                                                        //           color: Colors
                                                                        //                   .grey[
                                                                        //               200],
                                                                        //           child: Text(
                                                                        //             '${nFormat.format(Sum_Amt_)}',
                                                                        //             maxLines: 1,
                                                                        //             textAlign:
                                                                        //                 TextAlign
                                                                        //                     .end,
                                                                        //             style:
                                                                        //                 const TextStyle(
                                                                        //               color: ReportScreen_Color
                                                                        //                   .Colors_Text2_,
                                                                        //               fontWeight:
                                                                        //                   FontWeight
                                                                        //                       .bold,
                                                                        //               fontFamily:
                                                                        //                   Font_
                                                                        //                       .Fonts_T,
                                                                        //             ),
                                                                        //           )),
                                                                        //     ),
                                                                        //   ],
                                                                        // ),
                                                                        Row(
                                                                          children: [
                                                                            Expanded(
                                                                              flex: 1,
                                                                              child: Container(
                                                                                  decoration: BoxDecoration(
                                                                                    color: Colors.grey[300],
                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                  ),
                                                                                  child: const Text(
                                                                                    'รวม',
                                                                                    maxLines: 1,
                                                                                    textAlign: TextAlign.start,
                                                                                    style: TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text1_,
                                                                                      fontWeight: FontWeight.bold,
                                                                                      fontFamily: FontWeight_.Fonts_T,
                                                                                    ),
                                                                                  )),
                                                                            ),
                                                                            Expanded(
                                                                              flex: 1,
                                                                              child: Container(
                                                                                  color: Colors.grey[200],
                                                                                  child: Text(
                                                                                    '${nFormat.format(Sum_Total_)}',
                                                                                    maxLines: 1,
                                                                                    textAlign: TextAlign.end,
                                                                                    style: const TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                      fontWeight: FontWeight.bold,
                                                                                      fontFamily: Font_.Fonts_T,
                                                                                    ),
                                                                                  )),
                                                                            ),
                                                                          ],
                                                                        ),
                                                                      ],
                                                                    ),
                                                                  )
                                                                ],
                                                              ),
                                                            );
                                                          }),
                                                    ],
                                                  ),
                                                ),
                                                const SizedBox(height: 1),
                                                const Divider(),
                                                const SizedBox(height: 1),
                                                Padding(
                                                  padding:
                                                      const EdgeInsets.fromLTRB(
                                                          8, 4, 8, 4),
                                                  child: SingleChildScrollView(
                                                    scrollDirection:
                                                        Axis.horizontal,
                                                    child: Row(
                                                      mainAxisAlignment:
                                                          MainAxisAlignment.end,
                                                      children: [
                                                        if (_TransReBillModels_Income
                                                                .length !=
                                                            0)
                                                          Padding(
                                                            padding:
                                                                const EdgeInsets
                                                                    .all(8.0),
                                                            child: InkWell(
                                                              child: Container(
                                                                width: 100,
                                                                decoration:
                                                                    const BoxDecoration(
                                                                  color: Colors
                                                                      .blue,
                                                                  borderRadius: BorderRadius.only(
                                                                      topLeft:
                                                                          Radius.circular(
                                                                              10),
                                                                      topRight:
                                                                          Radius.circular(
                                                                              10),
                                                                      bottomLeft:
                                                                          Radius.circular(
                                                                              10),
                                                                      bottomRight:
                                                                          Radius.circular(
                                                                              10)),
                                                                ),
                                                                padding:
                                                                    const EdgeInsets
                                                                            .all(
                                                                        8.0),
                                                                child:
                                                                    const Center(
                                                                  child: Text(
                                                                    'Export file',
                                                                    style:
                                                                        TextStyle(
                                                                      color: Colors
                                                                          .white,
                                                                      fontWeight:
                                                                          FontWeight
                                                                              .bold,
                                                                      fontFamily:
                                                                          Font_
                                                                              .Fonts_T,
                                                                    ),
                                                                  ),
                                                                ),
                                                              ),
                                                              onTap: () {
                                                                setState(() {
                                                                  Value_Report =
                                                                      'รายงานรายรับ';
                                                                  Pre_and_Dow =
                                                                      'Download';
                                                                });
                                                                // Navigator.pop(context);
                                                                _showMyDialog_SAVE();
                                                              },
                                                            ),
                                                          ),
                                                        // if (_TransReBillModels_Income
                                                        //         .length !=
                                                        //     0)
                                                        //   Padding(
                                                        //     padding:
                                                        //         const EdgeInsets.all(8.0),
                                                        //     child: InkWell(
                                                        //       child: Container(
                                                        //         width: 100,
                                                        //         decoration:
                                                        //             const BoxDecoration(
                                                        //           color: Colors.green,
                                                        //           borderRadius:
                                                        //               BorderRadius.only(
                                                        //                   topLeft: Radius
                                                        //                       .circular(
                                                        //                           10),
                                                        //                   topRight: Radius
                                                        //                       .circular(
                                                        //                           10),
                                                        //                   bottomLeft: Radius
                                                        //                       .circular(
                                                        //                           10),
                                                        //                   bottomRight: Radius
                                                        //                       .circular(
                                                        //                           10)),
                                                        //         ),
                                                        //         padding:
                                                        //             const EdgeInsets.all(
                                                        //                 8.0),
                                                        //         child: const Center(
                                                        //           child: Text(
                                                        //             'Print',
                                                        //             style: TextStyle(
                                                        //               color: Colors.white,
                                                        //               fontWeight:
                                                        //                   FontWeight.bold,
                                                        //               fontFamily:
                                                        //                   Font_.Fonts_T,
                                                        //             ),
                                                        //           ),
                                                        //         ),
                                                        //       ),
                                                        //       onTap: () async {
                                                        //         setState(() {
                                                        //           Value_Report =
                                                        //               'รายงานรายรับ';
                                                        //           Pre_and_Dow = 'Preview';
                                                        //         });
                                                        //         Navigator.pop(context);

                                                        //         _displayPdf_();
                                                        //       },
                                                        //     ),
                                                        //   ),
                                                        Padding(
                                                          padding:
                                                              const EdgeInsets
                                                                  .all(8.0),
                                                          child: InkWell(
                                                            child: Container(
                                                              width: 100,
                                                              decoration:
                                                                  const BoxDecoration(
                                                                color: Colors
                                                                    .black,
                                                                borderRadius: BorderRadius.only(
                                                                    topLeft: Radius
                                                                        .circular(
                                                                            10),
                                                                    topRight: Radius
                                                                        .circular(
                                                                            10),
                                                                    bottomLeft:
                                                                        Radius.circular(
                                                                            10),
                                                                    bottomRight:
                                                                        Radius.circular(
                                                                            10)),
                                                              ),
                                                              padding:
                                                                  const EdgeInsets
                                                                      .all(8.0),
                                                              child:
                                                                  const Center(
                                                                child: Text(
                                                                  'ปิด',
                                                                  style:
                                                                      TextStyle(
                                                                    color: Colors
                                                                        .white,
                                                                    fontWeight:
                                                                        FontWeight
                                                                            .bold,
                                                                    fontFamily:
                                                                        Font_
                                                                            .Fonts_T,
                                                                  ),
                                                                ),
                                                              ),
                                                            ),
                                                            onTap: () {
                                                              Navigator.of(
                                                                      context)
                                                                  .pop();
                                                            },
                                                          ),
                                                        ),
                                                      ],
                                                    ),
                                                  ),
                                                ),
                                              ],
                                            );
                                          },
                                        );
                                      },
                          ),
                          (_TransReBillModels_Income.isEmpty)
                              ? Padding(
                                  padding: const EdgeInsets.all(8.0),
                                  child: Text(
                                    (Value_selectDate2 != null &&
                                            _TransReBillModels_Income.isEmpty)
                                        ? 'รายงานรายรับ (ไม่พบข้อมูล ✖️)'
                                        : 'รายงานรายรับ',
                                    // 'รายงานรายรับ',
                                    style: const TextStyle(
                                      color: ReportScreen_Color.Colors_Text2_,
                                      // fontWeight: FontWeight.bold,
                                      fontFamily: Font_.Fonts_T,
                                    ),
                                  ),
                                )
                              : (TransReBillModels_Income[
                                          _TransReBillModels_Income.length - 1]
                                      .isEmpty)
                                  ? SizedBox(
                                      // height: 20,
                                      child: Row(
                                      children: [
                                        Container(
                                            padding: const EdgeInsets.all(4.0),
                                            child:
                                                const CircularProgressIndicator()),
                                        const Padding(
                                          padding: EdgeInsets.all(8.0),
                                          child: Text(
                                            'กำลังโหลดรายงานรายรับ...',
                                            style: TextStyle(
                                              color: ReportScreen_Color
                                                  .Colors_Text2_,
                                              // fontWeight: FontWeight.bold,
                                              fontFamily: Font_.Fonts_T,
                                            ),
                                          ),
                                        ),
                                      ],
                                    ))
                                  : const Padding(
                                      padding: EdgeInsets.all(8.0),
                                      child: Text(
                                        'รายงานรายรับ ✔️',
                                        style: TextStyle(
                                          color:
                                              ReportScreen_Color.Colors_Text2_,
                                          // fontWeight: FontWeight.bold,
                                          fontFamily: Font_.Fonts_T,
                                        ),
                                      ),
                                    ),
                        ],
                      ),
                    ),
                    // Padding(
                    //   padding: const EdgeInsets.all(8.0),
                    //   child: Row(
                    //     children: [
                    //       InkWell(
                    //         child: Container(
                    //           decoration: BoxDecoration(
                    //             color: Colors.yellow[600],
                    //             borderRadius: const BorderRadius.only(
                    //                 topLeft: Radius.circular(10),
                    //                 topRight: Radius.circular(10),
                    //                 bottomLeft: Radius.circular(10),
                    //                 bottomRight: Radius.circular(10)),
                    //             border:
                    //                 Border.all(color: Colors.grey, width: 1),
                    //           ),
                    //           padding: const EdgeInsets.all(8.0),
                    //           child: Center(
                    //             child: Row(
                    //               mainAxisAlignment: MainAxisAlignment.center,
                    //               children: const [
                    //                 Text(
                    //                   'เรียกดู',
                    //                   style: TextStyle(
                    //                     color: ReportScreen_Color.Colors_Text1_,
                    //                     fontWeight: FontWeight.bold,
                    //                     fontFamily: FontWeight_.Fonts_T,
                    //                   ),
                    //                 ),
                    //                 Icon(
                    //                   Icons.navigate_next,
                    //                   color: Colors.grey,
                    //                 )
                    //               ],
                    //             ),
                    //           ),
                    //         ),
                    //         onTap: () async {
                    //           Insert_log.Insert_logs(
                    //               'รายงาน', 'กดดูรายงานรายจ่าย');
                    //           showDialog<void>(
                    //             context: context,
                    //             barrierDismissible:
                    //                 false, // user must tap button!
                    //             builder: (BuildContext context) {
                    //               return AlertDialog(
                    //                 shape: const RoundedRectangleBorder(
                    //                     borderRadius: BorderRadius.all(
                    //                         Radius.circular(20.0))),
                    //                 title: Column(
                    //                   children: [
                    //                     const Center(
                    //                         child: Text(
                    //                       'รายงานรายจ่าย',
                    //                       style: TextStyle(
                    //                         color: ReportScreen_Color
                    //                             .Colors_Text1_,
                    //                         fontWeight: FontWeight.bold,
                    //                         fontFamily: FontWeight_.Fonts_T,
                    //                       ),
                    //                     )),
                    //                     Row(
                    //                       children: [
                    //                         Expanded(
                    //                             flex: 1,
                    //                             child: Text(
                    //                               'วันที่: $Value_selectDate1 ถึง  $Value_selectDate2',
                    //                               textAlign: TextAlign.start,
                    //                               style: const TextStyle(
                    //                                 color: ReportScreen_Color
                    //                                     .Colors_Text1_,
                    //                                 fontSize: 14,
                    //                                 // fontWeight: FontWeight.bold,
                    //                                 fontFamily:
                    //                                     FontWeight_.Fonts_T,
                    //                               ),
                    //                             )),
                    //                         const Expanded(
                    //                             flex: 1,
                    //                             child: Text(
                    //                               'ทั้งหมด: ',
                    //                               textAlign: TextAlign.end,
                    //                               style: TextStyle(
                    //                                 fontSize: 14,
                    //                                 color: ReportScreen_Color
                    //                                     .Colors_Text1_,
                    //                                 // fontWeight: FontWeight.bold,
                    //                                 fontFamily:
                    //                                     FontWeight_.Fonts_T,
                    //                               ),
                    //                             )),
                    //                       ],
                    //                     ),
                    //                     const SizedBox(height: 1),
                    //                     const Divider(),
                    //                     const SizedBox(height: 1),
                    //                   ],
                    //                 ),
                    //                 content: ScrollConfiguration(
                    //                   behavior: ScrollConfiguration.of(context)
                    //                       .copyWith(dragDevices: {
                    //                     PointerDeviceKind.touch,
                    //                     PointerDeviceKind.mouse,
                    //                   }),
                    //                   child: SingleChildScrollView(
                    //                     scrollDirection: Axis.horizontal,
                    //                     child: Row(
                    //                       children: [
                    //                         Container(
                    //                           color: Colors.grey[50],
                    //                           width: (Responsive.isDesktop(
                    //                                   context))
                    //                               ? MediaQuery.of(context)
                    //                                       .size
                    //                                       .width *
                    //                                   0.9
                    //                               : 800,
                    //                           child: Column(
                    //                             children: <Widget>[
                    //                               Container(
                    //                                 decoration:
                    //                                     const BoxDecoration(
                    //                                   color: AppbackgroundColor
                    //                                       .TiTile_Colors,
                    //                                   borderRadius:
                    //                                       BorderRadius.only(
                    //                                           topLeft: Radius
                    //                                               .circular(5),
                    //                                           topRight: Radius
                    //                                               .circular(5),
                    //                                           bottomLeft: Radius
                    //                                               .circular(0),
                    //                                           bottomRight:
                    //                                               Radius
                    //                                                   .circular(
                    //                                                       0)),
                    //                                 ),
                    //                                 padding:
                    //                                     const EdgeInsets.all(
                    //                                         4.0),
                    //                                 child: Row(
                    //                                   children: const [
                    //                                     Expanded(
                    //                                       flex: 1,
                    //                                       child: Center(
                    //                                           child: Text(
                    //                                         'ลำดับ',
                    //                                         style: TextStyle(
                    //                                           color: ReportScreen_Color
                    //                                               .Colors_Text1_,
                    //                                           fontWeight:
                    //                                               FontWeight
                    //                                                   .bold,
                    //                                           fontFamily:
                    //                                               FontWeight_
                    //                                                   .Fonts_T,
                    //                                         ),
                    //                                       )),
                    //                                     ),
                    //                                     Expanded(
                    //                                       flex: 3,
                    //                                       child: Center(
                    //                                           child: Text(
                    //                                         'รายการ',
                    //                                         style: TextStyle(
                    //                                           color: ReportScreen_Color
                    //                                               .Colors_Text1_,
                    //                                           fontWeight:
                    //                                               FontWeight
                    //                                                   .bold,
                    //                                           fontFamily:
                    //                                               FontWeight_
                    //                                                   .Fonts_T,
                    //                                         ),
                    //                                       )),
                    //                                     ),
                    //                                     Expanded(
                    //                                       flex: 1,
                    //                                       child: Center(
                    //                                           child: Text(
                    //                                         'xxxxx',
                    //                                         style: TextStyle(
                    //                                           color: ReportScreen_Color
                    //                                               .Colors_Text1_,
                    //                                           fontWeight:
                    //                                               FontWeight
                    //                                                   .bold,
                    //                                           fontFamily:
                    //                                               FontWeight_
                    //                                                   .Fonts_T,
                    //                                         ),
                    //                                       )),
                    //                                     ),
                    //                                     Expanded(
                    //                                       flex: 1,
                    //                                       child: Center(
                    //                                           child: Text(
                    //                                         'xxxxx',
                    //                                         style: TextStyle(
                    //                                           color: ReportScreen_Color
                    //                                               .Colors_Text1_,
                    //                                           fontWeight:
                    //                                               FontWeight
                    //                                                   .bold,
                    //                                           fontFamily:
                    //                                               FontWeight_
                    //                                                   .Fonts_T,
                    //                                         ),
                    //                                       )),
                    //                                     ),
                    //                                   ],
                    //                                 ),
                    //                               ),
                    //                               Container(
                    //                                   width: (Responsive
                    //                                           .isDesktop(
                    //                                               context))
                    //                                       ? MediaQuery.of(
                    //                                                   context)
                    //                                               .size
                    //                                               .width *
                    //                                           0.9
                    //                                       : 800,
                    //                                   height:
                    //                                       MediaQuery.of(context)
                    //                                               .size
                    //                                               .height *
                    //                                           0.3,
                    //                                   child: ListView.builder(
                    //                                     itemCount: 5,
                    //                                     itemBuilder:
                    //                                         (BuildContext
                    //                                                 context,
                    //                                             int index) {
                    //                                       return ListTile(
                    //                                         title: Row(
                    //                                           children: [
                    //                                             Expanded(
                    //                                               flex: 1,
                    //                                               child:
                    //                                                   Container(
                    //                                                 child: Center(
                    //                                                     child: Text(
                    //                                                   '${index + 1}',
                    //                                                   maxLines:
                    //                                                       1,
                    //                                                   style:
                    //                                                       const TextStyle(
                    //                                                     color: ReportScreen_Color
                    //                                                         .Colors_Text1_,
                    //                                                     fontWeight:
                    //                                                         FontWeight.bold,
                    //                                                     fontFamily:
                    //                                                         FontWeight_.Fonts_T,
                    //                                                   ),
                    //                                                 )),
                    //                                               ),
                    //                                             ),
                    //                                             Expanded(
                    //                                               flex: 3,
                    //                                               child:
                    //                                                   Container(
                    //                                                 child: const Center(
                    //                                                     child: Text(
                    //                                                   'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX',
                    //                                                   maxLines:
                    //                                                       1,
                    //                                                   style:
                    //                                                       TextStyle(
                    //                                                     color: ReportScreen_Color
                    //                                                         .Colors_Text1_,
                    //                                                     fontWeight:
                    //                                                         FontWeight.bold,
                    //                                                     fontFamily:
                    //                                                         FontWeight_.Fonts_T,
                    //                                                   ),
                    //                                                 )),
                    //                                               ),
                    //                                             ),
                    //                                             Expanded(
                    //                                               flex: 1,
                    //                                               child:
                    //                                                   Container(
                    //                                                 child: const Center(
                    //                                                     child: Text(
                    //                                                   '300000',
                    //                                                   maxLines:
                    //                                                       1,
                    //                                                   style:
                    //                                                       TextStyle(
                    //                                                     color: ReportScreen_Color
                    //                                                         .Colors_Text1_,
                    //                                                     fontWeight:
                    //                                                         FontWeight.bold,
                    //                                                     fontFamily:
                    //                                                         FontWeight_.Fonts_T,
                    //                                                   ),
                    //                                                 )),
                    //                                               ),
                    //                                             ),
                    //                                             Expanded(
                    //                                               flex: 1,
                    //                                               child:
                    //                                                   Container(
                    //                                                 child: const Center(
                    //                                                     child: Text(
                    //                                                   '400000',
                    //                                                   maxLines:
                    //                                                       1,
                    //                                                   style:
                    //                                                       TextStyle(
                    //                                                     color: ReportScreen_Color
                    //                                                         .Colors_Text1_,
                    //                                                     fontWeight:
                    //                                                         FontWeight.bold,
                    //                                                     fontFamily:
                    //                                                         FontWeight_.Fonts_T,
                    //                                                   ),
                    //                                                 )),
                    //                                               ),
                    //                                             ),
                    //                                           ],
                    //                                         ),
                    //                                       );
                    //                                     },
                    //                                   )),
                    //                             ],
                    //                           ),
                    //                         ),
                    //                       ],
                    //                     ),
                    //                   ),
                    //                 ),
                    //                 actions: <Widget>[
                    //                   Padding(
                    //                     padding: const EdgeInsets.fromLTRB(
                    //                         8, 0, 20, 4),
                    //                     child: Row(
                    //                       mainAxisAlignment:
                    //                           MainAxisAlignment.end,
                    //                       children: [
                    //                         SizedBox(
                    //                           height: 120,
                    //                           width: 240,
                    //                           child: Column(
                    //                             children: [
                    //                               Row(
                    //                                 children: [
                    //                                   Expanded(
                    //                                       child: Container(
                    //                                     decoration:
                    //                                         const BoxDecoration(
                    //                                       color:
                    //                                           AppbackgroundColor
                    //                                               .TiTile_Colors,
                    //                                       borderRadius: BorderRadius.only(
                    //                                           topLeft: Radius
                    //                                               .circular(5),
                    //                                           topRight: Radius
                    //                                               .circular(5),
                    //                                           bottomLeft: Radius
                    //                                               .circular(0),
                    //                                           bottomRight:
                    //                                               Radius
                    //                                                   .circular(
                    //                                                       0)),
                    //                                     ),
                    //                                     child: const Center(
                    //                                       child: Text(
                    //                                         'รวม',
                    //                                         maxLines: 1,
                    //                                         textAlign:
                    //                                             TextAlign.start,
                    //                                         style: TextStyle(
                    //                                           color: ReportScreen_Color
                    //                                               .Colors_Text1_,
                    //                                           fontWeight:
                    //                                               FontWeight
                    //                                                   .bold,
                    //                                           fontFamily:
                    //                                               FontWeight_
                    //                                                   .Fonts_T,
                    //                                         ),
                    //                                       ),
                    //                                     ),
                    //                                   ))
                    //                                 ],
                    //                               ),
                    //                               Row(
                    //                                 children: [
                    //                                   Expanded(
                    //                                     flex: 1,
                    //                                     child: Container(
                    //                                         decoration:
                    //                                             BoxDecoration(
                    //                                           color: Colors
                    //                                               .grey[300],
                    //                                           borderRadius: const BorderRadius
                    //                                                   .only(
                    //                                               topLeft: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               topRight: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               bottomLeft: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               bottomRight: Radius
                    //                                                   .circular(
                    //                                                       0)),
                    //                                         ),
                    //                                         child: const Text(
                    //                                           'รวม 70%',
                    //                                           maxLines: 1,
                    //                                           textAlign:
                    //                                               TextAlign
                    //                                                   .start,
                    //                                           style: TextStyle(
                    //                                             color: ReportScreen_Color
                    //                                                 .Colors_Text1_,
                    //                                             fontWeight:
                    //                                                 FontWeight
                    //                                                     .bold,
                    //                                             fontFamily:
                    //                                                 FontWeight_
                    //                                                     .Fonts_T,
                    //                                           ),
                    //                                         )),
                    //                                   ),
                    //                                   Expanded(
                    //                                     flex: 1,
                    //                                     child: Container(
                    //                                         color: Colors
                    //                                             .grey[200],
                    //                                         child: const Text(
                    //                                           'xxxxx',
                    //                                           maxLines: 1,
                    //                                           textAlign:
                    //                                               TextAlign.end,
                    //                                           style: TextStyle(
                    //                                             color: ReportScreen_Color
                    //                                                 .Colors_Text2_,
                    //                                             fontWeight:
                    //                                                 FontWeight
                    //                                                     .bold,
                    //                                             fontFamily: Font_
                    //                                                 .Fonts_T,
                    //                                           ),
                    //                                         )),
                    //                                   ),
                    //                                 ],
                    //                               ),
                    //                               Row(
                    //                                 children: [
                    //                                   Expanded(
                    //                                     flex: 1,
                    //                                     child: Container(
                    //                                         decoration:
                    //                                             BoxDecoration(
                    //                                           color: Colors
                    //                                               .grey[300],
                    //                                           borderRadius: const BorderRadius
                    //                                                   .only(
                    //                                               topLeft: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               topRight: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               bottomLeft: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               bottomRight: Radius
                    //                                                   .circular(
                    //                                                       0)),
                    //                                         ),
                    //                                         child: const Text(
                    //                                           'รวม 30%',
                    //                                           maxLines: 1,
                    //                                           textAlign:
                    //                                               TextAlign
                    //                                                   .start,
                    //                                           style: TextStyle(
                    //                                             color: ReportScreen_Color
                    //                                                 .Colors_Text1_,
                    //                                             fontWeight:
                    //                                                 FontWeight
                    //                                                     .bold,
                    //                                             fontFamily:
                    //                                                 FontWeight_
                    //                                                     .Fonts_T,
                    //                                           ),
                    //                                         )),
                    //                                   ),
                    //                                   Expanded(
                    //                                     flex: 1,
                    //                                     child: Container(
                    //                                         color: Colors
                    //                                             .grey[200],
                    //                                         child: const Text(
                    //                                           'xxxxx',
                    //                                           maxLines: 1,
                    //                                           textAlign:
                    //                                               TextAlign.end,
                    //                                           style: TextStyle(
                    //                                             color: ReportScreen_Color
                    //                                                 .Colors_Text2_,
                    //                                             fontWeight:
                    //                                                 FontWeight
                    //                                                     .bold,
                    //                                             fontFamily: Font_
                    //                                                 .Fonts_T,
                    //                                           ),
                    //                                         )),
                    //                                   ),
                    //                                 ],
                    //                               ),
                    //                               // Row(
                    //                               //   children: [
                    //                               //     Expanded(
                    //                               //       flex: 1,
                    //                               //       child: Container(
                    //                               //           decoration:
                    //                               //               BoxDecoration(
                    //                               //             color: Colors
                    //                               //                 .grey[300],
                    //                               //             borderRadius: const BorderRadius
                    //                               //                     .only(
                    //                               //                 topLeft: Radius
                    //                               //                     .circular(
                    //                               //                         0),
                    //                               //                 topRight: Radius
                    //                               //                     .circular(
                    //                               //                         0),
                    //                               //                 bottomLeft: Radius
                    //                               //                     .circular(
                    //                               //                         0),
                    //                               //                 bottomRight: Radius
                    //                               //                     .circular(
                    //                               //                         0)),
                    //                               //           ),
                    //                               //           child: const Text(
                    //                               //             'รวมราคาก่อน Vat',
                    //                               //             maxLines: 1,
                    //                               //             textAlign:
                    //                               //                 TextAlign
                    //                               //                     .start,
                    //                               //             style: TextStyle(
                    //                               //               color: ReportScreen_Color
                    //                               //                   .Colors_Text1_,
                    //                               //               fontWeight:
                    //                               //                   FontWeight
                    //                               //                       .bold,
                    //                               //               fontFamily:
                    //                               //                   FontWeight_
                    //                               //                       .Fonts_T,
                    //                               //             ),
                    //                               //           )),
                    //                               //     ),
                    //                               //     Expanded(
                    //                               //       flex: 1,
                    //                               //       child: Container(
                    //                               //           color: Colors
                    //                               //               .grey[200],
                    //                               //           child: const Text(
                    //                               //             'xxxxxx',
                    //                               //             maxLines: 1,
                    //                               //             textAlign:
                    //                               //                 TextAlign.end,
                    //                               //             style: TextStyle(
                    //                               //               color: ReportScreen_Color
                    //                               //                   .Colors_Text2_,
                    //                               //               fontWeight:
                    //                               //                   FontWeight
                    //                               //                       .bold,
                    //                               //               fontFamily: Font_
                    //                               //                   .Fonts_T,
                    //                               //             ),
                    //                               //           )),
                    //                               //     ),
                    //                               //   ],
                    //                               // ),
                    //                               Row(
                    //                                 children: [
                    //                                   Expanded(
                    //                                     flex: 1,
                    //                                     child: Container(
                    //                                         decoration:
                    //                                             BoxDecoration(
                    //                                           color: Colors
                    //                                               .grey[300],
                    //                                           borderRadius: const BorderRadius
                    //                                                   .only(
                    //                                               topLeft: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               topRight: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               bottomLeft: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               bottomRight: Radius
                    //                                                   .circular(
                    //                                                       0)),
                    //                                         ),
                    //                                         child: const Text(
                    //                                           'รวม',
                    //                                           maxLines: 1,
                    //                                           textAlign:
                    //                                               TextAlign
                    //                                                   .start,
                    //                                           style: TextStyle(
                    //                                             color: ReportScreen_Color
                    //                                                 .Colors_Text1_,
                    //                                             fontWeight:
                    //                                                 FontWeight
                    //                                                     .bold,
                    //                                             fontFamily:
                    //                                                 FontWeight_
                    //                                                     .Fonts_T,
                    //                                           ),
                    //                                         )),
                    //                                   ),
                    //                                   Expanded(
                    //                                     flex: 1,
                    //                                     child: Container(
                    //                                         color: Colors
                    //                                             .grey[200],
                    //                                         child: const Text(
                    //                                           'xxxxxxx',
                    //                                           maxLines: 1,
                    //                                           textAlign:
                    //                                               TextAlign.end,
                    //                                           style: TextStyle(
                    //                                             color: ReportScreen_Color
                    //                                                 .Colors_Text2_,
                    //                                             fontWeight:
                    //                                                 FontWeight
                    //                                                     .bold,
                    //                                             fontFamily: Font_
                    //                                                 .Fonts_T,
                    //                                           ),
                    //                                         )),
                    //                                   ),
                    //                                 ],
                    //                               ),
                    //                             ],
                    //                           ),
                    //                         )
                    //                       ],
                    //                     ),
                    //                   ),
                    //                   const SizedBox(height: 1),
                    //                   const Divider(),
                    //                   const SizedBox(height: 1),
                    //                   Padding(
                    //                     padding: const EdgeInsets.fromLTRB(
                    //                         8, 4, 8, 4),
                    //                     child: SingleChildScrollView(
                    //                       scrollDirection: Axis.horizontal,
                    //                       child: Row(
                    //                         mainAxisAlignment:
                    //                             MainAxisAlignment.end,
                    //                         children: [
                    //                           Padding(
                    //                             padding:
                    //                                 const EdgeInsets.all(8.0),
                    //                             child: InkWell(
                    //                               child: Container(
                    //                                 width: 100,
                    //                                 decoration:
                    //                                     const BoxDecoration(
                    //                                   color: Colors.blue,
                    //                                   borderRadius:
                    //                                       BorderRadius.only(
                    //                                           topLeft: Radius
                    //                                               .circular(10),
                    //                                           topRight: Radius
                    //                                               .circular(10),
                    //                                           bottomLeft: Radius
                    //                                               .circular(10),
                    //                                           bottomRight:
                    //                                               Radius
                    //                                                   .circular(
                    //                                                       10)),
                    //                                 ),
                    //                                 padding:
                    //                                     const EdgeInsets.all(
                    //                                         8.0),
                    //                                 child: const Center(
                    //                                   child: Text(
                    //                                     'Export file',
                    //                                     style: TextStyle(
                    //                                       color: Colors.white,
                    //                                       fontWeight:
                    //                                           FontWeight.bold,
                    //                                       fontFamily:
                    //                                           Font_.Fonts_T,
                    //                                     ),
                    //                                   ),
                    //                                 ),
                    //                               ),
                    //                               onTap: () async {
                    //                                 setState(() {
                    //                                   Value_Report =
                    //                                       'รายงานรายจ่าย';
                    //                                   Pre_and_Dow = 'Download';
                    //                                 });
                    //                                 Navigator.pop(context);
                    //                                 _showMyDialog_SAVE();
                    //                               },
                    //                             ),
                    //                           ),
                    //                           // Padding(
                    //                           //   padding:
                    //                           //       const EdgeInsets.all(8.0),
                    //                           //   child: InkWell(
                    //                           //     child: Container(
                    //                           //       width: 100,
                    //                           //       decoration:
                    //                           //           const BoxDecoration(
                    //                           //         color: Colors.green,
                    //                           //         borderRadius:
                    //                           //             BorderRadius.only(
                    //                           //                 topLeft: Radius
                    //                           //                     .circular(10),
                    //                           //                 topRight: Radius
                    //                           //                     .circular(10),
                    //                           //                 bottomLeft: Radius
                    //                           //                     .circular(10),
                    //                           //                 bottomRight:
                    //                           //                     Radius
                    //                           //                         .circular(
                    //                           //                             10)),
                    //                           //       ),
                    //                           //       padding:
                    //                           //           const EdgeInsets.all(
                    //                           //               8.0),
                    //                           //       child: const Center(
                    //                           //         child: Text(
                    //                           //           'Print',
                    //                           //           style: TextStyle(
                    //                           //             color: Colors.white,
                    //                           //             fontWeight:
                    //                           //                 FontWeight.bold,
                    //                           //             fontFamily:
                    //                           //                 Font_.Fonts_T,
                    //                           //           ),
                    //                           //         ),
                    //                           //       ),
                    //                           //     ),
                    //                           //     onTap: () async {
                    //                           //       setState(() {
                    //                           //         Value_Report =
                    //                           //             'รายงานรายจ่าย';
                    //                           //         Pre_and_Dow = 'Preview';
                    //                           //       });
                    //                           //       Navigator.pop(context);

                    //                           //       _displayPdf_();
                    //                           //     },
                    //                           //   ),
                    //                           // ),
                    //                           Padding(
                    //                             padding:
                    //                                 const EdgeInsets.all(8.0),
                    //                             child: InkWell(
                    //                               child: Container(
                    //                                 width: 100,
                    //                                 decoration:
                    //                                     const BoxDecoration(
                    //                                   color: Colors.black,
                    //                                   borderRadius:
                    //                                       BorderRadius.only(
                    //                                           topLeft: Radius
                    //                                               .circular(10),
                    //                                           topRight: Radius
                    //                                               .circular(10),
                    //                                           bottomLeft: Radius
                    //                                               .circular(10),
                    //                                           bottomRight:
                    //                                               Radius
                    //                                                   .circular(
                    //                                                       10)),
                    //                                 ),
                    //                                 padding:
                    //                                     const EdgeInsets.all(
                    //                                         8.0),
                    //                                 child: const Center(
                    //                                   child: Text(
                    //                                     'ปิด',
                    //                                     style: TextStyle(
                    //                                       color: Colors.white,
                    //                                       fontWeight:
                    //                                           FontWeight.bold,
                    //                                       fontFamily:
                    //                                           Font_.Fonts_T,
                    //                                     ),
                    //                                   ),
                    //                                 ),
                    //                               ),
                    //                               onTap: () {
                    //                                 Navigator.of(context).pop();
                    //                               },
                    //                             ),
                    //                           ),
                    //                         ],
                    //                       ),
                    //                     ),
                    //                   ),
                    //                 ],
                    //               );
                    //             },
                    //           );
                    //         },
                    //       ),
                    //       const Padding(
                    //         padding: EdgeInsets.all(8.0),
                    //         child: Text(
                    //           'รายงานรายจ่าย',
                    //           style: TextStyle(
                    //             color: ReportScreen_Color.Colors_Text2_,
                    //             // fontWeight: FontWeight.bold,
                    //             fontFamily: Font_.Fonts_T,
                    //           ),
                    //         ),
                    //       ),
                    //     ],
                    //   ),
                    // ),
                    Padding(
                      padding: const EdgeInsets.all(8.0),
                      child: Row(
                        children: [
                          InkWell(
                            child: Container(
                              decoration: BoxDecoration(
                                color: Colors.yellow[600],
                                borderRadius: const BorderRadius.only(
                                    topLeft: Radius.circular(10),
                                    topRight: Radius.circular(10),
                                    bottomLeft: Radius.circular(10),
                                    bottomRight: Radius.circular(10)),
                                border:
                                    Border.all(color: Colors.grey, width: 1),
                              ),
                              padding: const EdgeInsets.all(8.0),
                              child: Center(
                                child: Row(
                                  mainAxisAlignment: MainAxisAlignment.center,
                                  children: const [
                                    Text(
                                      'เรียกดู',
                                      style: TextStyle(
                                        color: ReportScreen_Color.Colors_Text1_,
                                        fontWeight: FontWeight.bold,
                                        fontFamily: FontWeight_.Fonts_T,
                                      ),
                                    ),
                                    Icon(
                                      Icons.navigate_next,
                                      color: Colors.grey,
                                    )
                                  ],
                                ),
                              ),
                            ), //TransReBillModels_Bankmovemen
                            onTap: (_TransReBillModels_Bankmovemen.isEmpty)
                                ? null
                                : (TransReBillModels_Bankmovemen[
                                                _TransReBillModels_Bankmovemen
                                                        .length -
                                                    1]
                                            .length ==
                                        0)
                                    ? null
                                    : () {
                                        Insert_log.Insert_logs('รายงาน',
                                            'กดดูรายงานการเคลื่อนไหวธนาคาร');
                                        // List show_more = [];
                                        int? show_more;

                                        double Sum_Ramt_ = 0.0;
                                        double Sum_Ramtd_ = 0.0;
                                        double Sum_Amt_ = 0.0;
                                        double Sum_Total_ = 0.0;

                                        for (int indexsum1 = 0;
                                            indexsum1 <
                                                _TransReBillModels_Bankmovemen
                                                    .length;
                                            indexsum1++) {
                                          Sum_Ramt_ = Sum_Ramt_ +
                                              double.parse(
                                                  _TransReBillModels_Bankmovemen[
                                                          indexsum1]
                                                      .ramt!);

                                          Sum_Ramtd_ = Sum_Ramtd_ +
                                              double.parse(
                                                  _TransReBillModels_Bankmovemen[
                                                          indexsum1]
                                                      .ramtd!);

                                          Sum_Amt_ = Sum_Amt_ +
                                              double.parse(
                                                  _TransReBillModels_Bankmovemen[
                                                          indexsum1]
                                                      .amt!);

                                          Sum_Total_ = Sum_Total_ +
                                              double.parse(
                                                  _TransReBillModels_Bankmovemen[
                                                          indexsum1]
                                                      .total!);
                                          // for (int indexsum2 = 0;
                                          //     indexsum2 <
                                          //         TransReBillModels[indexsum1].length;
                                          //     indexsum2++) {
                                          //   Sum_Ramt_ = Sum_Ramt_ +
                                          //       double.parse(TransReBillModels[indexsum1]
                                          //               [indexsum2]
                                          //           .ramt!);
                                          //   Sum_Ramtd_ = Sum_Ramtd_ +
                                          //       double.parse(TransReBillModels[indexsum1]
                                          //               [indexsum2]
                                          //           .ramtd!);
                                          //   Sum_Amt_ = Sum_Amt_ +
                                          //       double.parse(TransReBillModels[indexsum1]
                                          //               [indexsum2]
                                          //           .amt!);
                                          //   Sum_Total_ = Sum_Total_ +
                                          //       double.parse(TransReBillModels[indexsum1]
                                          //               [indexsum2]
                                          //           .total!);
                                          // }
                                        }

                                        showDialog<void>(
                                          context: context,
                                          barrierDismissible:
                                              false, // user must tap button!
                                          builder: (BuildContext context) {
                                            return AlertDialog(
                                              shape:
                                                  const RoundedRectangleBorder(
                                                      borderRadius:
                                                          BorderRadius.all(
                                                              Radius.circular(
                                                                  20.0))),
                                              title: Column(
                                                children: [
                                                  const Center(
                                                      child: Text(
                                                    'รายงานการเคลื่อนไหวธนาคาร',
                                                    style: TextStyle(
                                                      color: ReportScreen_Color
                                                          .Colors_Text1_,
                                                      fontWeight:
                                                          FontWeight.bold,
                                                      fontFamily:
                                                          FontWeight_.Fonts_T,
                                                    ),
                                                  )),
                                                  Row(
                                                    children: [
                                                      Expanded(
                                                          flex: 1,
                                                          child: Text(
                                                            (Value_selectDate1 ==
                                                                        null &&
                                                                    Value_selectDate2 ==
                                                                        null)
                                                                ? 'วันที่: ? ถึง ?'
                                                                : (Value_selectDate1 ==
                                                                        null)
                                                                    ? 'วันที่: ? ถึง $Value_selectDate2'
                                                                    : (Value_selectDate2 ==
                                                                            null)
                                                                        ? 'วันที่: $Value_selectDate1 ถึง ?'
                                                                        : 'วันที่: $Value_selectDate1 ถึง $Value_selectDate2',
                                                            textAlign:
                                                                TextAlign.start,
                                                            style:
                                                                const TextStyle(
                                                              color: ReportScreen_Color
                                                                  .Colors_Text1_,
                                                              fontSize: 14,
                                                              // fontWeight: FontWeight.bold,
                                                              fontFamily:
                                                                  FontWeight_
                                                                      .Fonts_T,
                                                            ),
                                                          )),
                                                      Expanded(
                                                          flex: 1,
                                                          child: Text(
                                                            'ทั้งหมด: ${_TransReBillModels_Bankmovemen.length}',
                                                            textAlign:
                                                                TextAlign.end,
                                                            style:
                                                                const TextStyle(
                                                              fontSize: 14,
                                                              color: ReportScreen_Color
                                                                  .Colors_Text1_,
                                                              // fontWeight: FontWeight.bold,
                                                              fontFamily:
                                                                  FontWeight_
                                                                      .Fonts_T,
                                                            ),
                                                          )),
                                                    ],
                                                  ),
                                                  const SizedBox(height: 1),
                                                  const Divider(),
                                                  const SizedBox(height: 1),
                                                ],
                                              ),
                                              content: StreamBuilder(
                                                  stream: Stream.periodic(
                                                      const Duration(
                                                          seconds: 0)),
                                                  builder: (context, snapshot) {
                                                    return ScrollConfiguration(
                                                      behavior:
                                                          ScrollConfiguration
                                                                  .of(context)
                                                              .copyWith(
                                                                  dragDevices: {
                                                            PointerDeviceKind
                                                                .touch,
                                                            PointerDeviceKind
                                                                .mouse,
                                                          }),
                                                      child:
                                                          SingleChildScrollView(
                                                        scrollDirection:
                                                            Axis.horizontal,
                                                        child: Row(
                                                          children: [
                                                            Container(
                                                              // color: Colors.grey[50],
                                                              width: (Responsive
                                                                      .isDesktop(
                                                                          context))
                                                                  ? MediaQuery.of(
                                                                              context)
                                                                          .size
                                                                          .width *
                                                                      0.9
                                                                  : (_TransReBillModels_Bankmovemen
                                                                              .length ==
                                                                          0)
                                                                      ? MediaQuery.of(
                                                                              context)
                                                                          .size
                                                                          .width
                                                                      : 800,
                                                              // height:
                                                              //     MediaQuery.of(context)
                                                              //             .size
                                                              //             .height *
                                                              //         0.3,
                                                              child: (_TransReBillModels_Bankmovemen
                                                                          .length ==
                                                                      0)
                                                                  ? Column(
                                                                      mainAxisAlignment:
                                                                          MainAxisAlignment
                                                                              .center,
                                                                      children: const [
                                                                        Center(
                                                                          child:
                                                                              Text(
                                                                            'ไม่พบข้อมูล ณ วันที่เลือก',
                                                                            style:
                                                                                TextStyle(
                                                                              color: ReportScreen_Color.Colors_Text1_,
                                                                              fontWeight: FontWeight.bold,
                                                                              fontFamily: FontWeight_.Fonts_T,
                                                                            ),
                                                                          ),
                                                                        ),
                                                                      ],
                                                                    )
                                                                  : Column(
                                                                      children: <
                                                                          Widget>[
                                                                        // for (int index1 = 0;
                                                                        //     index1 <
                                                                        //         _TransReBillModels
                                                                        //             .length;
                                                                        //     index1++)
                                                                        Container(
                                                                            height: MediaQuery.of(context).size.height *
                                                                                0.45,
                                                                            child:
                                                                                ListView.builder(
                                                                              itemCount: _TransReBillModels_Bankmovemen.length,
                                                                              itemBuilder: (BuildContext context, int index1) {
                                                                                return ListTile(
                                                                                  title: SizedBox(
                                                                                    child: Column(
                                                                                      children: [
                                                                                        Container(
                                                                                          child: Row(
                                                                                            mainAxisAlignment: MainAxisAlignment.start,
                                                                                            children: [
                                                                                              Container(
                                                                                                decoration: const BoxDecoration(
                                                                                                  color: AppbackgroundColor.TiTile_Colors,
                                                                                                  borderRadius: BorderRadius.only(topLeft: Radius.circular(5), topRight: Radius.circular(5), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                ),
                                                                                                padding: const EdgeInsets.all(4.0),
                                                                                                child: Text(
                                                                                                  //            '${_TransReBillModels_Income[index1].docno}',
                                                                                                  _TransReBillModels_Bankmovemen[index1].docno == '' ? '${index1 + 1}. เลขที่: ${_TransReBillModels_Bankmovemen[index1].docno}' : '${index1 + 1}. เลขที่: ${_TransReBillModels_Bankmovemen[index1].refno}',
                                                                                                  style: const TextStyle(
                                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                                    fontWeight: FontWeight.bold,
                                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                                  ),
                                                                                                ),
                                                                                              ),
                                                                                              // Expanded(
                                                                                              //   child: Text(
                                                                                              //     (_TransReBillModels_Income[index1].sname == null || _TransReBillModels_Income[index1].sname == Null) ? '${_TransReBillModels_Income[index1].remark1}' : '${_TransReBillModels_Income[index1].sname}',
                                                                                              //     textAlign: TextAlign.end,
                                                                                              //     style: const TextStyle(
                                                                                              //       color: ReportScreen_Color.Colors_Text1_,
                                                                                              //       fontWeight: FontWeight.bold,
                                                                                              //       fontFamily: FontWeight_.Fonts_T,
                                                                                              //     ),
                                                                                              //   ),
                                                                                              // )
                                                                                            ],
                                                                                          ),
                                                                                        ),
                                                                                        if (show_more != index1)
                                                                                          SizedBox(
                                                                                            child: Column(
                                                                                              children: [
                                                                                                Container(
                                                                                                  decoration: BoxDecoration(
                                                                                                    color: AppbackgroundColor.TiTile_Colors.withOpacity(0.7),
                                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                  ),
                                                                                                  // padding: const EdgeInsets.all(4.0),
                                                                                                  child: Row(
                                                                                                    children: const [
                                                                                                      SizedBox(
                                                                                                        width: 20,
                                                                                                      ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     'รหัสพื้นที่',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: FontWeight_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     'ชื่อร้านค้า',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: FontWeight_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'วันที่',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'ชื่อร้านค้า',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'รูปแบบชำระ',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     'ธนาคาร',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: FontWeight_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),

                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'รายการทั้งหมด',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'ธนาคาร',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'เลขบช.',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'รวม',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          '...',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                    ],
                                                                                                  ),
                                                                                                ),
                                                                                                Container(
                                                                                                  decoration: BoxDecoration(
                                                                                                    color: Colors.grey[200],
                                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                  ),
                                                                                                  padding: const EdgeInsets.fromLTRB(5, 0, 5, 0),
                                                                                                  // padding: const EdgeInsets.all(4.0),
                                                                                                  child: Row(
                                                                                                    children: [
                                                                                                      const SizedBox(
                                                                                                        width: 20,
                                                                                                      ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     (_TransReBillModels[index1].ln == null) ? '' : '${_TransReBillModels[index1].ln}',
                                                                                                      //     // '${TransReBillModels[index1].length}',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: const TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       // fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: Font_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     (_TransReBillModels[index1].sname == null) ? '' : '${_TransReBillModels[index1].sname}',
                                                                                                      //     // '${TransReBillModels[index1].length}',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: const TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       // fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: Font_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          '${_TransReBillModels_Bankmovemen[index1].daterec}',
                                                                                                          // '${TransReBillModels[index1].length}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          (_TransReBillModels_Bankmovemen[index1].sname == null) ? '${_TransReBillModels_Bankmovemen[index1].remark1}' : '${_TransReBillModels_Bankmovemen[index1].sname}',
                                                                                                          // '${TransReBillModels[index1].length}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          '${_TransReBillModels_Bankmovemen[index1].type}',
                                                                                                          // '${TransReBillModels[index1].length}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     '${_TransReBillModels[index1].bank}',
                                                                                                      //     // '${TransReBillModels[index1].length}',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: const TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       // fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: Font_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          //'ttt',
                                                                                                          '${nFormat2.format(double.parse(TransReBillModels_Bankmovemen[index1].length.toString()))}',
                                                                                                          // '${TransReBillModels[index1].length}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          // '${_TransReBillModels_Income[index1].ramt}',
                                                                                                          (_TransReBillModels_Bankmovemen[index1].bank == null) ? '' : '${_TransReBillModels_Bankmovemen[index1].bank!}',
                                                                                                          // '${_TransReBillModels[index1].ramt}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          // '${_TransReBillModels_Income[index1].ramtd}',
                                                                                                          (_TransReBillModels_Bankmovemen[index1].bno == null) ? '' : '${_TransReBillModels_Bankmovemen[index1].bno!}',
                                                                                                          //'${nFormat.format(double.parse(_TransReBillModels_Income[index1].ramtd!))}',
                                                                                                          //  '${_TransReBillModels[index1].ramtd}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          '${nFormat.format(double.parse(_TransReBillModels_Bankmovemen[index1].total!))}',
                                                                                                          // '${_TransReBillModels[index1].total_bill}',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Padding(
                                                                                                          padding: const EdgeInsets.all(8.0),
                                                                                                          child: Row(
                                                                                                            mainAxisAlignment: MainAxisAlignment.center,
                                                                                                            children: [
                                                                                                              InkWell(
                                                                                                                onTap: () {
                                                                                                                  setState(() {
                                                                                                                    show_more = index1;
                                                                                                                  });
                                                                                                                },
                                                                                                                child: Container(
                                                                                                                  width: 100,
                                                                                                                  decoration: BoxDecoration(
                                                                                                                    color: Colors.green[300],
                                                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(10), topRight: Radius.circular(10), bottomLeft: Radius.circular(10), bottomRight: Radius.circular(10)),
                                                                                                                  ),
                                                                                                                  padding: const EdgeInsets.all(4.0),
                                                                                                                  child: const Center(
                                                                                                                    child: Text(
                                                                                                                      'ดูเพิ่มเติม',
                                                                                                                      style: TextStyle(
                                                                                                                        color: ReportScreen_Color.Colors_Text1_,
                                                                                                                        // fontWeight: FontWeight.bold,
                                                                                                                        fontFamily: Font_.Fonts_T,
                                                                                                                      ),
                                                                                                                    ),
                                                                                                                  ),
                                                                                                                ),
                                                                                                              ),
                                                                                                            ],
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                    ],
                                                                                                  ),
                                                                                                ),
                                                                                              ],
                                                                                            ),
                                                                                          ),
                                                                                        if (show_more == index1)
                                                                                          SizedBox(
                                                                                            child: Column(
                                                                                              children: [
                                                                                                Stack(
                                                                                                  children: [
                                                                                                    Container(
                                                                                                      decoration: BoxDecoration(
                                                                                                        color: AppbackgroundColor.TiTile_Colors.withOpacity(0.7),
                                                                                                        borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                      ),
                                                                                                      padding: const EdgeInsets.all(4.0),
                                                                                                      child: Row(
                                                                                                        children: const [
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ลำดับ',
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'วันที่',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'รายการ',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'Vat%',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'หน่วย',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'VAT',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              '70 %',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              '30 %',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ราคาก่อน Vat',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ราคารวม Vat',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                        ],
                                                                                                      ),
                                                                                                    ),
                                                                                                    Positioned(
                                                                                                        top: 0,
                                                                                                        right: 2,
                                                                                                        child: InkWell(
                                                                                                          onTap: () {
                                                                                                            setState(() {
                                                                                                              show_more = null;
                                                                                                            });
                                                                                                          },
                                                                                                          child: const Icon(
                                                                                                            Icons.cancel,
                                                                                                            color: Colors.red,
                                                                                                          ),
                                                                                                        ))
                                                                                                  ],
                                                                                                ),
                                                                                                for (int index2 = 0; index2 < TransReBillModels_Bankmovemen[index1].length; index2++)
                                                                                                  Container(
                                                                                                    color: Colors.green[100]!.withOpacity(0.5),
                                                                                                    padding: const EdgeInsets.fromLTRB(5, 0, 5, 0),
                                                                                                    // padding: const EdgeInsets.all(4.0),
                                                                                                    child: Column(
                                                                                                      children: [
                                                                                                        Row(
                                                                                                          children: [
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${index1 + 1}.${index2 + 1}',
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${TransReBillModels_Bankmovemen[index1][index2].date}',
                                                                                                                textAlign: TextAlign.center,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${TransReBillModels_Bankmovemen[index1][index2].expname}',
                                                                                                                textAlign: TextAlign.center,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${TransReBillModels_Bankmovemen[index1][index2].nvat}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${TransReBillModels_Bankmovemen[index1][index2].vtype}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${nFormat.format(double.parse(TransReBillModels_Bankmovemen[index1][index2].vat!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                (TransReBillModels_Bankmovemen[index1][index2].ramt.toString() == 'null') ? '-' : '${nFormat.format(double.parse(TransReBillModels_Bankmovemen[index1][index2].ramt!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                (TransReBillModels_Bankmovemen[index1][index2].ramtd.toString() == 'null') ? '-' : '${nFormat.format(double.parse(TransReBillModels_Bankmovemen[index1][index2].ramtd!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${nFormat.format(double.parse(TransReBillModels_Bankmovemen[index1][index2].amt!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${nFormat.format(double.parse(TransReBillModels_Bankmovemen[index1][index2].total!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            // Expanded(
                                                                                                            //   flex: 1,
                                                                                                            //   child: Text(
                                                                                                            //     (TransReBillModels[index1][index2].sname == null) ? '' : '**${TransReBillModels[index1][index2].sname!}',
                                                                                                            //     style: const TextStyle(
                                                                                                            //       color: ReportScreen_Color.Colors_Text2_,
                                                                                                            //       // fontWeight:
                                                                                                            //       //     FontWeight.bold,
                                                                                                            //       fontFamily: Font_.Fonts_T,
                                                                                                            //     ),
                                                                                                            //   ),
                                                                                                            // ),
                                                                                                          ],
                                                                                                        ),
                                                                                                        const SizedBox(
                                                                                                          height: 10,
                                                                                                        )
                                                                                                      ],
                                                                                                    ),
                                                                                                  ),
                                                                                              ],
                                                                                            ),
                                                                                          ),
                                                                                      ],
                                                                                    ),
                                                                                  ),
                                                                                );
                                                                              },
                                                                            )),
                                                                      ],
                                                                    ),
                                                            ),
                                                          ],
                                                        ),
                                                      ),
                                                    );
                                                  }),
                                              actions: <Widget>[
                                                Padding(
                                                  padding:
                                                      const EdgeInsets.fromLTRB(
                                                          8, 0, 20, 4),
                                                  child: Row(
                                                    mainAxisAlignment:
                                                        MainAxisAlignment.end,
                                                    children: [
                                                      StreamBuilder(
                                                          stream:
                                                              Stream.periodic(
                                                                  const Duration(
                                                                      seconds:
                                                                          0)),
                                                          builder: (context,
                                                              snapshot) {
                                                            return Padding(
                                                              padding:
                                                                  const EdgeInsets
                                                                          .fromLTRB(
                                                                      8,
                                                                      0,
                                                                      20,
                                                                      4),
                                                              child: Row(
                                                                mainAxisAlignment:
                                                                    MainAxisAlignment
                                                                        .end,
                                                                children: [
                                                                  SizedBox(
                                                                    height: 120,
                                                                    width: 240,
                                                                    child:
                                                                        Column(
                                                                      children: [
                                                                        Row(
                                                                          children: [
                                                                            Expanded(
                                                                                child: Container(
                                                                              decoration: const BoxDecoration(
                                                                                color: AppbackgroundColor.TiTile_Colors,
                                                                                borderRadius: BorderRadius.only(topLeft: Radius.circular(5), topRight: Radius.circular(5), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                              ),
                                                                              child: const Center(
                                                                                child: Text(
                                                                                  'รวม',
                                                                                  maxLines: 1,
                                                                                  textAlign: TextAlign.start,
                                                                                  style: TextStyle(
                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                    fontWeight: FontWeight.bold,
                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                  ),
                                                                                ),
                                                                              ),
                                                                            ))
                                                                          ],
                                                                        ),
                                                                        Row(
                                                                          children: [
                                                                            Expanded(
                                                                              flex: 1,
                                                                              child: Container(
                                                                                  decoration: BoxDecoration(
                                                                                    color: Colors.grey[300],
                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                  ),
                                                                                  child: const Text(
                                                                                    'รวม 70%',
                                                                                    maxLines: 1,
                                                                                    textAlign: TextAlign.start,
                                                                                    style: TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text1_,
                                                                                      fontWeight: FontWeight.bold,
                                                                                      fontFamily: FontWeight_.Fonts_T,
                                                                                    ),
                                                                                  )),
                                                                            ),
                                                                            Expanded(
                                                                              flex: 1,
                                                                              child: Container(
                                                                                  color: Colors.grey[200],
                                                                                  child: Text(
                                                                                    '${nFormat.format(Sum_Ramt_)}',
                                                                                    maxLines: 1,
                                                                                    textAlign: TextAlign.end,
                                                                                    style: const TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                      fontWeight: FontWeight.bold,
                                                                                      fontFamily: Font_.Fonts_T,
                                                                                    ),
                                                                                  )),
                                                                            ),
                                                                          ],
                                                                        ),
                                                                        Row(
                                                                          children: [
                                                                            Expanded(
                                                                              flex: 1,
                                                                              child: Container(
                                                                                  decoration: BoxDecoration(
                                                                                    color: Colors.grey[300],
                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                  ),
                                                                                  child: const Text(
                                                                                    'รวม 30%',
                                                                                    maxLines: 1,
                                                                                    textAlign: TextAlign.start,
                                                                                    style: TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text1_,
                                                                                      fontWeight: FontWeight.bold,
                                                                                      fontFamily: FontWeight_.Fonts_T,
                                                                                    ),
                                                                                  )),
                                                                            ),
                                                                            Expanded(
                                                                              flex: 1,
                                                                              child: Container(
                                                                                  color: Colors.grey[200],
                                                                                  child: Text(
                                                                                    '${nFormat.format(Sum_Ramtd_)}',
                                                                                    maxLines: 1,
                                                                                    textAlign: TextAlign.end,
                                                                                    style: const TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                      fontWeight: FontWeight.bold,
                                                                                      fontFamily: Font_.Fonts_T,
                                                                                    ),
                                                                                  )),
                                                                            ),
                                                                          ],
                                                                        ),
                                                                        // Row(
                                                                        //   children: [
                                                                        //     Expanded(
                                                                        //       flex: 1,
                                                                        //       child: Container(
                                                                        //           decoration:
                                                                        //               BoxDecoration(
                                                                        //             color: Colors
                                                                        //                     .grey[
                                                                        //                 300],
                                                                        //             borderRadius: const BorderRadius
                                                                        //                     .only(
                                                                        //                 topLeft:
                                                                        //                     Radius.circular(
                                                                        //                         0),
                                                                        //                 topRight:
                                                                        //                     Radius.circular(
                                                                        //                         0),
                                                                        //                 bottomLeft:
                                                                        //                     Radius.circular(
                                                                        //                         0),
                                                                        //                 bottomRight:
                                                                        //                     Radius.circular(0)),
                                                                        //           ),
                                                                        //           child:
                                                                        //               const Text(
                                                                        //             'รวมราคาก่อน Vat',
                                                                        //             maxLines: 1,
                                                                        //             textAlign:
                                                                        //                 TextAlign
                                                                        //                     .start,
                                                                        //             style:
                                                                        //                 TextStyle(
                                                                        //               color: ReportScreen_Color
                                                                        //                   .Colors_Text1_,
                                                                        //               fontWeight:
                                                                        //                   FontWeight
                                                                        //                       .bold,
                                                                        //               fontFamily:
                                                                        //                   FontWeight_
                                                                        //                       .Fonts_T,
                                                                        //             ),
                                                                        //           )),
                                                                        //     ),
                                                                        //     Expanded(
                                                                        //       flex: 1,
                                                                        //       child: Container(
                                                                        //           color: Colors
                                                                        //                   .grey[
                                                                        //               200],
                                                                        //           child: Text(
                                                                        //             '${nFormat.format(Sum_Amt_)}',
                                                                        //             maxLines: 1,
                                                                        //             textAlign:
                                                                        //                 TextAlign
                                                                        //                     .end,
                                                                        //             style:
                                                                        //                 const TextStyle(
                                                                        //               color: ReportScreen_Color
                                                                        //                   .Colors_Text2_,
                                                                        //               fontWeight:
                                                                        //                   FontWeight
                                                                        //                       .bold,
                                                                        //               fontFamily:
                                                                        //                   Font_
                                                                        //                       .Fonts_T,
                                                                        //             ),
                                                                        //           )),
                                                                        //     ),
                                                                        //   ],
                                                                        // ),
                                                                        Row(
                                                                          children: [
                                                                            Expanded(
                                                                              flex: 1,
                                                                              child: Container(
                                                                                  decoration: BoxDecoration(
                                                                                    color: Colors.grey[300],
                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                  ),
                                                                                  child: const Text(
                                                                                    'รวม',
                                                                                    maxLines: 1,
                                                                                    textAlign: TextAlign.start,
                                                                                    style: TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text1_,
                                                                                      fontWeight: FontWeight.bold,
                                                                                      fontFamily: FontWeight_.Fonts_T,
                                                                                    ),
                                                                                  )),
                                                                            ),
                                                                            Expanded(
                                                                              flex: 1,
                                                                              child: Container(
                                                                                  color: Colors.grey[200],
                                                                                  child: Text(
                                                                                    '${nFormat.format(Sum_Total_)}',
                                                                                    maxLines: 1,
                                                                                    textAlign: TextAlign.end,
                                                                                    style: const TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                      fontWeight: FontWeight.bold,
                                                                                      fontFamily: Font_.Fonts_T,
                                                                                    ),
                                                                                  )),
                                                                            ),
                                                                          ],
                                                                        ),
                                                                      ],
                                                                    ),
                                                                  )
                                                                ],
                                                              ),
                                                            );
                                                          }),
                                                    ],
                                                  ),
                                                ),
                                                const SizedBox(height: 1),
                                                const Divider(),
                                                const SizedBox(height: 1),
                                                Padding(
                                                  padding:
                                                      const EdgeInsets.fromLTRB(
                                                          8, 4, 8, 4),
                                                  child: SingleChildScrollView(
                                                    scrollDirection:
                                                        Axis.horizontal,
                                                    child: Row(
                                                      mainAxisAlignment:
                                                          MainAxisAlignment.end,
                                                      children: [
                                                        if (_TransReBillModels_Bankmovemen
                                                                .length !=
                                                            0)
                                                          Padding(
                                                            padding:
                                                                const EdgeInsets
                                                                    .all(8.0),
                                                            child: InkWell(
                                                              child: Container(
                                                                width: 100,
                                                                decoration:
                                                                    const BoxDecoration(
                                                                  color: Colors
                                                                      .blue,
                                                                  borderRadius: BorderRadius.only(
                                                                      topLeft:
                                                                          Radius.circular(
                                                                              10),
                                                                      topRight:
                                                                          Radius.circular(
                                                                              10),
                                                                      bottomLeft:
                                                                          Radius.circular(
                                                                              10),
                                                                      bottomRight:
                                                                          Radius.circular(
                                                                              10)),
                                                                ),
                                                                padding:
                                                                    const EdgeInsets
                                                                            .all(
                                                                        8.0),
                                                                child:
                                                                    const Center(
                                                                  child: Text(
                                                                    'Export file',
                                                                    style:
                                                                        TextStyle(
                                                                      color: Colors
                                                                          .white,
                                                                      fontWeight:
                                                                          FontWeight
                                                                              .bold,
                                                                      fontFamily:
                                                                          Font_
                                                                              .Fonts_T,
                                                                    ),
                                                                  ),
                                                                ),
                                                              ),
                                                              onTap: () async {
                                                                setState(() {
                                                                  Value_Report =
                                                                      'รายงานการเคลื่อนไหวธนาคาร';
                                                                  Pre_and_Dow =
                                                                      'Download';
                                                                });
                                                                // Navigator.pop(context);
                                                                _showMyDialog_SAVE();
                                                              },
                                                            ),
                                                          ),
                                                        // if (_TransReBillModels_Bankmovemen
                                                        //         .length !=
                                                        //     0)
                                                        //   Padding(
                                                        //     padding:
                                                        //         const EdgeInsets.all(8.0),
                                                        //     child: InkWell(
                                                        //       child: Container(
                                                        //         width: 100,
                                                        //         decoration:
                                                        //             const BoxDecoration(
                                                        //           color: Colors.green,
                                                        //           borderRadius:
                                                        //               BorderRadius.only(
                                                        //                   topLeft: Radius
                                                        //                       .circular(
                                                        //                           10),
                                                        //                   topRight: Radius
                                                        //                       .circular(
                                                        //                           10),
                                                        //                   bottomLeft: Radius
                                                        //                       .circular(
                                                        //                           10),
                                                        //                   bottomRight: Radius
                                                        //                       .circular(
                                                        //                           10)),
                                                        //         ),
                                                        //         padding:
                                                        //             const EdgeInsets.all(
                                                        //                 8.0),
                                                        //         child: const Center(
                                                        //           child: Text(
                                                        //             'Print',
                                                        //             style: TextStyle(
                                                        //               color: Colors.white,
                                                        //               fontWeight:
                                                        //                   FontWeight.bold,
                                                        //               fontFamily:
                                                        //                   Font_.Fonts_T,
                                                        //             ),
                                                        //           ),
                                                        //         ),
                                                        //       ),
                                                        //       onTap: () async {
                                                        //         setState(() {
                                                        //           Value_Report =
                                                        //               'รายงานการเคลื่อนไหวธนาคาร';
                                                        //           Pre_and_Dow = 'Preview';
                                                        //         });
                                                        //         Navigator.pop(context);

                                                        //         _displayPdf_();
                                                        //       },
                                                        //     ),
                                                        //   ),
                                                        Padding(
                                                          padding:
                                                              const EdgeInsets
                                                                  .all(8.0),
                                                          child: InkWell(
                                                            child: Container(
                                                              width: 100,
                                                              decoration:
                                                                  const BoxDecoration(
                                                                color: Colors
                                                                    .black,
                                                                borderRadius: BorderRadius.only(
                                                                    topLeft: Radius
                                                                        .circular(
                                                                            10),
                                                                    topRight: Radius
                                                                        .circular(
                                                                            10),
                                                                    bottomLeft:
                                                                        Radius.circular(
                                                                            10),
                                                                    bottomRight:
                                                                        Radius.circular(
                                                                            10)),
                                                              ),
                                                              padding:
                                                                  const EdgeInsets
                                                                      .all(8.0),
                                                              child:
                                                                  const Center(
                                                                child: Text(
                                                                  'ปิด',
                                                                  style:
                                                                      TextStyle(
                                                                    color: Colors
                                                                        .white,
                                                                    fontWeight:
                                                                        FontWeight
                                                                            .bold,
                                                                    fontFamily:
                                                                        Font_
                                                                            .Fonts_T,
                                                                  ),
                                                                ),
                                                              ),
                                                            ),
                                                            onTap: () {
                                                              Navigator.of(
                                                                      context)
                                                                  .pop();
                                                            },
                                                          ),
                                                        ),
                                                      ],
                                                    ),
                                                  ),
                                                ),
                                              ],
                                            );
                                          },
                                        );
                                      },
                          ),
                          // const Padding(
                          //   padding: EdgeInsets.all(8.0),
                          //   child: Text(
                          //     'รายงานการเคลื่อนไหวธนาคาร',
                          //     style: TextStyle(
                          //       color: ReportScreen_Color.Colors_Text2_,
                          //       // fontWeight: FontWeight.bold,
                          //       fontFamily: Font_.Fonts_T,
                          //     ),
                          //   ),
                          // ),
                          (_TransReBillModels_Bankmovemen.isEmpty)
                              ? Padding(
                                  padding: const EdgeInsets.all(8.0),
                                  child: Text(
                                    (Value_selectDate2 != null &&
                                            _TransReBillModels_Bankmovemen
                                                .isEmpty)
                                        ? 'รายงานการเคลื่อนไหวธนาคาร (ไม่พบข้อมูล ✖️)'
                                        : 'รายงานการเคลื่อนไหวธนาคาร',
                                    //  'รายงานการเคลื่อนไหวธนาคาร',
                                    style: const TextStyle(
                                      color: ReportScreen_Color.Colors_Text2_,
                                      // fontWeight: FontWeight.bold,
                                      fontFamily: Font_.Fonts_T,
                                    ),
                                  ),
                                )
                              : (TransReBillModels_Bankmovemen[
                                          _TransReBillModels_Bankmovemen
                                                  .length -
                                              1]
                                      .isEmpty)
                                  ? SizedBox(
                                      // height: 20,
                                      child: Row(
                                      children: [
                                        Container(
                                            padding: const EdgeInsets.all(4.0),
                                            child:
                                                const CircularProgressIndicator()),
                                        const Padding(
                                          padding: EdgeInsets.all(8.0),
                                          child: Text(
                                            'กำลังโหลดรายงานการเคลื่อนไหวธนาคาร...',
                                            style: TextStyle(
                                              color: ReportScreen_Color
                                                  .Colors_Text2_,
                                              // fontWeight: FontWeight.bold,
                                              fontFamily: Font_.Fonts_T,
                                            ),
                                          ),
                                        ),
                                      ],
                                    ))
                                  : const Padding(
                                      padding: EdgeInsets.all(8.0),
                                      child: Text(
                                        'รายงานการเคลื่อนไหวธนาคาร ✔️',
                                        style: TextStyle(
                                          color:
                                              ReportScreen_Color.Colors_Text2_,
                                          // fontWeight: FontWeight.bold,
                                          fontFamily: Font_.Fonts_T,
                                        ),
                                      ),
                                    ),
                        ],
                      ),
                    ),
                    // Padding(
                    //   padding: const EdgeInsets.all(8.0),
                    //   child: Row(
                    //     children: [
                    //       InkWell(
                    //         child: Container(
                    //           decoration: BoxDecoration(
                    //             color: Colors.yellow[600],
                    //             borderRadius: const BorderRadius.only(
                    //                 topLeft: Radius.circular(10),
                    //                 topRight: Radius.circular(10),
                    //                 bottomLeft: Radius.circular(10),
                    //                 bottomRight: Radius.circular(10)),
                    //             border:
                    //                 Border.all(color: Colors.grey, width: 1),
                    //           ),
                    //           padding: const EdgeInsets.all(8.0),
                    //           child: Center(
                    //             child: Row(
                    //               mainAxisAlignment: MainAxisAlignment.center,
                    //               children: const [
                    //                 Text(
                    //                   'เรียกดู',
                    //                   style: TextStyle(
                    //                     color: ReportScreen_Color.Colors_Text1_,
                    //                     fontWeight: FontWeight.bold,
                    //                     fontFamily: FontWeight_.Fonts_T,
                    //                   ),
                    //                 ),
                    //                 Icon(
                    //                   Icons.navigate_next,
                    //                   color: Colors.grey,
                    //                 )
                    //               ],
                    //             ),
                    //           ),
                    //         ),
                    //         onTap: () {
                    //           Insert_log.Insert_logs(
                    //               'รายงาน', 'กดดูรายงานภาษี');
                    //           showDialog<void>(
                    //             context: context,
                    //             barrierDismissible:
                    //                 false, // user must tap button!
                    //             builder: (BuildContext context) {
                    //               return AlertDialog(
                    //                 shape: const RoundedRectangleBorder(
                    //                     borderRadius: BorderRadius.all(
                    //                         Radius.circular(20.0))),
                    //                 title: Column(
                    //                   children: [
                    //                     const Center(
                    //                         child: Text(
                    //                       'รายงานภาษี',
                    //                       style: TextStyle(
                    //                         color: ReportScreen_Color
                    //                             .Colors_Text1_,
                    //                         fontWeight: FontWeight.bold,
                    //                         fontFamily: FontWeight_.Fonts_T,
                    //                       ),
                    //                     )),
                    //                     Row(
                    //                       children: [
                    //                         Expanded(
                    //                             flex: 1,
                    //                             child: Text(
                    //                               'วันที่: $Value_selectDate1 ถึง  $Value_selectDate2',
                    //                               textAlign: TextAlign.start,
                    //                               style: const TextStyle(
                    //                                 color: ReportScreen_Color
                    //                                     .Colors_Text1_,
                    //                                 fontSize: 14,
                    //                                 // fontWeight: FontWeight.bold,
                    //                                 fontFamily:
                    //                                     FontWeight_.Fonts_T,
                    //                               ),
                    //                             )),
                    //                         const Expanded(
                    //                             flex: 1,
                    //                             child: Text(
                    //                               'ทั้งหมด: ',
                    //                               textAlign: TextAlign.end,
                    //                               style: TextStyle(
                    //                                 fontSize: 14,
                    //                                 color: ReportScreen_Color
                    //                                     .Colors_Text1_,
                    //                                 // fontWeight: FontWeight.bold,
                    //                                 fontFamily:
                    //                                     FontWeight_.Fonts_T,
                    //                               ),
                    //                             )),
                    //                       ],
                    //                     ),
                    //                     const SizedBox(height: 1),
                    //                     const Divider(),
                    //                     const SizedBox(height: 1),
                    //                   ],
                    //                 ),
                    //                 content: ScrollConfiguration(
                    //                   behavior: ScrollConfiguration.of(context)
                    //                       .copyWith(dragDevices: {
                    //                     PointerDeviceKind.touch,
                    //                     PointerDeviceKind.mouse,
                    //                   }),
                    //                   child: SingleChildScrollView(
                    //                     scrollDirection: Axis.horizontal,
                    //                     child: Row(
                    //                       children: [
                    //                         Container(
                    //                           color: Colors.grey[50],
                    //                           width: (Responsive.isDesktop(
                    //                                   context))
                    //                               ? MediaQuery.of(context)
                    //                                       .size
                    //                                       .width *
                    //                                   0.9
                    //                               : 800,
                    //                           // height:
                    //                           //     MediaQuery.of(context).size.height *
                    //                           //         0.3,
                    //                           child: Column(
                    //                             children: <Widget>[
                    //                               Container(
                    //                                 decoration:
                    //                                     const BoxDecoration(
                    //                                   color: AppbackgroundColor
                    //                                       .TiTile_Colors,
                    //                                   borderRadius:
                    //                                       BorderRadius.only(
                    //                                           topLeft: Radius
                    //                                               .circular(5),
                    //                                           topRight: Radius
                    //                                               .circular(5),
                    //                                           bottomLeft: Radius
                    //                                               .circular(0),
                    //                                           bottomRight:
                    //                                               Radius
                    //                                                   .circular(
                    //                                                       0)),
                    //                                 ),
                    //                                 padding:
                    //                                     const EdgeInsets.all(
                    //                                         4.0),
                    //                                 child: Row(
                    //                                   children: const [
                    //                                     Expanded(
                    //                                       flex: 1,
                    //                                       child: Center(
                    //                                           child: Text(
                    //                                         'ลำดับ',
                    //                                         style: TextStyle(
                    //                                           color: ReportScreen_Color
                    //                                               .Colors_Text1_,
                    //                                           fontWeight:
                    //                                               FontWeight
                    //                                                   .bold,
                    //                                           fontFamily:
                    //                                               FontWeight_
                    //                                                   .Fonts_T,
                    //                                         ),
                    //                                       )),
                    //                                     ),
                    //                                     Expanded(
                    //                                       flex: 3,
                    //                                       child: Center(
                    //                                           child: Text(
                    //                                         'รายการ',
                    //                                         style: TextStyle(
                    //                                           color: ReportScreen_Color
                    //                                               .Colors_Text1_,
                    //                                           fontWeight:
                    //                                               FontWeight
                    //                                                   .bold,
                    //                                           fontFamily:
                    //                                               FontWeight_
                    //                                                   .Fonts_T,
                    //                                         ),
                    //                                       )),
                    //                                     ),
                    //                                     Expanded(
                    //                                       flex: 1,
                    //                                       child: Center(
                    //                                           child: Text(
                    //                                         'วันที่',
                    //                                         style: TextStyle(
                    //                                           color: ReportScreen_Color
                    //                                               .Colors_Text1_,
                    //                                           fontWeight:
                    //                                               FontWeight
                    //                                                   .bold,
                    //                                           fontFamily:
                    //                                               FontWeight_
                    //                                                   .Fonts_T,
                    //                                         ),
                    //                                       )),
                    //                                     ),
                    //                                     Expanded(
                    //                                       flex: 1,
                    //                                       child: Center(
                    //                                           child: Text(
                    //                                         'XXXX',
                    //                                         style: TextStyle(
                    //                                           color: ReportScreen_Color
                    //                                               .Colors_Text1_,
                    //                                           fontWeight:
                    //                                               FontWeight
                    //                                                   .bold,
                    //                                           fontFamily:
                    //                                               FontWeight_
                    //                                                   .Fonts_T,
                    //                                         ),
                    //                                       )),
                    //                                     ),
                    //                                     Expanded(
                    //                                       flex: 1,
                    //                                       child: Center(
                    //                                           child: Text(
                    //                                         'XXX',
                    //                                         style: TextStyle(
                    //                                           color: ReportScreen_Color
                    //                                               .Colors_Text1_,
                    //                                           fontWeight:
                    //                                               FontWeight
                    //                                                   .bold,
                    //                                           fontFamily:
                    //                                               FontWeight_
                    //                                                   .Fonts_T,
                    //                                         ),
                    //                                       )),
                    //                                     ),
                    //                                   ],
                    //                                 ),
                    //                               ),
                    //                               Container(
                    //                                 width: (Responsive
                    //                                         .isDesktop(context))
                    //                                     ? MediaQuery.of(context)
                    //                                             .size
                    //                                             .width *
                    //                                         0.9
                    //                                     : 800,
                    //                                 height:
                    //                                     MediaQuery.of(context)
                    //                                             .size
                    //                                             .height *
                    //                                         0.3,
                    //                                 child: ListView.builder(
                    //                                   itemCount: 5,
                    //                                   itemBuilder:
                    //                                       (BuildContext context,
                    //                                           int index) {
                    //                                     return ListTile(
                    //                                       title: Row(
                    //                                         children: [
                    //                                           Expanded(
                    //                                             flex: 1,
                    //                                             child: Center(
                    //                                                 child: Text(
                    //                                               '${index + 1}',
                    //                                               style:
                    //                                                   const TextStyle(
                    //                                                 color: ReportScreen_Color
                    //                                                     .Colors_Text1_,
                    //                                                 fontWeight:
                    //                                                     FontWeight
                    //                                                         .bold,
                    //                                                 fontFamily:
                    //                                                     FontWeight_
                    //                                                         .Fonts_T,
                    //                                               ),
                    //                                             )),
                    //                                           ),
                    //                                           const Expanded(
                    //                                             flex: 2,
                    //                                             child: Center(
                    //                                                 child: Text(
                    //                                               'XXX',
                    //                                               style:
                    //                                                   TextStyle(
                    //                                                 color: ReportScreen_Color
                    //                                                     .Colors_Text1_,
                    //                                                 fontWeight:
                    //                                                     FontWeight
                    //                                                         .bold,
                    //                                                 fontFamily:
                    //                                                     FontWeight_
                    //                                                         .Fonts_T,
                    //                                               ),
                    //                                             )),
                    //                                           ),
                    //                                           const Expanded(
                    //                                             flex: 1,
                    //                                             child: Center(
                    //                                                 child: Text(
                    //                                               'XXX',
                    //                                               style:
                    //                                                   TextStyle(
                    //                                                 color: ReportScreen_Color
                    //                                                     .Colors_Text1_,
                    //                                                 fontWeight:
                    //                                                     FontWeight
                    //                                                         .bold,
                    //                                                 fontFamily:
                    //                                                     FontWeight_
                    //                                                         .Fonts_T,
                    //                                               ),
                    //                                             )),
                    //                                           ),
                    //                                           const Expanded(
                    //                                             flex: 1,
                    //                                             child: Center(
                    //                                                 child: Text(
                    //                                               'XXX',
                    //                                               style:
                    //                                                   TextStyle(
                    //                                                 color: ReportScreen_Color
                    //                                                     .Colors_Text1_,
                    //                                                 fontWeight:
                    //                                                     FontWeight
                    //                                                         .bold,
                    //                                                 fontFamily:
                    //                                                     FontWeight_
                    //                                                         .Fonts_T,
                    //                                               ),
                    //                                             )),
                    //                                           ),
                    //                                           const Expanded(
                    //                                             flex: 1,
                    //                                             child: Center(
                    //                                                 child: Text(
                    //                                               'XXXX',
                    //                                               style:
                    //                                                   TextStyle(
                    //                                                 color: ReportScreen_Color
                    //                                                     .Colors_Text1_,
                    //                                                 fontWeight:
                    //                                                     FontWeight
                    //                                                         .bold,
                    //                                                 fontFamily:
                    //                                                     FontWeight_
                    //                                                         .Fonts_T,
                    //                                               ),
                    //                                             )),
                    //                                           ),
                    //                                         ],
                    //                                       ),
                    //                                     );
                    //                                   },
                    //                                 ),
                    //                               ),
                    //                             ],
                    //                           ),
                    //                         ),
                    //                       ],
                    //                     ),
                    //                   ),
                    //                 ),
                    //                 actions: <Widget>[
                    //                   Padding(
                    //                     padding: const EdgeInsets.fromLTRB(
                    //                         8, 0, 20, 4),
                    //                     child: Row(
                    //                       mainAxisAlignment:
                    //                           MainAxisAlignment.end,
                    //                       children: [
                    //                         SizedBox(
                    //                           height: 120,
                    //                           width: 240,
                    //                           child: Column(
                    //                             children: [
                    //                               Row(
                    //                                 children: [
                    //                                   Expanded(
                    //                                       child: Container(
                    //                                     decoration:
                    //                                         const BoxDecoration(
                    //                                       color:
                    //                                           AppbackgroundColor
                    //                                               .TiTile_Colors,
                    //                                       borderRadius: BorderRadius.only(
                    //                                           topLeft: Radius
                    //                                               .circular(5),
                    //                                           topRight: Radius
                    //                                               .circular(5),
                    //                                           bottomLeft: Radius
                    //                                               .circular(0),
                    //                                           bottomRight:
                    //                                               Radius
                    //                                                   .circular(
                    //                                                       0)),
                    //                                     ),
                    //                                     child: const Center(
                    //                                       child: Text(
                    //                                         'รวม',
                    //                                         maxLines: 1,
                    //                                         textAlign:
                    //                                             TextAlign.start,
                    //                                         style: TextStyle(
                    //                                           color: ReportScreen_Color
                    //                                               .Colors_Text1_,
                    //                                           fontWeight:
                    //                                               FontWeight
                    //                                                   .bold,
                    //                                           fontFamily:
                    //                                               FontWeight_
                    //                                                   .Fonts_T,
                    //                                         ),
                    //                                       ),
                    //                                     ),
                    //                                   ))
                    //                                 ],
                    //                               ),
                    //                               Row(
                    //                                 children: [
                    //                                   Expanded(
                    //                                     flex: 1,
                    //                                     child: Container(
                    //                                         decoration:
                    //                                             BoxDecoration(
                    //                                           color: Colors
                    //                                               .grey[300],
                    //                                           borderRadius: const BorderRadius
                    //                                                   .only(
                    //                                               topLeft: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               topRight: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               bottomLeft: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               bottomRight: Radius
                    //                                                   .circular(
                    //                                                       0)),
                    //                                         ),
                    //                                         child: const Text(
                    //                                           'รวม 70%',
                    //                                           maxLines: 1,
                    //                                           textAlign:
                    //                                               TextAlign
                    //                                                   .start,
                    //                                           style: TextStyle(
                    //                                             color: ReportScreen_Color
                    //                                                 .Colors_Text1_,
                    //                                             fontWeight:
                    //                                                 FontWeight
                    //                                                     .bold,
                    //                                             fontFamily:
                    //                                                 FontWeight_
                    //                                                     .Fonts_T,
                    //                                           ),
                    //                                         )),
                    //                                   ),
                    //                                   Expanded(
                    //                                     flex: 1,
                    //                                     child: Container(
                    //                                         color: Colors
                    //                                             .grey[200],
                    //                                         child: const Text(
                    //                                           'xxxxx',
                    //                                           maxLines: 1,
                    //                                           textAlign:
                    //                                               TextAlign.end,
                    //                                           style: TextStyle(
                    //                                             color: ReportScreen_Color
                    //                                                 .Colors_Text2_,
                    //                                             fontWeight:
                    //                                                 FontWeight
                    //                                                     .bold,
                    //                                             fontFamily: Font_
                    //                                                 .Fonts_T,
                    //                                           ),
                    //                                         )),
                    //                                   ),
                    //                                 ],
                    //                               ),
                    //                               Row(
                    //                                 children: [
                    //                                   Expanded(
                    //                                     flex: 1,
                    //                                     child: Container(
                    //                                         decoration:
                    //                                             BoxDecoration(
                    //                                           color: Colors
                    //                                               .grey[300],
                    //                                           borderRadius: const BorderRadius
                    //                                                   .only(
                    //                                               topLeft: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               topRight: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               bottomLeft: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               bottomRight: Radius
                    //                                                   .circular(
                    //                                                       0)),
                    //                                         ),
                    //                                         child: const Text(
                    //                                           'รวม 30%',
                    //                                           maxLines: 1,
                    //                                           textAlign:
                    //                                               TextAlign
                    //                                                   .start,
                    //                                           style: TextStyle(
                    //                                             color: ReportScreen_Color
                    //                                                 .Colors_Text1_,
                    //                                             fontWeight:
                    //                                                 FontWeight
                    //                                                     .bold,
                    //                                             fontFamily:
                    //                                                 FontWeight_
                    //                                                     .Fonts_T,
                    //                                           ),
                    //                                         )),
                    //                                   ),
                    //                                   Expanded(
                    //                                     flex: 1,
                    //                                     child: Container(
                    //                                         color: Colors
                    //                                             .grey[200],
                    //                                         child: const Text(
                    //                                           'xxxxx',
                    //                                           maxLines: 1,
                    //                                           textAlign:
                    //                                               TextAlign.end,
                    //                                           style: TextStyle(
                    //                                             color: ReportScreen_Color
                    //                                                 .Colors_Text2_,
                    //                                             fontWeight:
                    //                                                 FontWeight
                    //                                                     .bold,
                    //                                             fontFamily: Font_
                    //                                                 .Fonts_T,
                    //                                           ),
                    //                                         )),
                    //                                   ),
                    //                                 ],
                    //                               ),
                    //                               // Row(
                    //                               //   children: [
                    //                               //     Expanded(
                    //                               //       flex: 1,
                    //                               //       child: Container(
                    //                               //           decoration:
                    //                               //               BoxDecoration(
                    //                               //             color: Colors
                    //                               //                 .grey[300],
                    //                               //             borderRadius: const BorderRadius
                    //                               //                     .only(
                    //                               //                 topLeft: Radius
                    //                               //                     .circular(
                    //                               //                         0),
                    //                               //                 topRight: Radius
                    //                               //                     .circular(
                    //                               //                         0),
                    //                               //                 bottomLeft: Radius
                    //                               //                     .circular(
                    //                               //                         0),
                    //                               //                 bottomRight: Radius
                    //                               //                     .circular(
                    //                               //                         0)),
                    //                               //           ),
                    //                               //           child: const Text(
                    //                               //             'รวมราคาก่อน Vat',
                    //                               //             maxLines: 1,
                    //                               //             textAlign:
                    //                               //                 TextAlign
                    //                               //                     .start,
                    //                               //             style: TextStyle(
                    //                               //               color: ReportScreen_Color
                    //                               //                   .Colors_Text1_,
                    //                               //               fontWeight:
                    //                               //                   FontWeight
                    //                               //                       .bold,
                    //                               //               fontFamily:
                    //                               //                   FontWeight_
                    //                               //                       .Fonts_T,
                    //                               //             ),
                    //                               //           )),
                    //                               //     ),
                    //                               //     Expanded(
                    //                               //       flex: 1,
                    //                               //       child: Container(
                    //                               //           color: Colors
                    //                               //               .grey[200],
                    //                               //           child: const Text(
                    //                               //             'xxxxxx',
                    //                               //             maxLines: 1,
                    //                               //             textAlign:
                    //                               //                 TextAlign.end,
                    //                               //             style: TextStyle(
                    //                               //               color: ReportScreen_Color
                    //                               //                   .Colors_Text2_,
                    //                               //               fontWeight:
                    //                               //                   FontWeight
                    //                               //                       .bold,
                    //                               //               fontFamily: Font_
                    //                               //                   .Fonts_T,
                    //                               //             ),
                    //                               //           )),
                    //                               //     ),
                    //                               //   ],
                    //                               // ),
                    //                               Row(
                    //                                 children: [
                    //                                   Expanded(
                    //                                     flex: 1,
                    //                                     child: Container(
                    //                                         decoration:
                    //                                             BoxDecoration(
                    //                                           color: Colors
                    //                                               .grey[300],
                    //                                           borderRadius: const BorderRadius
                    //                                                   .only(
                    //                                               topLeft: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               topRight: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               bottomLeft: Radius
                    //                                                   .circular(
                    //                                                       0),
                    //                                               bottomRight: Radius
                    //                                                   .circular(
                    //                                                       0)),
                    //                                         ),
                    //                                         child: const Text(
                    //                                           'รวม',
                    //                                           maxLines: 1,
                    //                                           textAlign:
                    //                                               TextAlign
                    //                                                   .start,
                    //                                           style: TextStyle(
                    //                                             color: ReportScreen_Color
                    //                                                 .Colors_Text1_,
                    //                                             fontWeight:
                    //                                                 FontWeight
                    //                                                     .bold,
                    //                                             fontFamily:
                    //                                                 FontWeight_
                    //                                                     .Fonts_T,
                    //                                           ),
                    //                                         )),
                    //                                   ),
                    //                                   Expanded(
                    //                                     flex: 1,
                    //                                     child: Container(
                    //                                         color: Colors
                    //                                             .grey[200],
                    //                                         child: const Text(
                    //                                           'xxxxxxx',
                    //                                           maxLines: 1,
                    //                                           textAlign:
                    //                                               TextAlign.end,
                    //                                           style: TextStyle(
                    //                                             color: ReportScreen_Color
                    //                                                 .Colors_Text2_,
                    //                                             fontWeight:
                    //                                                 FontWeight
                    //                                                     .bold,
                    //                                             fontFamily: Font_
                    //                                                 .Fonts_T,
                    //                                           ),
                    //                                         )),
                    //                                   ),
                    //                                 ],
                    //                               ),
                    //                             ],
                    //                           ),
                    //                         )
                    //                       ],
                    //                     ),
                    //                   ),
                    //                   const SizedBox(height: 1),
                    //                   const Divider(),
                    //                   const SizedBox(height: 1),
                    //                   Padding(
                    //                     padding: const EdgeInsets.fromLTRB(
                    //                         8, 4, 8, 4),
                    //                     child: SingleChildScrollView(
                    //                       scrollDirection: Axis.horizontal,
                    //                       child: Row(
                    //                         mainAxisAlignment:
                    //                             MainAxisAlignment.end,
                    //                         children: [
                    //                           Padding(
                    //                             padding:
                    //                                 const EdgeInsets.all(8.0),
                    //                             child: InkWell(
                    //                               child: Container(
                    //                                 width: 100,
                    //                                 decoration:
                    //                                     const BoxDecoration(
                    //                                   color: Colors.blue,
                    //                                   borderRadius:
                    //                                       BorderRadius.only(
                    //                                           topLeft: Radius
                    //                                               .circular(10),
                    //                                           topRight: Radius
                    //                                               .circular(10),
                    //                                           bottomLeft: Radius
                    //                                               .circular(10),
                    //                                           bottomRight:
                    //                                               Radius
                    //                                                   .circular(
                    //                                                       10)),
                    //                                 ),
                    //                                 padding:
                    //                                     const EdgeInsets.all(
                    //                                         8.0),
                    //                                 child: const Center(
                    //                                   child: Text(
                    //                                     'Export file',
                    //                                     style: TextStyle(
                    //                                       color: Colors.white,
                    //                                       fontWeight:
                    //                                           FontWeight.bold,
                    //                                       fontFamily:
                    //                                           Font_.Fonts_T,
                    //                                     ),
                    //                                   ),
                    //                                 ),
                    //                               ),
                    //                               onTap: () async {
                    //                                 setState(() {
                    //                                   Value_Report =
                    //                                       'รายงานภาษี';
                    //                                   Pre_and_Dow = 'Download';
                    //                                 });
                    //                                 Navigator.pop(context);
                    //                                 _showMyDialog_SAVE();
                    //                               },
                    //                             ),
                    //                           ),
                    //                           Padding(
                    //                             padding:
                    //                                 const EdgeInsets.all(8.0),
                    //                             child: InkWell(
                    //                               child: Container(
                    //                                 width: 100,
                    //                                 decoration:
                    //                                     const BoxDecoration(
                    //                                   color: Colors.green,
                    //                                   borderRadius:
                    //                                       BorderRadius.only(
                    //                                           topLeft: Radius
                    //                                               .circular(10),
                    //                                           topRight: Radius
                    //                                               .circular(10),
                    //                                           bottomLeft: Radius
                    //                                               .circular(10),
                    //                                           bottomRight:
                    //                                               Radius
                    //                                                   .circular(
                    //                                                       10)),
                    //                                 ),
                    //                                 padding:
                    //                                     const EdgeInsets.all(
                    //                                         8.0),
                    //                                 child: const Center(
                    //                                   child: Text(
                    //                                     'Print',
                    //                                     style: TextStyle(
                    //                                       color: Colors.white,
                    //                                       fontWeight:
                    //                                           FontWeight.bold,
                    //                                       fontFamily:
                    //                                           Font_.Fonts_T,
                    //                                     ),
                    //                                   ),
                    //                                 ),
                    //                               ),
                    //                               onTap: () async {
                    //                                 setState(() {
                    //                                   Value_Report =
                    //                                       'รายงานภาษี';
                    //                                   Pre_and_Dow = 'Preview';
                    //                                 });
                    //                                 Navigator.pop(context);
                    //                                 _displayPdf_();
                    //                               },
                    //                             ),
                    //                           ),
                    //                           Padding(
                    //                             padding:
                    //                                 const EdgeInsets.all(8.0),
                    //                             child: InkWell(
                    //                               child: Container(
                    //                                 width: 100,
                    //                                 decoration:
                    //                                     const BoxDecoration(
                    //                                   color: Colors.black,
                    //                                   borderRadius:
                    //                                       BorderRadius.only(
                    //                                           topLeft: Radius
                    //                                               .circular(10),
                    //                                           topRight: Radius
                    //                                               .circular(10),
                    //                                           bottomLeft: Radius
                    //                                               .circular(10),
                    //                                           bottomRight:
                    //                                               Radius
                    //                                                   .circular(
                    //                                                       10)),
                    //                                 ),
                    //                                 padding:
                    //                                     const EdgeInsets.all(
                    //                                         8.0),
                    //                                 child: const Center(
                    //                                   child: Text(
                    //                                     'ปิด',
                    //                                     style: TextStyle(
                    //                                       color: Colors.white,
                    //                                       fontWeight:
                    //                                           FontWeight.bold,
                    //                                       fontFamily:
                    //                                           Font_.Fonts_T,
                    //                                     ),
                    //                                   ),
                    //                                 ),
                    //                               ),
                    //                               onTap: () {
                    //                                 Navigator.of(context).pop();
                    //                               },
                    //                             ),
                    //                           ),
                    //                         ],
                    //                       ),
                    //                     ),
                    //                   ),
                    //                 ],
                    //               );
                    //             },
                    //           );
                    //         },
                    //       ),
                    //       const Padding(
                    //         padding: EdgeInsets.all(8.0),
                    //         child: Text(
                    //           'รายงานภาษี',
                    //           style: TextStyle(
                    //             color: ReportScreen_Color.Colors_Text2_,
                    //             // fontWeight: FontWeight.bold,
                    //             fontFamily: Font_.Fonts_T,
                    //           ),
                    //         ),
                    //       ),
                    //     ],
                    //   ),
                    // ),
///////--------------------------------------------------------------------------------->(รายงานประจำวัน)
                    const SizedBox(
                      height: 5.0,
                    ),
                    Row(
                      children: [
                        Container(
                          width: MediaQuery.of(context).size.width / 2,
                          height: 4.0,
                          child: Divider(
                            color: Colors.grey[300],
                            height: 4.0,
                          ),
                        ),
                      ],
                    ),
                    const SizedBox(
                      height: 5.0,
                    ),
                    Row(
                      children: [
                        const Padding(
                          padding: EdgeInsets.all(8.0),
                          child: Text(
                            'วันที่ :',
                            style: TextStyle(
                              color: ReportScreen_Color.Colors_Text2_,
                              // fontWeight: FontWeight.bold,
                              fontFamily: Font_.Fonts_T,
                            ),
                          ),
                        ),
                        Padding(
                          padding: const EdgeInsets.all(8.0),
                          child: InkWell(
                            onTap: () {
                              _select_Date(context);
                            },
                            child: Container(
                                decoration: BoxDecoration(
                                  color: AppbackgroundColor.Sub_Abg_Colors,
                                  borderRadius: const BorderRadius.only(
                                      topLeft: Radius.circular(10),
                                      topRight: Radius.circular(10),
                                      bottomLeft: Radius.circular(10),
                                      bottomRight: Radius.circular(10)),
                                  border:
                                      Border.all(color: Colors.grey, width: 1),
                                ),
                                width: 120,
                                padding: const EdgeInsets.all(8.0),
                                child: Center(
                                  child: Text(
                                    (Value_selectDate == null)
                                        ? 'เลือก'
                                        : '$Value_selectDate',
                                    style: const TextStyle(
                                      color: ReportScreen_Color.Colors_Text2_,
                                      // fontWeight: FontWeight.bold,
                                      fontFamily: Font_.Fonts_T,
                                    ),
                                  ),
                                )),
                          ),
                        ),
                      ],
                    ),
                    Padding(
                      padding: const EdgeInsets.all(8.0),
                      child: Row(
                        children: [
                          // if (Value_selectDate != null &&
                          //     _TransReBillModels.length != 0)
                          InkWell(
                            child: Container(
                              decoration: BoxDecoration(
                                color: Colors.yellow[600],
                                borderRadius: const BorderRadius.only(
                                    topLeft: Radius.circular(10),
                                    topRight: Radius.circular(10),
                                    bottomLeft: Radius.circular(10),
                                    bottomRight: Radius.circular(10)),
                                border:
                                    Border.all(color: Colors.grey, width: 1),
                              ),
                              padding: const EdgeInsets.all(8.0),
                              child: Center(
                                child: Row(
                                  mainAxisAlignment: MainAxisAlignment.center,
                                  children: const [
                                    Text(
                                      'เรียกดู',
                                      style: TextStyle(
                                        color: ReportScreen_Color.Colors_Text1_,
                                        fontWeight: FontWeight.bold,
                                        fontFamily: FontWeight_.Fonts_T,
                                      ),
                                    ),
                                    Icon(
                                      Icons.navigate_next,
                                      color: Colors.grey,
                                    )
                                  ],
                                ),
                              ),
                            ),
                            onTap: (_TransReBillModels.isEmpty)
                                ? null
                                : (TransReBillModels[
                                            _TransReBillModels.length - 1]
                                        .isEmpty)
                                    ? null
                                    : () async {
                                        // List show_more = [];
                                        int? show_more;

                                        double Sum_Ramt_ = 0.0;
                                        double Sum_Ramtd_ = 0.0;
                                        double Sum_Amt_ = 0.0;
                                        double Sum_Total_ = 0.0;

                                        for (int indexsum1 = 0;
                                            indexsum1 <
                                                _TransReBillModels.length;
                                            indexsum1++) {
                                          Sum_Ramt_ = Sum_Ramt_ +
                                              double.parse(
                                                  _TransReBillModels[indexsum1]
                                                      .ramt!);

                                          Sum_Ramtd_ = Sum_Ramtd_ +
                                              double.parse(
                                                  _TransReBillModels[indexsum1]
                                                      .ramtd!);

                                          Sum_Amt_ = Sum_Amt_ +
                                              double.parse(
                                                  _TransReBillModels[indexsum1]
                                                      .amt!);

                                          Sum_Total_ = Sum_Total_ +
                                              double.parse(
                                                  _TransReBillModels[indexsum1]
                                                      .total_bill!);
                                          // for (int indexsum2 = 0;
                                          //     indexsum2 <
                                          //         TransReBillModels[indexsum1].length;
                                          //     indexsum2++) {
                                          //   Sum_Ramt_ = Sum_Ramt_ +
                                          //       double.parse(TransReBillModels[indexsum1]
                                          //               [indexsum2]
                                          //           .ramt!);
                                          //   Sum_Ramtd_ = Sum_Ramtd_ +
                                          //       double.parse(TransReBillModels[indexsum1]
                                          //               [indexsum2]
                                          //           .ramtd!);
                                          //   Sum_Amt_ = Sum_Amt_ +
                                          //       double.parse(TransReBillModels[indexsum1]
                                          //               [indexsum2]
                                          //           .amt!);
                                          //   Sum_Total_ = Sum_Total_ +
                                          //       double.parse(TransReBillModels[indexsum1]
                                          //               [indexsum2]
                                          //           .total!);
                                          // }
                                        }
                                        Insert_log.Insert_logs(
                                            'รายงาน', 'กดดูรายงานประจำวัน');

                                        showDialog<void>(
                                          context: context,
                                          barrierDismissible:
                                              false, // user must tap button!
                                          builder: (BuildContext context) {
                                            return AlertDialog(
                                              shape:
                                                  const RoundedRectangleBorder(
                                                      borderRadius:
                                                          BorderRadius.all(
                                                              Radius.circular(
                                                                  20.0))),
                                              title: Column(
                                                children: [
                                                  const Center(
                                                      child: Text(
                                                    'รายงานประจำวัน',
                                                    style: TextStyle(
                                                      color: ReportScreen_Color
                                                          .Colors_Text1_,
                                                      fontWeight:
                                                          FontWeight.bold,
                                                      fontFamily:
                                                          FontWeight_.Fonts_T,
                                                    ),
                                                  )),
                                                  Row(
                                                    children: [
                                                      Expanded(
                                                          flex: 1,
                                                          child: Text(
                                                            (Value_selectDate ==
                                                                    null)
                                                                ? 'วันที่: ?'
                                                                : 'วันที่: $Value_selectDate',
                                                            textAlign:
                                                                TextAlign.start,
                                                            style:
                                                                const TextStyle(
                                                              color: ReportScreen_Color
                                                                  .Colors_Text1_,
                                                              fontSize: 14,
                                                              // fontWeight: FontWeight.bold,
                                                              fontFamily:
                                                                  FontWeight_
                                                                      .Fonts_T,
                                                            ),
                                                          )),
                                                      Expanded(
                                                          flex: 1,
                                                          child: Text(
                                                            'ทั้งหมด: ${_TransReBillModels.length}',
                                                            textAlign:
                                                                TextAlign.end,
                                                            style:
                                                                const TextStyle(
                                                              fontSize: 14,
                                                              color: ReportScreen_Color
                                                                  .Colors_Text1_,
                                                              // fontWeight: FontWeight.bold,
                                                              fontFamily:
                                                                  FontWeight_
                                                                      .Fonts_T,
                                                            ),
                                                          )),
                                                    ],
                                                  ),
                                                  const SizedBox(height: 1),
                                                  const Divider(),
                                                  const SizedBox(height: 1),
                                                ],
                                              ),
                                              content: StreamBuilder(
                                                  stream: Stream.periodic(
                                                      const Duration(
                                                          seconds: 0)),
                                                  builder: (context, snapshot) {
                                                    return ScrollConfiguration(
                                                      behavior:
                                                          ScrollConfiguration
                                                                  .of(context)
                                                              .copyWith(
                                                                  dragDevices: {
                                                            PointerDeviceKind
                                                                .touch,
                                                            PointerDeviceKind
                                                                .mouse,
                                                          }),
                                                      child:
                                                          SingleChildScrollView(
                                                        scrollDirection:
                                                            Axis.horizontal,
                                                        child: Row(
                                                          children: [
                                                            Container(
                                                              // color: Colors.grey[50],
                                                              width: (Responsive
                                                                      .isDesktop(
                                                                          context))
                                                                  ? MediaQuery.of(
                                                                              context)
                                                                          .size
                                                                          .width *
                                                                      0.9
                                                                  : (_TransReBillModels
                                                                              .length ==
                                                                          0)
                                                                      ? MediaQuery.of(
                                                                              context)
                                                                          .size
                                                                          .width
                                                                      : 800,
                                                              // height:
                                                              //     MediaQuery.of(context)
                                                              //             .size
                                                              //             .height *
                                                              //         0.3,
                                                              child: (_TransReBillModels
                                                                          .length ==
                                                                      0)
                                                                  ? Column(
                                                                      mainAxisAlignment:
                                                                          MainAxisAlignment
                                                                              .center,
                                                                      children: const [
                                                                        Center(
                                                                          child:
                                                                              Text(
                                                                            'ไม่พบข้อมูล ณ วันที่เลือก',
                                                                            style:
                                                                                TextStyle(
                                                                              color: ReportScreen_Color.Colors_Text1_,
                                                                              fontWeight: FontWeight.bold,
                                                                              fontFamily: FontWeight_.Fonts_T,
                                                                            ),
                                                                          ),
                                                                        ),
                                                                      ],
                                                                    )
                                                                  : Column(
                                                                      children: <
                                                                          Widget>[
                                                                        // for (int index1 = 0;
                                                                        //     index1 <
                                                                        //         _TransReBillModels
                                                                        //             .length;
                                                                        //     index1++)
                                                                        Container(
                                                                            height: MediaQuery.of(context).size.height *
                                                                                0.45,
                                                                            child:
                                                                                ListView.builder(
                                                                              itemCount: _TransReBillModels.length,
                                                                              itemBuilder: (BuildContext context, int index1) {
                                                                                return ListTile(
                                                                                  title: SizedBox(
                                                                                    child: Column(
                                                                                      children: [
                                                                                        Container(
                                                                                          child: Row(
                                                                                            mainAxisAlignment: MainAxisAlignment.start,
                                                                                            children: [
                                                                                              Container(
                                                                                                decoration: const BoxDecoration(
                                                                                                  color: AppbackgroundColor.TiTile_Colors,
                                                                                                  borderRadius: BorderRadius.only(topLeft: Radius.circular(5), topRight: Radius.circular(5), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                ),
                                                                                                padding: const EdgeInsets.all(4.0),
                                                                                                child: Text(
                                                                                                  _TransReBillModels[index1].doctax == '' ? '${index1 + 1}. เลขที่: ${_TransReBillModels[index1].docno}' : '${index1 + 1}. เลขที่: ${_TransReBillModels[index1].doctax}',
                                                                                                  style: const TextStyle(
                                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                                    fontWeight: FontWeight.bold,
                                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                                  ),
                                                                                                ),
                                                                                              ),
                                                                                            ],
                                                                                          ),
                                                                                        ),
                                                                                        if (show_more != index1)
                                                                                          SizedBox(
                                                                                            child: Column(
                                                                                              children: [
                                                                                                Container(
                                                                                                  decoration: BoxDecoration(
                                                                                                    color: AppbackgroundColor.TiTile_Colors.withOpacity(0.7),
                                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                  ),
                                                                                                  // padding: const EdgeInsets.all(4.0),
                                                                                                  child: Row(
                                                                                                    children: const [
                                                                                                      SizedBox(
                                                                                                        width: 20,
                                                                                                      ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     'รหัสพื้นที่',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: FontWeight_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),

                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     'รายการทั้งหมด',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: FontWeight_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     'รูปแบบชำระ',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: FontWeight_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'โซน',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'รหัสพื้นที่',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     'วันที่',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: FontWeight_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'ผู้เช่า',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'ชื่อร้านค้า',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),

                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'ขนาดพื้นที่ (ตร.ม.)',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     'ธนาคาร',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: FontWeight_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),

                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     'รวม70%',
                                                                                                      //     textAlign: TextAlign.right,
                                                                                                      //     style: TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: FontWeight_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      //   Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     'รวม30%',
                                                                                                      //     textAlign: TextAlign.right,
                                                                                                      //     style: TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: FontWeight_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),

                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'ค่าเช่า',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'โม่',
                                                                                                          //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                          //  '${_TransReBillModels[index1].ramtd}',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'ถัง',
                                                                                                          //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                          //  '${_TransReBillModels[index1].ramtd}',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'เช่าพื้นที่',
                                                                                                          //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                          //  '${_TransReBillModels[index1].ramtd}',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'ค่าไฟ',
                                                                                                          //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                          //  '${_TransReBillModels[index1].ramtd}',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          'รวม',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          '...',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            fontWeight: FontWeight.bold,
                                                                                                            fontFamily: FontWeight_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                    ],
                                                                                                  ),
                                                                                                ),
                                                                                                Container(
                                                                                                  decoration: BoxDecoration(
                                                                                                    color: Colors.grey[200],
                                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                  ),
                                                                                                  // padding: const EdgeInsets.all(4.0),
                                                                                                  child: Row(
                                                                                                    children: [
                                                                                                      const SizedBox(
                                                                                                        width: 20,
                                                                                                      ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     (_TransReBillModels[index1].ln == null) ? '' : '${_TransReBillModels[index1].ln}',
                                                                                                      //     // '${TransReBillModels[index1].length}',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: const TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       // fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: Font_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     '${nFormat2.format(double.parse(TransReBillModels[index1].length.toString()))}',
                                                                                                      //     // '${TransReBillModels[index1].length}',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: const TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       // fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: Font_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     '${_TransReBillModels[index1].type}',
                                                                                                      //     // '${TransReBillModels[index1].length}',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: const TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       // fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: Font_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          (_TransReBillModels[index1].zn == null) ? '-' : '${_TransReBillModels[index1].zn}',
                                                                                                          // '${TransReBillModels[index1].length}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          (_TransReBillModels[index1].ln == null) ? '${_TransReBillModels[index1].room_number}' : '${_TransReBillModels[index1].ln}',
                                                                                                          // '${TransReBillModels[index1].length}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     '${_TransReBillModels[index1].daterec}',
                                                                                                      //     // '${TransReBillModels[index1].length}',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: const TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       // fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: Font_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          (_TransReBillModels[index1].cname == null) ? '${_TransReBillModels[index1].remark}' : '${_TransReBillModels[index1].cname}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            //fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          (_TransReBillModels[index1].sname == null) ? '-' : '${_TransReBillModels[index1].sname}',
                                                                                                          // '${TransReBillModels[index1].length}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),

                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          (_TransReBillModels[index1].area == null) ? '-' : '${_TransReBillModels[index1].area}',
                                                                                                          // '${TransReBillModels[index1].length}',
                                                                                                          textAlign: TextAlign.center,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      // Expanded(
                                                                                                      //   flex: 1,
                                                                                                      //   child: Text(
                                                                                                      //     '${_TransReBillModels[index1].bank}',
                                                                                                      //     // '${TransReBillModels[index1].length}',
                                                                                                      //     textAlign: TextAlign.center,
                                                                                                      //     style: const TextStyle(
                                                                                                      //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                      //       // fontWeight: FontWeight.bold,
                                                                                                      //       fontFamily: Font_.Fonts_T,
                                                                                                      //     ),
                                                                                                      //   ),
                                                                                                      // ),

                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          (rent_CM[index1].isEmpty) ? '0.00' : '${nFormat.format(double.parse(rent_CM[index1][0]!))}',
                                                                                                          //'${rent_CM[index1][0].toString()}',
                                                                                                          //'${nFormat.format(double.parse(_TransReBillModels[index1].ramt!))}',
                                                                                                          // '${_TransReBillModels[index1].ramt}',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          (MOMO_CM[index1].isEmpty) ? '0.00' : '${nFormat.format(double.parse(MOMO_CM[index1][0]!))}',
                                                                                                          //'${MOMO_CM[index1][0].toString()}',
                                                                                                          //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                          //  '${_TransReBillModels[index1].ramtd}',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          (tank_CM[index1].isEmpty) ? '0.00' : '${nFormat.format(double.parse(tank_CM[index1][0]!))}',
                                                                                                          // '${tank_CM[index1][0].toString()}',
                                                                                                          // '${tank_CM[index1]}',
                                                                                                          //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                          //  '${_TransReBillModels[index1].ramtd}',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          (rent_area_CM[index1].isEmpty) ? '0.00' : '${nFormat.format(double.parse(rent_area_CM[index1][0]!))}',
                                                                                                          //'${rent_area_CM[index1][0].toString()}',
                                                                                                          //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                          //  '${_TransReBillModels[index1].ramtd}',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          (electricity_CM[index1].isEmpty) ? '0.00' : '${nFormat.format(double.parse(electricity_CM[index1][0]!))}',
                                                                                                          //'${electricity_CM[index1][0].toString()}',
                                                                                                          //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                          //  '${_TransReBillModels[index1].ramtd}',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Text(
                                                                                                          '${nFormat.format(double.parse(_TransReBillModels[index1].total_bill!))}',
                                                                                                          // '${_TransReBillModels[index1].total_bill}',
                                                                                                          textAlign: TextAlign.right,
                                                                                                          style: const TextStyle(
                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                      Expanded(
                                                                                                        flex: 1,
                                                                                                        child: Padding(
                                                                                                          padding: const EdgeInsets.all(8.0),
                                                                                                          child: Row(
                                                                                                            mainAxisAlignment: MainAxisAlignment.center,
                                                                                                            children: [
                                                                                                              InkWell(
                                                                                                                onTap: () {
                                                                                                                  setState(() {
                                                                                                                    show_more = index1;
                                                                                                                  });
                                                                                                                },
                                                                                                                child: Container(
                                                                                                                  width: 100,
                                                                                                                  decoration: BoxDecoration(
                                                                                                                    color: Colors.green[300],
                                                                                                                    borderRadius: const BorderRadius.only(topLeft: Radius.circular(10), topRight: Radius.circular(10), bottomLeft: Radius.circular(10), bottomRight: Radius.circular(10)),
                                                                                                                  ),
                                                                                                                  padding: const EdgeInsets.all(4.0),
                                                                                                                  child: const Center(
                                                                                                                    child: Text(
                                                                                                                      'ดูเพิ่มเติม',
                                                                                                                      style: TextStyle(
                                                                                                                        color: ReportScreen_Color.Colors_Text1_,
                                                                                                                        // fontWeight: FontWeight.bold,
                                                                                                                        fontFamily: Font_.Fonts_T,
                                                                                                                      ),
                                                                                                                    ),
                                                                                                                  ),
                                                                                                                ),
                                                                                                              ),
                                                                                                            ],
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                    ],
                                                                                                  ),
                                                                                                ),
                                                                                              ],
                                                                                            ),
                                                                                          ),
                                                                                        if (show_more == index1)
                                                                                          SizedBox(
                                                                                            child: Column(
                                                                                              children: [
                                                                                                Stack(
                                                                                                  children: [
                                                                                                    Container(
                                                                                                      decoration: BoxDecoration(
                                                                                                        color: AppbackgroundColor.TiTile_Colors.withOpacity(0.7),
                                                                                                        borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                      ),
                                                                                                      padding: const EdgeInsets.all(4.0),
                                                                                                      child: Row(
                                                                                                        children: const [
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ลำดับ',
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          // Expanded(
                                                                                                          //   flex: 1,
                                                                                                          //   child: Text(
                                                                                                          //     'กำหนดชำระ',
                                                                                                          //     style: TextStyle(
                                                                                                          //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                          //       fontWeight: FontWeight.bold,
                                                                                                          //       fontFamily: FontWeight_.Fonts_T,
                                                                                                          //     ),
                                                                                                          //   ),
                                                                                                          // ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'รายการ',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'Vat%',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'หน่วย',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'VAT',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              '70 %',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              '30 %',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ราคาก่อน Vat',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ราคารวม Vat',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                        ],
                                                                                                      ),
                                                                                                    ),
                                                                                                    Positioned(
                                                                                                        top: 0,
                                                                                                        right: 2,
                                                                                                        child: InkWell(
                                                                                                          onTap: () {
                                                                                                            setState(() {
                                                                                                              show_more = null;
                                                                                                            });
                                                                                                          },
                                                                                                          child: const Icon(
                                                                                                            Icons.cancel,
                                                                                                            color: Colors.red,
                                                                                                          ),
                                                                                                        ))
                                                                                                  ],
                                                                                                ),
                                                                                                for (int index2 = 0; index2 < TransReBillModels[index1].length; index2++)
                                                                                                  Container(
                                                                                                    color: Colors.green[100]!.withOpacity(0.5), padding: const EdgeInsets.fromLTRB(5, 0, 5, 0),
                                                                                                    // padding: const EdgeInsets.all(4.0),
                                                                                                    child: Column(
                                                                                                      children: [
                                                                                                        Row(
                                                                                                          children: [
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${index1 + 1}.${index2 + 1}',
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            // Expanded(
                                                                                                            //   flex: 1,
                                                                                                            //   child: Text(
                                                                                                            //     '${TransReBillModels[index1][index2].date}',
                                                                                                            //     style: const TextStyle(
                                                                                                            //       color: ReportScreen_Color.Colors_Text2_,
                                                                                                            //       // fontWeight:
                                                                                                            //       //     FontWeight.bold,
                                                                                                            //       fontFamily: Font_.Fonts_T,
                                                                                                            //     ),
                                                                                                            //   ),
                                                                                                            // ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${TransReBillModels[index1][index2].expname}',
                                                                                                                textAlign: TextAlign.center,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${TransReBillModels[index1][index2].total_sumnvat}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${TransReBillModels[index1][index2].vtype}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${nFormat.format(double.parse(TransReBillModels[index1][index2].total_sumvat!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                (TransReBillModels[index1][index2].total_sumramt.toString() == 'null') ? '-' : '${nFormat.format(double.parse(TransReBillModels[index1][index2].total_sumramt!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                (TransReBillModels[index1][index2].total_sumramtd.toString() == 'null') ? '-' : '${nFormat.format(double.parse(TransReBillModels[index1][index2].total_sumramtd!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${nFormat.format(double.parse(TransReBillModels[index1][index2].total_sumamt!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            Expanded(
                                                                                                              flex: 1,
                                                                                                              child: Text(
                                                                                                                '${nFormat.format(double.parse(TransReBillModels[index1][index2].total_sum!))}',
                                                                                                                textAlign: TextAlign.right,
                                                                                                                style: const TextStyle(
                                                                                                                  color: ReportScreen_Color.Colors_Text2_,
                                                                                                                  // fontWeight:
                                                                                                                  //     FontWeight.bold,
                                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                                ),
                                                                                                              ),
                                                                                                            ),
                                                                                                            // Expanded(
                                                                                                            //   flex: 1,
                                                                                                            //   child: Text(
                                                                                                            //     (TransReBillModels[index1][index2].sname == null) ? '' : '**${TransReBillModels[index1][index2].sname!}',
                                                                                                            //     style: const TextStyle(
                                                                                                            //       color: ReportScreen_Color.Colors_Text2_,
                                                                                                            //       // fontWeight:
                                                                                                            //       //     FontWeight.bold,
                                                                                                            //       fontFamily: Font_.Fonts_T,
                                                                                                            //     ),
                                                                                                            //   ),
                                                                                                            // ),
                                                                                                          ],
                                                                                                        ),
                                                                                                        const SizedBox(
                                                                                                          height: 10,
                                                                                                        )
                                                                                                      ],
                                                                                                    ),
                                                                                                  ),
                                                                                              ],
                                                                                            ),
                                                                                          ),
                                                                                      ],
                                                                                    ),
                                                                                  ),
                                                                                );
                                                                              },
                                                                            )),
                                                                      ],
                                                                    ),
                                                            ),
                                                          ],
                                                        ),
                                                      ),
                                                    );
                                                  }),
                                              actions: <Widget>[
                                                StreamBuilder(
                                                    stream: Stream.periodic(
                                                        const Duration(
                                                            seconds: 0)),
                                                    builder:
                                                        (context, snapshot) {
                                                      return Padding(
                                                        padding:
                                                            const EdgeInsets
                                                                    .fromLTRB(
                                                                8, 0, 20, 4),
                                                        child: Row(
                                                          mainAxisAlignment:
                                                              MainAxisAlignment
                                                                  .end,
                                                          children: [
                                                            SizedBox(
                                                              height: 120,
                                                              width: 240,
                                                              child: Column(
                                                                children: [
                                                                  Row(
                                                                    children: [
                                                                      Expanded(
                                                                          child:
                                                                              Container(
                                                                        decoration:
                                                                            const BoxDecoration(
                                                                          color:
                                                                              AppbackgroundColor.TiTile_Colors,
                                                                          borderRadius: BorderRadius.only(
                                                                              topLeft: Radius.circular(5),
                                                                              topRight: Radius.circular(5),
                                                                              bottomLeft: Radius.circular(0),
                                                                              bottomRight: Radius.circular(0)),
                                                                        ),
                                                                        child:
                                                                            const Center(
                                                                          child:
                                                                              Text(
                                                                            'รวม',
                                                                            maxLines:
                                                                                1,
                                                                            textAlign:
                                                                                TextAlign.start,
                                                                            style:
                                                                                TextStyle(
                                                                              color: ReportScreen_Color.Colors_Text1_,
                                                                              fontWeight: FontWeight.bold,
                                                                              fontFamily: FontWeight_.Fonts_T,
                                                                            ),
                                                                          ),
                                                                        ),
                                                                      ))
                                                                    ],
                                                                  ),
                                                                  Row(
                                                                    children: [
                                                                      Expanded(
                                                                        flex: 1,
                                                                        child: Container(
                                                                            decoration: BoxDecoration(
                                                                              color: Colors.grey[300],
                                                                              borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                            ),
                                                                            child: const Text(
                                                                              'รวม 70%',
                                                                              maxLines: 1,
                                                                              textAlign: TextAlign.start,
                                                                              style: TextStyle(
                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                fontWeight: FontWeight.bold,
                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                              ),
                                                                            )),
                                                                      ),
                                                                      Expanded(
                                                                        flex: 1,
                                                                        child: Container(
                                                                            color: Colors.grey[200],
                                                                            child: Text(
                                                                              '${nFormat.format(Sum_Ramt_)}',
                                                                              maxLines: 1,
                                                                              textAlign: TextAlign.end,
                                                                              style: const TextStyle(
                                                                                color: ReportScreen_Color.Colors_Text2_,
                                                                                fontWeight: FontWeight.bold,
                                                                                fontFamily: Font_.Fonts_T,
                                                                              ),
                                                                            )),
                                                                      ),
                                                                    ],
                                                                  ),
                                                                  Row(
                                                                    children: [
                                                                      Expanded(
                                                                        flex: 1,
                                                                        child: Container(
                                                                            decoration: BoxDecoration(
                                                                              color: Colors.grey[300],
                                                                              borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                            ),
                                                                            child: const Text(
                                                                              'รวม 30%',
                                                                              maxLines: 1,
                                                                              textAlign: TextAlign.start,
                                                                              style: TextStyle(
                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                fontWeight: FontWeight.bold,
                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                              ),
                                                                            )),
                                                                      ),
                                                                      Expanded(
                                                                        flex: 1,
                                                                        child: Container(
                                                                            color: Colors.grey[200],
                                                                            child: Text(
                                                                              '${nFormat.format(Sum_Ramtd_)}',
                                                                              maxLines: 1,
                                                                              textAlign: TextAlign.end,
                                                                              style: const TextStyle(
                                                                                color: ReportScreen_Color.Colors_Text2_,
                                                                                fontWeight: FontWeight.bold,
                                                                                fontFamily: Font_.Fonts_T,
                                                                              ),
                                                                            )),
                                                                      ),
                                                                    ],
                                                                  ),
                                                                  // Row(
                                                                  //   children: [
                                                                  //     Expanded(
                                                                  //       flex: 1,
                                                                  //       child: Container(
                                                                  //           decoration:
                                                                  //               BoxDecoration(
                                                                  //             color: Colors
                                                                  //                     .grey[
                                                                  //                 300],
                                                                  //             borderRadius: const BorderRadius
                                                                  //                     .only(
                                                                  //                 topLeft:
                                                                  //                     Radius.circular(
                                                                  //                         0),
                                                                  //                 topRight:
                                                                  //                     Radius.circular(
                                                                  //                         0),
                                                                  //                 bottomLeft:
                                                                  //                     Radius.circular(
                                                                  //                         0),
                                                                  //                 bottomRight:
                                                                  //                     Radius.circular(0)),
                                                                  //           ),
                                                                  //           child:
                                                                  //               const Text(
                                                                  //             'รวมราคาก่อน Vat',
                                                                  //             maxLines: 1,
                                                                  //             textAlign:
                                                                  //                 TextAlign
                                                                  //                     .start,
                                                                  //             style:
                                                                  //                 TextStyle(
                                                                  //               color: ReportScreen_Color
                                                                  //                   .Colors_Text1_,
                                                                  //               fontWeight:
                                                                  //                   FontWeight
                                                                  //                       .bold,
                                                                  //               fontFamily:
                                                                  //                   FontWeight_
                                                                  //                       .Fonts_T,
                                                                  //             ),
                                                                  //           )),
                                                                  //     ),
                                                                  //     Expanded(
                                                                  //       flex: 1,
                                                                  //       child: Container(
                                                                  //           color: Colors
                                                                  //                   .grey[
                                                                  //               200],
                                                                  //           child: Text(
                                                                  //             '${nFormat.format(Sum_Amt_)}',
                                                                  //             maxLines: 1,
                                                                  //             textAlign:
                                                                  //                 TextAlign
                                                                  //                     .end,
                                                                  //             style:
                                                                  //                 const TextStyle(
                                                                  //               color: ReportScreen_Color
                                                                  //                   .Colors_Text2_,
                                                                  //               fontWeight:
                                                                  //                   FontWeight
                                                                  //                       .bold,
                                                                  //               fontFamily:
                                                                  //                   Font_
                                                                  //                       .Fonts_T,
                                                                  //             ),
                                                                  //           )),
                                                                  //     ),
                                                                  //   ],
                                                                  // ),
                                                                  Row(
                                                                    children: [
                                                                      Expanded(
                                                                        flex: 1,
                                                                        child: Container(
                                                                            decoration: BoxDecoration(
                                                                              color: Colors.grey[300],
                                                                              borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                            ),
                                                                            child: const Text(
                                                                              'รวม',
                                                                              maxLines: 1,
                                                                              textAlign: TextAlign.start,
                                                                              style: TextStyle(
                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                fontWeight: FontWeight.bold,
                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                              ),
                                                                            )),
                                                                      ),
                                                                      Expanded(
                                                                        flex: 1,
                                                                        child: Container(
                                                                            color: Colors.grey[200],
                                                                            child: Text(
                                                                              '${nFormat.format(Sum_Total_)}',
                                                                              maxLines: 1,
                                                                              textAlign: TextAlign.end,
                                                                              style: const TextStyle(
                                                                                color: ReportScreen_Color.Colors_Text2_,
                                                                                fontWeight: FontWeight.bold,
                                                                                fontFamily: Font_.Fonts_T,
                                                                              ),
                                                                            )),
                                                                      ),
                                                                    ],
                                                                  ),
                                                                ],
                                                              ),
                                                            )
                                                          ],
                                                        ),
                                                      );
                                                    }),
                                                const SizedBox(height: 1),
                                                const Divider(),
                                                const SizedBox(height: 1),
                                                Padding(
                                                  padding:
                                                      const EdgeInsets.fromLTRB(
                                                          8, 4, 8, 4),
                                                  child: SingleChildScrollView(
                                                    scrollDirection:
                                                        Axis.horizontal,
                                                    child: Row(
                                                      mainAxisAlignment:
                                                          MainAxisAlignment.end,
                                                      children: [
                                                        if (_TransReBillModels
                                                                .length !=
                                                            0)
                                                          Padding(
                                                            padding:
                                                                const EdgeInsets
                                                                    .all(8.0),
                                                            child: InkWell(
                                                              child: Container(
                                                                width: 100,
                                                                decoration:
                                                                    const BoxDecoration(
                                                                  color: Colors
                                                                      .blue,
                                                                  borderRadius: BorderRadius.only(
                                                                      topLeft:
                                                                          Radius.circular(
                                                                              10),
                                                                      topRight:
                                                                          Radius.circular(
                                                                              10),
                                                                      bottomLeft:
                                                                          Radius.circular(
                                                                              10),
                                                                      bottomRight:
                                                                          Radius.circular(
                                                                              10)),
                                                                ),
                                                                padding:
                                                                    const EdgeInsets
                                                                            .all(
                                                                        8.0),
                                                                child:
                                                                    const Center(
                                                                  child: Text(
                                                                    'Export file',
                                                                    style:
                                                                        TextStyle(
                                                                      color: Colors
                                                                          .white,
                                                                      fontWeight:
                                                                          FontWeight
                                                                              .bold,
                                                                      fontFamily:
                                                                          Font_
                                                                              .Fonts_T,
                                                                    ),
                                                                  ),
                                                                ),
                                                              ),
                                                              onTap: () {
                                                                if (_TransReBillModels
                                                                        .length ==
                                                                    0) {
                                                                } else {
                                                                  setState(() {
                                                                    show_more =
                                                                        null;
                                                                    Value_Report =
                                                                        'รายงานประจำวัน';
                                                                    Pre_and_Dow =
                                                                        'Download';
                                                                  });
                                                                  // Navigator.of(
                                                                  //         context)
                                                                  //     .pop();
                                                                  _showMyDialog_SAVE();
                                                                }
                                                              },
                                                            ),
                                                          ),
                                                        // if (_TransReBillModels
                                                        //         .length !=
                                                        //     0)
                                                        //   Padding(
                                                        //     padding:
                                                        //         const EdgeInsets
                                                        //             .all(8.0),
                                                        //     child: InkWell(
                                                        //       child: Container(
                                                        //         width: 100,
                                                        //         decoration:
                                                        //             const BoxDecoration(
                                                        //           color: Colors
                                                        //               .green,
                                                        //           borderRadius: BorderRadius.only(
                                                        //               topLeft:
                                                        //                   Radius.circular(
                                                        //                       10),
                                                        //               topRight:
                                                        //                   Radius.circular(
                                                        //                       10),
                                                        //               bottomLeft:
                                                        //                   Radius.circular(
                                                        //                       10),
                                                        //               bottomRight:
                                                        //                   Radius.circular(
                                                        //                       10)),
                                                        //         ),
                                                        //         padding:
                                                        //             const EdgeInsets
                                                        //                     .all(
                                                        //                 8.0),
                                                        //         child:
                                                        //             const Center(
                                                        //           child: Text(
                                                        //             'Print',
                                                        //             style:
                                                        //                 TextStyle(
                                                        //               color: Colors
                                                        //                   .white,
                                                        //               fontWeight:
                                                        //                   FontWeight
                                                        //                       .bold,
                                                        //               fontFamily:
                                                        //                   Font_
                                                        //                       .Fonts_T,
                                                        //             ),
                                                        //           ),
                                                        //         ),
                                                        //       ),
                                                        //       onTap: () async {
                                                        //         if (_TransReBillModels
                                                        //                 .length ==
                                                        //             0) {
                                                        //         } else {
                                                        //           setState(() {
                                                        //             show_more =
                                                        //                 null;
                                                        //             Value_Report =
                                                        //                 'รายงานประจำวัน';
                                                        //             Pre_and_Dow =
                                                        //                 'Preview';
                                                        //           });
                                                        //           // Navigator.pop(context);
                                                        //           _displayPdf_();
                                                        //         }
                                                        //       },
                                                        //     ),
                                                        //   ),
                                                        Padding(
                                                          padding:
                                                              const EdgeInsets
                                                                  .all(8.0),
                                                          child: InkWell(
                                                            child: Container(
                                                              width: 100,
                                                              decoration:
                                                                  const BoxDecoration(
                                                                color: Colors
                                                                    .black,
                                                                borderRadius: BorderRadius.only(
                                                                    topLeft: Radius
                                                                        .circular(
                                                                            10),
                                                                    topRight: Radius
                                                                        .circular(
                                                                            10),
                                                                    bottomLeft:
                                                                        Radius.circular(
                                                                            10),
                                                                    bottomRight:
                                                                        Radius.circular(
                                                                            10)),
                                                              ),
                                                              padding:
                                                                  const EdgeInsets
                                                                      .all(8.0),
                                                              child:
                                                                  const Center(
                                                                child: Text(
                                                                  'ปิด',
                                                                  style:
                                                                      TextStyle(
                                                                    color: Colors
                                                                        .white,
                                                                    fontWeight:
                                                                        FontWeight
                                                                            .bold,
                                                                    fontFamily:
                                                                        Font_
                                                                            .Fonts_T,
                                                                  ),
                                                                ),
                                                              ),
                                                            ),
                                                            onTap: () {
                                                              setState(() {
                                                                show_more =
                                                                    null;
                                                              });
                                                              Navigator.of(
                                                                      context)
                                                                  .pop();
                                                            },
                                                          ),
                                                        ),
                                                      ],
                                                    ),
                                                  ),
                                                ),
                                              ],
                                            );
                                          },
                                        );
                                      },
                          ),
                          // const Padding(
                          //   padding: EdgeInsets.all(8.0),
                          //   child: Text(
                          //     'รายงานประจำวัน',
                          //     style: TextStyle(
                          //       color: ReportScreen_Color.Colors_Text2_,
                          //       // fontWeight: FontWeight.bold,
                          //       fontFamily: Font_.Fonts_T,
                          //     ),
                          //   ),
                          // ),
                          (_TransReBillModels.isEmpty)
                              ? Padding(
                                  padding: const EdgeInsets.all(8.0),
                                  child: Text(
                                    (Value_selectDate != null &&
                                            TransReBillModels.isEmpty)
                                        ? 'รายงานประจำวัน (ไม่พบข้อมูล ✖️)'
                                        : 'รายงานประจำวัน',
                                    style: const TextStyle(
                                      color: ReportScreen_Color.Colors_Text2_,
                                      // fontWeight: FontWeight.bold,
                                      fontFamily: Font_.Fonts_T,
                                    ),
                                  ),
                                )
                              : (TransReBillModels[
                                          _TransReBillModels.length - 1]
                                      .isEmpty)
                                  ? SizedBox(
                                      // height: 20,
                                      child: Row(
                                      children: [
                                        Container(
                                            padding: const EdgeInsets.all(4.0),
                                            child:
                                                const CircularProgressIndicator()),
                                        const Padding(
                                          padding: EdgeInsets.all(8.0),
                                          child: Text(
                                            'กำลังโหลดรายงานประจำวัน...',
                                            style: TextStyle(
                                              color: ReportScreen_Color
                                                  .Colors_Text2_,
                                              // fontWeight: FontWeight.bold,
                                              fontFamily: Font_.Fonts_T,
                                            ),
                                          ),
                                        ),
                                      ],
                                    ))
                                  : const Padding(
                                      padding: EdgeInsets.all(8.0),
                                      child: Text(
                                        'รายงานประจำวัน ✔️',
                                        style: TextStyle(
                                          color:
                                              ReportScreen_Color.Colors_Text2_,
                                          // fontWeight: FontWeight.bold,
                                          fontFamily: Font_.Fonts_T,
                                        ),
                                      ),
                                    ),
                        ],
                      ),
                    ),
//////////////////////////////////----------------------------------------->(รายงานประจำวัน รายบุคคล)
                    const SizedBox(
                      height: 5.0,
                    ),
                    Row(
                      children: [
                        Container(
                          width: MediaQuery.of(context).size.width / 2,
                          height: 4.0,
                          child: Divider(
                            color: Colors.grey[300],
                            height: 4.0,
                          ),
                        ),
                      ],
                    ),
                    const SizedBox(
                      height: 5.0,
                    ),
                    Row(
                      children: [
                        const Padding(
                          padding: EdgeInsets.all(8.0),
                          child: Text(
                            'ผู้เช่า :',
                            style: TextStyle(
                              color: ReportScreen_Color.Colors_Text2_,
                              // fontWeight: FontWeight.bold,
                              fontFamily: Font_.Fonts_T,
                            ),
                          ),
                        ),
                        Padding(
                          padding: const EdgeInsets.all(8.0),
                          child: InkWell(
                            onTap: () async {
                              //${teNantModels.}
                              showDialog(
                                barrierDismissible: false,
                                context: context,
                                builder: (BuildContext context) => StatefulBuilder(
                                    // stream: Stream.periodic(const Duration(seconds: 0)),
                                    builder: (context, snapshot) {
                                  return AlertDialog(
                                    backgroundColor: Colors.grey.shade100,
                                    shape: const RoundedRectangleBorder(
                                        borderRadius: BorderRadius.all(
                                            Radius.circular(20.0))),
                                    title: Column(
                                      children: [
                                        Center(
                                          child: Text(
                                            'รายชื่อผู้เช่า',
                                            style: TextStyle(
                                                color: ReportScreen_Color
                                                    .Colors_Text1_,
                                                fontWeight: FontWeight.bold,
                                                fontFamily:
                                                    FontWeight_.Fonts_T),
                                          ),
                                        ),
                                        Container(
                                          width:
                                              MediaQuery.of(context).size.width,
                                          // padding: EdgeInsets.all(10),
                                          child: Row(
                                            mainAxisAlignment:
                                                MainAxisAlignment.start,
                                            children: [
                                              Expanded(
                                                child: _searchBar(),
                                              ),
                                            ],
                                          ),
                                        ),
                                      ],
                                    ),
                                    content: Center(
                                      child: ScrollConfiguration(
                                        behavior:
                                            ScrollConfiguration.of(context)
                                                .copyWith(dragDevices: {
                                          PointerDeviceKind.touch,
                                          PointerDeviceKind.mouse,
                                        }),
                                        child: SingleChildScrollView(
                                          scrollDirection: Axis.horizontal,
                                          dragStartBehavior:
                                              DragStartBehavior.start,
                                          child: Row(
                                            mainAxisAlignment:
                                                MainAxisAlignment.center,
                                            children: [
                                              SizedBox(
                                                width: MediaQuery.of(context)
                                                        .size
                                                        .width *
                                                    0.92,
                                                height: MediaQuery.of(context)
                                                        .size
                                                        .height *
                                                    0.66,
                                                child: Column(
                                                  children: [
                                                    Container(
                                                      padding:
                                                          const EdgeInsets.all(
                                                              10),
                                                      decoration: BoxDecoration(
                                                        color: Colors
                                                            .grey.shade600,
                                                        borderRadius: const BorderRadius
                                                                .only(
                                                            topLeft: Radius
                                                                .circular(10),
                                                            topRight:
                                                                Radius.circular(
                                                                    10),
                                                            bottomLeft:
                                                                Radius.circular(
                                                                    0),
                                                            bottomRight:
                                                                Radius.circular(
                                                                    0)),
                                                      ),
                                                      child: Row(
                                                        children: const [
                                                          Expanded(
                                                            flex: 2,
                                                            child: AutoSizeText(
                                                              minFontSize: 10,
                                                              maxFontSize: 18,
                                                              'เลขที่สัญญา/เสนอราคา',
                                                              textAlign:
                                                                  TextAlign
                                                                      .center,
                                                              style: TextStyle(
                                                                  color: Colors
                                                                      .white,
                                                                  fontWeight:
                                                                      FontWeight
                                                                          .bold,
                                                                  fontFamily:
                                                                      FontWeight_
                                                                          .Fonts_T),
                                                            ),
                                                          ),
                                                          Expanded(
                                                            flex: 3,
                                                            child: AutoSizeText(
                                                              minFontSize: 10,
                                                              maxFontSize: 18,
                                                              'โซน',
                                                              textAlign:
                                                                  TextAlign
                                                                      .center,
                                                              style: TextStyle(
                                                                  color: Colors
                                                                      .white,
                                                                  fontWeight:
                                                                      FontWeight
                                                                          .bold,
                                                                  fontFamily:
                                                                      FontWeight_
                                                                          .Fonts_T),
                                                            ),
                                                          ),
                                                          Expanded(
                                                            flex: 3,
                                                            child: AutoSizeText(
                                                              minFontSize: 10,
                                                              maxFontSize: 18,
                                                              'รหัสพื้นที่',
                                                              textAlign:
                                                                  TextAlign
                                                                      .center,
                                                              style: TextStyle(
                                                                  color: Colors
                                                                      .white,
                                                                  fontWeight:
                                                                      FontWeight
                                                                          .bold,
                                                                  fontFamily:
                                                                      FontWeight_
                                                                          .Fonts_T),
                                                            ),
                                                          ),
                                                          Expanded(
                                                            flex: 3,
                                                            child: AutoSizeText(
                                                              minFontSize: 10,
                                                              maxFontSize: 18,
                                                              'ร้าน',
                                                              textAlign:
                                                                  TextAlign
                                                                      .center,
                                                              style: TextStyle(
                                                                  color: Colors
                                                                      .white,
                                                                  fontWeight:
                                                                      FontWeight
                                                                          .bold,
                                                                  fontFamily:
                                                                      FontWeight_
                                                                          .Fonts_T),
                                                            ),
                                                          ),
                                                          Expanded(
                                                            flex: 3,
                                                            child: AutoSizeText(
                                                              minFontSize: 10,
                                                              maxFontSize: 18,
                                                              'ชื่อผู่เช่า/บริษัท',
                                                              textAlign:
                                                                  TextAlign
                                                                      .center,
                                                              style: TextStyle(
                                                                  color: Colors
                                                                      .white,
                                                                  fontWeight:
                                                                      FontWeight
                                                                          .bold,
                                                                  fontFamily:
                                                                      FontWeight_
                                                                          .Fonts_T),
                                                            ),
                                                          ),
                                                          Expanded(
                                                            flex: 2,
                                                            child: AutoSizeText(
                                                              minFontSize: 10,
                                                              maxFontSize: 18,
                                                              'สถานะ',
                                                              textAlign:
                                                                  TextAlign
                                                                      .center,
                                                              style: TextStyle(
                                                                  color: Colors
                                                                      .white,
                                                                  fontWeight:
                                                                      FontWeight
                                                                          .bold,
                                                                  fontFamily:
                                                                      FontWeight_
                                                                          .Fonts_T),
                                                            ),
                                                          ),
                                                          Expanded(
                                                            flex: 1,
                                                            child: AutoSizeText(
                                                              minFontSize: 10,
                                                              maxFontSize: 18,
                                                              'Select',
                                                              textAlign:
                                                                  TextAlign
                                                                      .center,
                                                              style: TextStyle(
                                                                  color: Colors
                                                                      .white,
                                                                  fontWeight:
                                                                      FontWeight
                                                                          .bold,
                                                                  fontFamily:
                                                                      FontWeight_
                                                                          .Fonts_T),
                                                            ),
                                                          ),
                                                        ],
                                                      ),
                                                    ),
                                                    Expanded(
                                                        child: Container(
                                                      // color: Colors.amber,
                                                      child: StreamBuilder(
                                                          stream:
                                                              Stream.periodic(
                                                                  const Duration(
                                                                      seconds:
                                                                          0)),
                                                          builder: (context,
                                                              snapshot) {
                                                            return ListView
                                                                .builder(
                                                                    physics:
                                                                        const AlwaysScrollableScrollPhysics(),
                                                                    shrinkWrap:
                                                                        true,
                                                                    itemCount:
                                                                        teNantModels
                                                                            .length,
                                                                    itemBuilder:
                                                                        (BuildContext
                                                                                context,
                                                                            int index) {
                                                                      return Container(
                                                                        padding:
                                                                            const EdgeInsets.all(5),
                                                                        child:
                                                                            ListTile(
                                                                          onTap:
                                                                              () async {
                                                                            setState(() {
                                                                              Value_selectDate_daly_cus = null;
                                                                              ciddoc_Cusdaly_Cm = teNantModels[index].cid.toString();
                                                                            });

                                                                            Navigator.pop(context);
                                                                          },
                                                                          title:
                                                                              Row(
                                                                            children: [
                                                                              Expanded(
                                                                                flex: 2,
                                                                                child: AutoSizeText(
                                                                                  minFontSize: 10,
                                                                                  maxFontSize: 18,
                                                                                  teNantModels[index].cid == null ? '' : '${teNantModels[index].cid}',
                                                                                  textAlign: TextAlign.center,
                                                                                  style: const TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                      // fontWeight: FontWeight.bold,
                                                                                      fontFamily: Font_.Fonts_T),
                                                                                ),
                                                                              ),
                                                                              Expanded(
                                                                                flex: 3,
                                                                                child: AutoSizeText(
                                                                                  minFontSize: 10,
                                                                                  maxFontSize: 18,
                                                                                  '${teNantModels[index].zn}',
                                                                                  textAlign: TextAlign.center,
                                                                                  style: const TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                      // fontWeight: FontWeight.bold,
                                                                                      fontFamily: Font_.Fonts_T),
                                                                                ),
                                                                              ),
                                                                              Expanded(
                                                                                flex: 3,
                                                                                child: AutoSizeText(
                                                                                  minFontSize: 10,
                                                                                  maxFontSize: 18,
                                                                                  '${teNantModels[index].ln}',
                                                                                  textAlign: TextAlign.center,
                                                                                  style: const TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                      // fontWeight: FontWeight.bold,
                                                                                      fontFamily: Font_.Fonts_T),
                                                                                ),
                                                                              ),
                                                                              Expanded(
                                                                                flex: 3,
                                                                                child: AutoSizeText(
                                                                                  minFontSize: 10,
                                                                                  maxFontSize: 18,
                                                                                  '${teNantModels[index].sname}',
                                                                                  textAlign: TextAlign.center,
                                                                                  style: const TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text2_,

                                                                                      // fontWeight: FontWeight.bold,
                                                                                      fontFamily: Font_.Fonts_T),
                                                                                ),
                                                                              ),
                                                                              Expanded(
                                                                                flex: 3,
                                                                                child: AutoSizeText(
                                                                                  minFontSize: 10,
                                                                                  maxFontSize: 18,
                                                                                  '${teNantModels[index].cname}',
                                                                                  textAlign: TextAlign.center,
                                                                                  style: const TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                      // fontWeight: FontWeight.bold,
                                                                                      fontFamily: Font_.Fonts_T),
                                                                                ),
                                                                              ),
                                                                              Expanded(
                                                                                flex: 2,
                                                                                child: AutoSizeText(
                                                                                  minFontSize: 10,
                                                                                  maxFontSize: 18,
                                                                                  teNantModels[index].quantity == '1'
                                                                                      ? datex.isAfter(DateTime.parse('${teNantModels[index].ldate} 00:00:00.000').subtract(const Duration(days: 0))) == true
                                                                                          ? 'หมดสัญญา'
                                                                                          : datex.isAfter(DateTime.parse('${teNantModels[index].ldate} 00:00:00.000').subtract(const Duration(days: 30))) == true
                                                                                              ? 'ใกล้หมดสัญญา'
                                                                                              : 'เช่าอยู่'
                                                                                      : teNantModels[index].quantity == '2'
                                                                                          ? 'เสนอราคา'
                                                                                          : teNantModels[index].quantity == '3'
                                                                                              ? 'เสนอราคา(มัดจำ)'
                                                                                              : 'ว่าง',
                                                                                  textAlign: TextAlign.center,
                                                                                  style: TextStyle(
                                                                                      color: teNantModels[index].quantity == '1'
                                                                                          ? datex.isAfter(DateTime.parse('${teNantModels[index].ldate} 00:00:00.000').subtract(const Duration(days: 0))) == true
                                                                                              ? Colors.red
                                                                                              : datex.isAfter(DateTime.parse('${teNantModels[index].ldate} 00:00:00.000').subtract(const Duration(days: 30))) == true
                                                                                                  ? Colors.orange.shade900
                                                                                                  : Colors.black
                                                                                          : teNantModels[index].quantity == '2'
                                                                                              ? Colors.blue
                                                                                              : teNantModels[index].quantity == '3'
                                                                                                  ? Colors.blue
                                                                                                  : Colors.green,
                                                                                      // fontWeight: FontWeight.bold,
                                                                                      fontFamily: Font_.Fonts_T),
                                                                                ),
                                                                              ),
                                                                              const Expanded(
                                                                                flex: 1,
                                                                                child: AutoSizeText(
                                                                                  minFontSize: 10,
                                                                                  maxFontSize: 18,
                                                                                  'Select',
                                                                                  textAlign: TextAlign.center,
                                                                                  style: TextStyle(
                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                      // fontWeight: FontWeight.bold,
                                                                                      fontFamily: Font_.Fonts_T),
                                                                                ),
                                                                              ),
                                                                            ],
                                                                          ),
                                                                        ),
                                                                      );
                                                                    });
                                                          }),
                                                    ))
                                                  ],
                                                ),
                                              ),
                                            ],
                                          ),
                                        ),
                                      ),
                                    ),
                                    actions: <Widget>[
                                      Padding(
                                        padding: const EdgeInsets.all(8.0),
                                        child: Row(
                                          mainAxisAlignment:
                                              MainAxisAlignment.end,
                                          children: [
                                            Container(
                                              width: 100,
                                              decoration: const BoxDecoration(
                                                color: Colors.black,
                                                borderRadius: BorderRadius.only(
                                                    topLeft:
                                                        Radius.circular(10),
                                                    topRight:
                                                        Radius.circular(10),
                                                    bottomLeft:
                                                        Radius.circular(10),
                                                    bottomRight:
                                                        Radius.circular(10)),
                                              ),
                                              padding:
                                                  const EdgeInsets.all(8.0),
                                              child: TextButton(
                                                onPressed: () {
                                                  Navigator.pop(context);
                                                },
                                                child: const Text(
                                                  'ยกเลิก',
                                                  style: TextStyle(
                                                      color: Colors.white,
                                                      fontWeight:
                                                          FontWeight.bold,
                                                      fontFamily:
                                                          FontWeight_.Fonts_T),
                                                ),
                                              ),
                                            ),
                                          ],
                                        ),
                                      ),
                                    ],
                                  );
                                }),
                              );
                            },
                            child: Container(
                                decoration: BoxDecoration(
                                  color: AppbackgroundColor.Sub_Abg_Colors,
                                  borderRadius: const BorderRadius.only(
                                      topLeft: Radius.circular(10),
                                      topRight: Radius.circular(10),
                                      bottomLeft: Radius.circular(10),
                                      bottomRight: Radius.circular(10)),
                                  border:
                                      Border.all(color: Colors.grey, width: 1),
                                ),
                                width: 120,
                                padding: const EdgeInsets.all(8.0),
                                child: Center(
                                  child: Text(
                                    (ciddoc_Cusdaly_Cm == null)
                                        ? 'เลือก'
                                        : '$ciddoc_Cusdaly_Cm',
                                    style: const TextStyle(
                                      color: ReportScreen_Color.Colors_Text2_,
                                      // fontWeight: FontWeight.bold,
                                      fontFamily: Font_.Fonts_T,
                                    ),
                                  ),
                                )),
                          ),
                        ),
                        const Padding(
                          padding: EdgeInsets.all(8.0),
                          child: Text(
                            'วันที่ :',
                            style: TextStyle(
                              color: ReportScreen_Color.Colors_Text2_,
                              // fontWeight: FontWeight.bold,
                              fontFamily: Font_.Fonts_T,
                            ),
                          ),
                        ),
                        Padding(
                          padding: const EdgeInsets.all(8.0),
                          child: InkWell(
                            onTap: () {
                              _select_Date_daly_cus(context);
                            },
                            child: Container(
                                decoration: BoxDecoration(
                                  color: AppbackgroundColor.Sub_Abg_Colors,
                                  borderRadius: const BorderRadius.only(
                                      topLeft: Radius.circular(10),
                                      topRight: Radius.circular(10),
                                      bottomLeft: Radius.circular(10),
                                      bottomRight: Radius.circular(10)),
                                  border:
                                      Border.all(color: Colors.grey, width: 1),
                                ),
                                width: 120,
                                padding: const EdgeInsets.all(8.0),
                                child: Center(
                                  child: Text(
                                    (Value_selectDate_daly_cus == null)
                                        ? 'เลือก'
                                        : '$Value_selectDate_daly_cus',
                                    style: const TextStyle(
                                      color: ReportScreen_Color.Colors_Text2_,
                                      // fontWeight: FontWeight.bold,
                                      fontFamily: Font_.Fonts_T,
                                    ),
                                  ),
                                )),
                          ),
                        ),
                      ],
                    ),

                    Padding(
                      padding: const EdgeInsets.all(8.0),
                      child: Row(
                        children: [
                          // if (Value_selectDate != null &&
                          //     _TransReBillModels.length != 0)
                          InkWell(
                            child: Container(
                              decoration: BoxDecoration(
                                color: Colors.yellow[600],
                                borderRadius: const BorderRadius.only(
                                    topLeft: Radius.circular(10),
                                    topRight: Radius.circular(10),
                                    bottomLeft: Radius.circular(10),
                                    bottomRight: Radius.circular(10)),
                                border:
                                    Border.all(color: Colors.grey, width: 1),
                              ),
                              padding: const EdgeInsets.all(8.0),
                              child: Center(
                                child: Row(
                                  mainAxisAlignment: MainAxisAlignment.center,
                                  children: const [
                                    Text(
                                      'เรียกดู',
                                      style: TextStyle(
                                        color: ReportScreen_Color.Colors_Text1_,
                                        fontWeight: FontWeight.bold,
                                        fontFamily: FontWeight_.Fonts_T,
                                      ),
                                    ),
                                    Icon(
                                      Icons.navigate_next,
                                      color: Colors.grey,
                                    )
                                  ],
                                ),
                              ),
                            ),
                            onTap:
                                (_TransReBillModels_cus.isEmpty ||
                                        Value_selectDate_daly_cus == null)
                                    ? null
                                    : (TransReBillModels_cus[
                                                _TransReBillModels_cus.length -
                                                    1]
                                            .isEmpty)
                                        ? null
                                        : () async {
                                            // List show_more = [];
                                            int? show_more;

                                            double Sum_Ramt_ = 0.0;
                                            double Sum_Ramtd_ = 0.0;
                                            double Sum_Amt_ = 0.0;
                                            double Sum_Total_ = 0.0;

                                            for (int indexsum1 = 0;
                                                indexsum1 <
                                                    _TransReBillModels_cus
                                                        .length;
                                                indexsum1++) {
                                              Sum_Ramt_ = Sum_Ramt_ +
                                                  double.parse(
                                                      _TransReBillModels_cus[
                                                              indexsum1]
                                                          .ramt!);

                                              Sum_Ramtd_ = Sum_Ramtd_ +
                                                  double.parse(
                                                      _TransReBillModels_cus[
                                                              indexsum1]
                                                          .ramtd!);

                                              Sum_Amt_ = Sum_Amt_ +
                                                  double.parse(
                                                      _TransReBillModels_cus[
                                                              indexsum1]
                                                          .amt!);

                                              Sum_Total_ = Sum_Total_ +
                                                  double.parse(
                                                      _TransReBillModels_cus[
                                                              indexsum1]
                                                          .total_bill!);
                                              // for (int indexsum2 = 0;
                                              //     indexsum2 <
                                              //         TransReBillModels[indexsum1].length;
                                              //     indexsum2++) {
                                              //   Sum_Ramt_ = Sum_Ramt_ +
                                              //       double.parse(TransReBillModels[indexsum1]
                                              //               [indexsum2]
                                              //           .ramt!);
                                              //   Sum_Ramtd_ = Sum_Ramtd_ +
                                              //       double.parse(TransReBillModels[indexsum1]
                                              //               [indexsum2]
                                              //           .ramtd!);
                                              //   Sum_Amt_ = Sum_Amt_ +
                                              //       double.parse(TransReBillModels[indexsum1]
                                              //               [indexsum2]
                                              //           .amt!);
                                              //   Sum_Total_ = Sum_Total_ +
                                              //       double.parse(TransReBillModels[indexsum1]
                                              //               [indexsum2]
                                              //           .total!);
                                              // }
                                            }
                                            Insert_log.Insert_logs('รายงาน',
                                                'กดดูรายงานประจำวันรายบุคคล');

                                            showDialog<void>(
                                              context: context,
                                              barrierDismissible:
                                                  false, // user must tap button!
                                              builder: (BuildContext context) {
                                                return AlertDialog(
                                                  shape:
                                                      const RoundedRectangleBorder(
                                                          borderRadius:
                                                              BorderRadius.all(
                                                                  Radius.circular(
                                                                      20.0))),
                                                  title: Column(
                                                    children: [
                                                      Center(
                                                          child: Text(
                                                        'รายงานประจำวันรายบุคคล ',
                                                        style: TextStyle(
                                                          color:
                                                              ReportScreen_Color
                                                                  .Colors_Text1_,
                                                          fontWeight:
                                                              FontWeight.bold,
                                                          fontFamily:
                                                              FontWeight_
                                                                  .Fonts_T,
                                                        ),
                                                      )),
                                                      Row(
                                                        children: [
                                                          Expanded(
                                                              flex: 1,
                                                              child: Text(
                                                                (Value_selectDate_daly_cus ==
                                                                        null)
                                                                    ? 'วันที่: ?'
                                                                    : 'วันที่: $Value_selectDate_daly_cus',
                                                                textAlign:
                                                                    TextAlign
                                                                        .start,
                                                                style:
                                                                    const TextStyle(
                                                                  color: ReportScreen_Color
                                                                      .Colors_Text1_,
                                                                  fontSize: 14,
                                                                  // fontWeight: FontWeight.bold,
                                                                  fontFamily:
                                                                      FontWeight_
                                                                          .Fonts_T,
                                                                ),
                                                              )),
                                                          Expanded(
                                                              flex: 1,
                                                              child: Text(
                                                                'ทั้งหมด: ${_TransReBillModels_cus.length}',
                                                                textAlign:
                                                                    TextAlign
                                                                        .end,
                                                                style:
                                                                    const TextStyle(
                                                                  fontSize: 14,
                                                                  color: ReportScreen_Color
                                                                      .Colors_Text1_,
                                                                  // fontWeight: FontWeight.bold,
                                                                  fontFamily:
                                                                      FontWeight_
                                                                          .Fonts_T,
                                                                ),
                                                              )),
                                                        ],
                                                      ),
                                                      const SizedBox(height: 1),
                                                      const Divider(),
                                                      const SizedBox(height: 1),
                                                    ],
                                                  ),
                                                  content: StreamBuilder(
                                                      stream: Stream.periodic(
                                                          const Duration(
                                                              seconds: 0)),
                                                      builder:
                                                          (context, snapshot) {
                                                        return ScrollConfiguration(
                                                          behavior: ScrollConfiguration
                                                                  .of(context)
                                                              .copyWith(
                                                                  dragDevices: {
                                                                PointerDeviceKind
                                                                    .touch,
                                                                PointerDeviceKind
                                                                    .mouse,
                                                              }),
                                                          child:
                                                              SingleChildScrollView(
                                                            scrollDirection:
                                                                Axis.horizontal,
                                                            child: Row(
                                                              children: [
                                                                Container(
                                                                  // color: Colors.grey[50],
                                                                  width: (Responsive
                                                                          .isDesktop(
                                                                              context))
                                                                      ? MediaQuery.of(context)
                                                                              .size
                                                                              .width *
                                                                          0.9
                                                                      : (_TransReBillModels_cus.length ==
                                                                              0)
                                                                          ? MediaQuery.of(context)
                                                                              .size
                                                                              .width
                                                                          : 800,
                                                                  // height:
                                                                  //     MediaQuery.of(context)
                                                                  //             .size
                                                                  //             .height *
                                                                  //         0.3,
                                                                  child: (_TransReBillModels_cus
                                                                              .length ==
                                                                          0)
                                                                      ? Column(
                                                                          mainAxisAlignment:
                                                                              MainAxisAlignment.center,
                                                                          children: const [
                                                                            Center(
                                                                              child: Text(
                                                                                'ไม่พบข้อมูล ณ วันที่เลือก',
                                                                                style: TextStyle(
                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                  fontWeight: FontWeight.bold,
                                                                                  fontFamily: FontWeight_.Fonts_T,
                                                                                ),
                                                                              ),
                                                                            ),
                                                                          ],
                                                                        )
                                                                      : Column(
                                                                          children: <
                                                                              Widget>[
                                                                            // for (int index1 = 0;
                                                                            //     index1 <
                                                                            //         _TransReBillModels
                                                                            //             .length;
                                                                            //     index1++)
                                                                            Container(
                                                                                height: MediaQuery.of(context).size.height * 0.45,
                                                                                child: ListView.builder(
                                                                                  itemCount: _TransReBillModels_cus.length,
                                                                                  itemBuilder: (BuildContext context, int index1) {
                                                                                    return ListTile(
                                                                                      title: SizedBox(
                                                                                        child: Column(
                                                                                          children: [
                                                                                            Container(
                                                                                              child: Row(
                                                                                                mainAxisAlignment: MainAxisAlignment.start,
                                                                                                children: [
                                                                                                  Container(
                                                                                                    decoration: const BoxDecoration(
                                                                                                      color: AppbackgroundColor.TiTile_Colors,
                                                                                                      borderRadius: BorderRadius.only(topLeft: Radius.circular(5), topRight: Radius.circular(5), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                    ),
                                                                                                    padding: const EdgeInsets.all(4.0),
                                                                                                    child: Text(
                                                                                                      _TransReBillModels_cus[index1].doctax == '' ? '${index1 + 1}. เลขที่: ${_TransReBillModels_cus[index1].docno}' : '${index1 + 1}. เลขที่: ${_TransReBillModels_cus[index1].doctax}',
                                                                                                      style: const TextStyle(
                                                                                                        color: ReportScreen_Color.Colors_Text1_,
                                                                                                        fontWeight: FontWeight.bold,
                                                                                                        fontFamily: FontWeight_.Fonts_T,
                                                                                                      ),
                                                                                                    ),
                                                                                                  ),
                                                                                                ],
                                                                                              ),
                                                                                            ),
                                                                                            if (show_more != index1)
                                                                                              SizedBox(
                                                                                                child: Column(
                                                                                                  children: [
                                                                                                    Container(
                                                                                                      decoration: BoxDecoration(
                                                                                                        color: AppbackgroundColor.TiTile_Colors.withOpacity(0.7),
                                                                                                        borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                      ),
                                                                                                      // padding: const EdgeInsets.all(4.0),
                                                                                                      child: Row(
                                                                                                        children: const [
                                                                                                          SizedBox(
                                                                                                            width: 20,
                                                                                                          ),
                                                                                                          // Expanded(
                                                                                                          //   flex: 1,
                                                                                                          //   child: Text(
                                                                                                          //     'รหัสพื้นที่',
                                                                                                          //     textAlign: TextAlign.center,
                                                                                                          //     style: TextStyle(
                                                                                                          //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                          //       fontWeight: FontWeight.bold,
                                                                                                          //       fontFamily: FontWeight_.Fonts_T,
                                                                                                          //     ),
                                                                                                          //   ),
                                                                                                          // ),

                                                                                                          // Expanded(
                                                                                                          //   flex: 1,
                                                                                                          //   child: Text(
                                                                                                          //     'รายการทั้งหมด',
                                                                                                          //     textAlign: TextAlign.center,
                                                                                                          //     style: TextStyle(
                                                                                                          //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                          //       fontWeight: FontWeight.bold,
                                                                                                          //       fontFamily: FontWeight_.Fonts_T,
                                                                                                          //     ),
                                                                                                          //   ),
                                                                                                          // ),
                                                                                                          // Expanded(
                                                                                                          //   flex: 1,
                                                                                                          //   child: Text(
                                                                                                          //     'รูปแบบชำระ',
                                                                                                          //     textAlign: TextAlign.center,
                                                                                                          //     style: TextStyle(
                                                                                                          //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                          //       fontWeight: FontWeight.bold,
                                                                                                          //       fontFamily: FontWeight_.Fonts_T,
                                                                                                          //     ),
                                                                                                          //   ),
                                                                                                          // ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'โซน',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'รหัสพื้นที่',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          // Expanded(
                                                                                                          //   flex: 1,
                                                                                                          //   child: Text(
                                                                                                          //     'วันที่',
                                                                                                          //     textAlign: TextAlign.center,
                                                                                                          //     style: TextStyle(
                                                                                                          //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                          //       fontWeight: FontWeight.bold,
                                                                                                          //       fontFamily: FontWeight_.Fonts_T,
                                                                                                          //     ),
                                                                                                          //   ),
                                                                                                          // ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ผู้เช่า',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ชื่อร้านค้า',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),

                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ขนาดพื้นที่ (ตร.ม.)',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          // Expanded(
                                                                                                          //   flex: 1,
                                                                                                          //   child: Text(
                                                                                                          //     'ธนาคาร',
                                                                                                          //     textAlign: TextAlign.center,
                                                                                                          //     style: TextStyle(
                                                                                                          //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                          //       fontWeight: FontWeight.bold,
                                                                                                          //       fontFamily: FontWeight_.Fonts_T,
                                                                                                          //     ),
                                                                                                          //   ),
                                                                                                          // ),

                                                                                                          // Expanded(
                                                                                                          //   flex: 1,
                                                                                                          //   child: Text(
                                                                                                          //     'รวม70%',
                                                                                                          //     textAlign: TextAlign.right,
                                                                                                          //     style: TextStyle(
                                                                                                          //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                          //       fontWeight: FontWeight.bold,
                                                                                                          //       fontFamily: FontWeight_.Fonts_T,
                                                                                                          //     ),
                                                                                                          //   ),
                                                                                                          // ),
                                                                                                          //   Expanded(
                                                                                                          //   flex: 1,
                                                                                                          //   child: Text(
                                                                                                          //     'รวม30%',
                                                                                                          //     textAlign: TextAlign.right,
                                                                                                          //     style: TextStyle(
                                                                                                          //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                          //       fontWeight: FontWeight.bold,
                                                                                                          //       fontFamily: FontWeight_.Fonts_T,
                                                                                                          //     ),
                                                                                                          //   ),
                                                                                                          // ),

                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ค่าเช่า',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'โม่',
                                                                                                              //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                              //  '${_TransReBillModels[index1].ramtd}',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ถัง',
                                                                                                              //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                              //  '${_TransReBillModels[index1].ramtd}',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'เช่าพื้นที่',
                                                                                                              //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                              //  '${_TransReBillModels[index1].ramtd}',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'ค่าไฟ',
                                                                                                              //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                              //  '${_TransReBillModels[index1].ramtd}',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              'รวม',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              '...',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                fontWeight: FontWeight.bold,
                                                                                                                fontFamily: FontWeight_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                        ],
                                                                                                      ),
                                                                                                    ),
                                                                                                    Container(
                                                                                                      decoration: BoxDecoration(
                                                                                                        color: Colors.grey[200],
                                                                                                        borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                      ),
                                                                                                      // padding: const EdgeInsets.all(4.0),
                                                                                                      child: Row(
                                                                                                        children: [
                                                                                                          const SizedBox(
                                                                                                            width: 20,
                                                                                                          ),
                                                                                                          // Expanded(
                                                                                                          //   flex: 1,
                                                                                                          //   child: Text(
                                                                                                          //     (_TransReBillModels[index1].ln == null) ? '' : '${_TransReBillModels[index1].ln}',
                                                                                                          //     // '${TransReBillModels[index1].length}',
                                                                                                          //     textAlign: TextAlign.center,
                                                                                                          //     style: const TextStyle(
                                                                                                          //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                          //       // fontWeight: FontWeight.bold,
                                                                                                          //       fontFamily: Font_.Fonts_T,
                                                                                                          //     ),
                                                                                                          //   ),
                                                                                                          // ),
                                                                                                          // Expanded(
                                                                                                          //   flex: 1,
                                                                                                          //   child: Text(
                                                                                                          //     '${nFormat2.format(double.parse(TransReBillModels[index1].length.toString()))}',
                                                                                                          //     // '${TransReBillModels[index1].length}',
                                                                                                          //     textAlign: TextAlign.center,
                                                                                                          //     style: const TextStyle(
                                                                                                          //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                          //       // fontWeight: FontWeight.bold,
                                                                                                          //       fontFamily: Font_.Fonts_T,
                                                                                                          //     ),
                                                                                                          //   ),
                                                                                                          // ),
                                                                                                          // Expanded(
                                                                                                          //   flex: 1,
                                                                                                          //   child: Text(
                                                                                                          //     '${_TransReBillModels[index1].type}',
                                                                                                          //     // '${TransReBillModels[index1].length}',
                                                                                                          //     textAlign: TextAlign.center,
                                                                                                          //     style: const TextStyle(
                                                                                                          //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                          //       // fontWeight: FontWeight.bold,
                                                                                                          //       fontFamily: Font_.Fonts_T,
                                                                                                          //     ),
                                                                                                          //   ),
                                                                                                          // ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              (_TransReBillModels_cus[index1].zn == null) ? '-' : '${_TransReBillModels_cus[index1].zn}',
                                                                                                              // '${TransReBillModels[index1].length}',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                // fontWeight: FontWeight.bold,
                                                                                                                fontFamily: Font_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              (_TransReBillModels_cus[index1].ln == null) ? '${_TransReBillModels_cus[index1].room_number}' : '${_TransReBillModels_cus[index1].ln}',
                                                                                                              // '${TransReBillModels[index1].length}',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                // fontWeight: FontWeight.bold,
                                                                                                                fontFamily: Font_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          // Expanded(
                                                                                                          //   flex: 1,
                                                                                                          //   child: Text(
                                                                                                          //     '${_TransReBillModels[index1].daterec}',
                                                                                                          //     // '${TransReBillModels[index1].length}',
                                                                                                          //     textAlign: TextAlign.center,
                                                                                                          //     style: const TextStyle(
                                                                                                          //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                          //       // fontWeight: FontWeight.bold,
                                                                                                          //       fontFamily: Font_.Fonts_T,
                                                                                                          //     ),
                                                                                                          //   ),
                                                                                                          // ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              (_TransReBillModels_cus[index1].cname == null) ? '${_TransReBillModels_cus[index1].remark}' : '${_TransReBillModels_cus[index1].cname}',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                //fontWeight: FontWeight.bold,
                                                                                                                fontFamily: Font_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              (_TransReBillModels_cus[index1].sname == null) ? '-' : '${_TransReBillModels_cus[index1].sname}',
                                                                                                              // '${TransReBillModels[index1].length}',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                // fontWeight: FontWeight.bold,
                                                                                                                fontFamily: Font_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),

                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              (_TransReBillModels_cus[index1].area == null) ? '-' : '${_TransReBillModels_cus[index1].area}',
                                                                                                              // '${TransReBillModels[index1].length}',
                                                                                                              textAlign: TextAlign.center,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                // fontWeight: FontWeight.bold,
                                                                                                                fontFamily: Font_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          // Expanded(
                                                                                                          //   flex: 1,
                                                                                                          //   child: Text(
                                                                                                          //     '${_TransReBillModels[index1].bank}',
                                                                                                          //     // '${TransReBillModels[index1].length}',
                                                                                                          //     textAlign: TextAlign.center,
                                                                                                          //     style: const TextStyle(
                                                                                                          //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                          //       // fontWeight: FontWeight.bold,
                                                                                                          //       fontFamily: Font_.Fonts_T,
                                                                                                          //     ),
                                                                                                          //   ),
                                                                                                          // ),

                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              (rent_CM_cus[index1].isEmpty) ? '0.00' : '${nFormat.format(double.parse(rent_CM_cus[index1][0]!))}',
                                                                                                              //'${rent_CM[index1][0].toString()}',
                                                                                                              //'${nFormat.format(double.parse(_TransReBillModels[index1].ramt!))}',
                                                                                                              // '${_TransReBillModels[index1].ramt}',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                // fontWeight: FontWeight.bold,
                                                                                                                fontFamily: Font_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              (MOMO_CM_cus[index1].isEmpty) ? '0.00' : '${nFormat.format(double.parse(MOMO_CM_cus[index1][0]!))}',
                                                                                                              //'${MOMO_CM[index1][0].toString()}',
                                                                                                              //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                              //  '${_TransReBillModels[index1].ramtd}',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                // fontWeight: FontWeight.bold,
                                                                                                                fontFamily: Font_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              (tank_CM_cus[index1].isEmpty) ? '0.00' : '${nFormat.format(double.parse(tank_CM_cus[index1][0]!))}',
                                                                                                              // '${tank_CM[index1][0].toString()}',
                                                                                                              // '${tank_CM[index1]}',
                                                                                                              //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                              //  '${_TransReBillModels[index1].ramtd}',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                // fontWeight: FontWeight.bold,
                                                                                                                fontFamily: Font_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              (rent_area_CM_cus[index1].isEmpty) ? '0.00' : '${nFormat.format(double.parse(rent_area_CM_cus[index1][0]!))}',
                                                                                                              //'${rent_area_CM[index1][0].toString()}',
                                                                                                              //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                              //  '${_TransReBillModels[index1].ramtd}',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                // fontWeight: FontWeight.bold,
                                                                                                                fontFamily: Font_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              (electricity_CM_cus[index1].isEmpty) ? '0.00' : '${nFormat.format(double.parse(electricity_CM_cus[index1][0]!))}',
                                                                                                              //'${electricity_CM[index1][0].toString()}',
                                                                                                              //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                              //  '${_TransReBillModels[index1].ramtd}',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                // fontWeight: FontWeight.bold,
                                                                                                                fontFamily: Font_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Text(
                                                                                                              '${nFormat.format(double.parse(_TransReBillModels_cus[index1].total_bill!))}',
                                                                                                              // '${_TransReBillModels[index1].total_bill}',
                                                                                                              textAlign: TextAlign.right,
                                                                                                              style: const TextStyle(
                                                                                                                color: ReportScreen_Color.Colors_Text1_,
                                                                                                                // fontWeight: FontWeight.bold,
                                                                                                                fontFamily: Font_.Fonts_T,
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                          Expanded(
                                                                                                            flex: 1,
                                                                                                            child: Padding(
                                                                                                              padding: const EdgeInsets.all(8.0),
                                                                                                              child: Row(
                                                                                                                mainAxisAlignment: MainAxisAlignment.center,
                                                                                                                children: [
                                                                                                                  InkWell(
                                                                                                                    onTap: () {
                                                                                                                      setState(() {
                                                                                                                        show_more = index1;
                                                                                                                      });
                                                                                                                    },
                                                                                                                    child: Container(
                                                                                                                      width: 100,
                                                                                                                      decoration: BoxDecoration(
                                                                                                                        color: Colors.green[300],
                                                                                                                        borderRadius: const BorderRadius.only(topLeft: Radius.circular(10), topRight: Radius.circular(10), bottomLeft: Radius.circular(10), bottomRight: Radius.circular(10)),
                                                                                                                      ),
                                                                                                                      padding: const EdgeInsets.all(4.0),
                                                                                                                      child: const Center(
                                                                                                                        child: Text(
                                                                                                                          'ดูเพิ่มเติม',
                                                                                                                          style: TextStyle(
                                                                                                                            color: ReportScreen_Color.Colors_Text1_,
                                                                                                                            // fontWeight: FontWeight.bold,
                                                                                                                            fontFamily: Font_.Fonts_T,
                                                                                                                          ),
                                                                                                                        ),
                                                                                                                      ),
                                                                                                                    ),
                                                                                                                  ),
                                                                                                                ],
                                                                                                              ),
                                                                                                            ),
                                                                                                          ),
                                                                                                        ],
                                                                                                      ),
                                                                                                    ),
                                                                                                  ],
                                                                                                ),
                                                                                              ),
                                                                                            if (show_more == index1)
                                                                                              SizedBox(
                                                                                                child: Column(
                                                                                                  children: [
                                                                                                    Stack(
                                                                                                      children: [
                                                                                                        Container(
                                                                                                          decoration: BoxDecoration(
                                                                                                            color: AppbackgroundColor.TiTile_Colors.withOpacity(0.7),
                                                                                                            borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                                          ),
                                                                                                          padding: const EdgeInsets.all(4.0),
                                                                                                          child: Row(
                                                                                                            children: const [
                                                                                                              Expanded(
                                                                                                                flex: 1,
                                                                                                                child: Text(
                                                                                                                  'ลำดับ',
                                                                                                                  style: TextStyle(
                                                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                                                    fontWeight: FontWeight.bold,
                                                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                                                  ),
                                                                                                                ),
                                                                                                              ),
                                                                                                              // Expanded(
                                                                                                              //   flex: 1,
                                                                                                              //   child: Text(
                                                                                                              //     'กำหนดชำระ',
                                                                                                              //     style: TextStyle(
                                                                                                              //       color: ReportScreen_Color.Colors_Text1_,
                                                                                                              //       fontWeight: FontWeight.bold,
                                                                                                              //       fontFamily: FontWeight_.Fonts_T,
                                                                                                              //     ),
                                                                                                              //   ),
                                                                                                              // ),
                                                                                                              Expanded(
                                                                                                                flex: 1,
                                                                                                                child: Text(
                                                                                                                  'รายการ',
                                                                                                                  textAlign: TextAlign.center,
                                                                                                                  style: TextStyle(
                                                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                                                    fontWeight: FontWeight.bold,
                                                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                                                  ),
                                                                                                                ),
                                                                                                              ),
                                                                                                              Expanded(
                                                                                                                flex: 1,
                                                                                                                child: Text(
                                                                                                                  'Vat%',
                                                                                                                  textAlign: TextAlign.right,
                                                                                                                  style: TextStyle(
                                                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                                                    fontWeight: FontWeight.bold,
                                                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                                                  ),
                                                                                                                ),
                                                                                                              ),
                                                                                                              Expanded(
                                                                                                                flex: 1,
                                                                                                                child: Text(
                                                                                                                  'หน่วย',
                                                                                                                  textAlign: TextAlign.right,
                                                                                                                  style: TextStyle(
                                                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                                                    fontWeight: FontWeight.bold,
                                                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                                                  ),
                                                                                                                ),
                                                                                                              ),
                                                                                                              Expanded(
                                                                                                                flex: 1,
                                                                                                                child: Text(
                                                                                                                  'VAT',
                                                                                                                  textAlign: TextAlign.right,
                                                                                                                  style: TextStyle(
                                                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                                                    fontWeight: FontWeight.bold,
                                                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                                                  ),
                                                                                                                ),
                                                                                                              ),
                                                                                                              Expanded(
                                                                                                                flex: 1,
                                                                                                                child: Text(
                                                                                                                  '70 %',
                                                                                                                  textAlign: TextAlign.right,
                                                                                                                  style: TextStyle(
                                                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                                                    fontWeight: FontWeight.bold,
                                                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                                                  ),
                                                                                                                ),
                                                                                                              ),
                                                                                                              Expanded(
                                                                                                                flex: 1,
                                                                                                                child: Text(
                                                                                                                  '30 %',
                                                                                                                  textAlign: TextAlign.right,
                                                                                                                  style: TextStyle(
                                                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                                                    fontWeight: FontWeight.bold,
                                                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                                                  ),
                                                                                                                ),
                                                                                                              ),
                                                                                                              Expanded(
                                                                                                                flex: 1,
                                                                                                                child: Text(
                                                                                                                  'ราคาก่อน Vat',
                                                                                                                  textAlign: TextAlign.right,
                                                                                                                  style: TextStyle(
                                                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                                                    fontWeight: FontWeight.bold,
                                                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                                                  ),
                                                                                                                ),
                                                                                                              ),
                                                                                                              Expanded(
                                                                                                                flex: 1,
                                                                                                                child: Text(
                                                                                                                  'ราคารวม Vat',
                                                                                                                  textAlign: TextAlign.center,
                                                                                                                  style: TextStyle(
                                                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                                                    fontWeight: FontWeight.bold,
                                                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                                                  ),
                                                                                                                ),
                                                                                                              ),
                                                                                                            ],
                                                                                                          ),
                                                                                                        ),
                                                                                                        Positioned(
                                                                                                            top: 0,
                                                                                                            right: 2,
                                                                                                            child: InkWell(
                                                                                                              onTap: () {
                                                                                                                setState(() {
                                                                                                                  show_more = null;
                                                                                                                });
                                                                                                              },
                                                                                                              child: const Icon(
                                                                                                                Icons.cancel,
                                                                                                                color: Colors.red,
                                                                                                              ),
                                                                                                            ))
                                                                                                      ],
                                                                                                    ),
                                                                                                    for (int index2 = 0; index2 < TransReBillModels_cus[index1].length; index2++)
                                                                                                      Container(
                                                                                                        color: Colors.green[100]!.withOpacity(0.5), padding: const EdgeInsets.fromLTRB(5, 0, 5, 0),
                                                                                                        // padding: const EdgeInsets.all(4.0),
                                                                                                        child: Column(
                                                                                                          children: [
                                                                                                            Row(
                                                                                                              children: [
                                                                                                                Expanded(
                                                                                                                  flex: 1,
                                                                                                                  child: Text(
                                                                                                                    '${index1 + 1}.${index2 + 1}',
                                                                                                                    style: const TextStyle(
                                                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                                                      // fontWeight:
                                                                                                                      //     FontWeight.bold,
                                                                                                                      fontFamily: Font_.Fonts_T,
                                                                                                                    ),
                                                                                                                  ),
                                                                                                                ),
                                                                                                                // Expanded(
                                                                                                                //   flex: 1,
                                                                                                                //   child: Text(
                                                                                                                //     '${TransReBillModels[index1][index2].date}',
                                                                                                                //     style: const TextStyle(
                                                                                                                //       color: ReportScreen_Color.Colors_Text2_,
                                                                                                                //       // fontWeight:
                                                                                                                //       //     FontWeight.bold,
                                                                                                                //       fontFamily: Font_.Fonts_T,
                                                                                                                //     ),
                                                                                                                //   ),
                                                                                                                // ),
                                                                                                                Expanded(
                                                                                                                  flex: 1,
                                                                                                                  child: Text(
                                                                                                                    '${TransReBillModels_cus[index1][index2].expname}',
                                                                                                                    textAlign: TextAlign.center,
                                                                                                                    style: const TextStyle(
                                                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                                                      // fontWeight:
                                                                                                                      //     FontWeight.bold,
                                                                                                                      fontFamily: Font_.Fonts_T,
                                                                                                                    ),
                                                                                                                  ),
                                                                                                                ),
                                                                                                                Expanded(
                                                                                                                  flex: 1,
                                                                                                                  child: Text(
                                                                                                                    '${TransReBillModels_cus[index1][index2].total_sumnvat}',
                                                                                                                    textAlign: TextAlign.right,
                                                                                                                    style: const TextStyle(
                                                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                                                      // fontWeight:
                                                                                                                      //     FontWeight.bold,
                                                                                                                      fontFamily: Font_.Fonts_T,
                                                                                                                    ),
                                                                                                                  ),
                                                                                                                ),
                                                                                                                Expanded(
                                                                                                                  flex: 1,
                                                                                                                  child: Text(
                                                                                                                    '${TransReBillModels_cus[index1][index2].vtype}',
                                                                                                                    textAlign: TextAlign.right,
                                                                                                                    style: const TextStyle(
                                                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                                                      // fontWeight:
                                                                                                                      //     FontWeight.bold,
                                                                                                                      fontFamily: Font_.Fonts_T,
                                                                                                                    ),
                                                                                                                  ),
                                                                                                                ),
                                                                                                                Expanded(
                                                                                                                  flex: 1,
                                                                                                                  child: Text(
                                                                                                                    '${nFormat.format(double.parse(TransReBillModels_cus[index1][index2].total_sumvat!))}',
                                                                                                                    textAlign: TextAlign.right,
                                                                                                                    style: const TextStyle(
                                                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                                                      // fontWeight:
                                                                                                                      //     FontWeight.bold,
                                                                                                                      fontFamily: Font_.Fonts_T,
                                                                                                                    ),
                                                                                                                  ),
                                                                                                                ),
                                                                                                                Expanded(
                                                                                                                  flex: 1,
                                                                                                                  child: Text(
                                                                                                                    (TransReBillModels_cus[index1][index2].total_sumramt.toString() == 'null') ? '-' : '${nFormat.format(double.parse(TransReBillModels_cus[index1][index2].total_sumramt!))}',
                                                                                                                    textAlign: TextAlign.right,
                                                                                                                    style: const TextStyle(
                                                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                                                      // fontWeight:
                                                                                                                      //     FontWeight.bold,
                                                                                                                      fontFamily: Font_.Fonts_T,
                                                                                                                    ),
                                                                                                                  ),
                                                                                                                ),
                                                                                                                Expanded(
                                                                                                                  flex: 1,
                                                                                                                  child: Text(
                                                                                                                    (TransReBillModels_cus[index1][index2].total_sumramtd.toString() == 'null') ? '-' : '${nFormat.format(double.parse(TransReBillModels_cus[index1][index2].total_sumramtd!))}',
                                                                                                                    textAlign: TextAlign.right,
                                                                                                                    style: const TextStyle(
                                                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                                                      // fontWeight:
                                                                                                                      //     FontWeight.bold,
                                                                                                                      fontFamily: Font_.Fonts_T,
                                                                                                                    ),
                                                                                                                  ),
                                                                                                                ),
                                                                                                                Expanded(
                                                                                                                  flex: 1,
                                                                                                                  child: Text(
                                                                                                                    '${nFormat.format(double.parse(TransReBillModels_cus[index1][index2].total_sumamt!))}',
                                                                                                                    textAlign: TextAlign.right,
                                                                                                                    style: const TextStyle(
                                                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                                                      // fontWeight:
                                                                                                                      //     FontWeight.bold,
                                                                                                                      fontFamily: Font_.Fonts_T,
                                                                                                                    ),
                                                                                                                  ),
                                                                                                                ),
                                                                                                                Expanded(
                                                                                                                  flex: 1,
                                                                                                                  child: Text(
                                                                                                                    '${nFormat.format(double.parse(TransReBillModels_cus[index1][index2].total_sum!))}',
                                                                                                                    textAlign: TextAlign.right,
                                                                                                                    style: const TextStyle(
                                                                                                                      color: ReportScreen_Color.Colors_Text2_,
                                                                                                                      // fontWeight:
                                                                                                                      //     FontWeight.bold,
                                                                                                                      fontFamily: Font_.Fonts_T,
                                                                                                                    ),
                                                                                                                  ),
                                                                                                                ),
                                                                                                                // Expanded(
                                                                                                                //   flex: 1,
                                                                                                                //   child: Text(
                                                                                                                //     (TransReBillModels[index1][index2].sname == null) ? '' : '**${TransReBillModels[index1][index2].sname!}',
                                                                                                                //     style: const TextStyle(
                                                                                                                //       color: ReportScreen_Color.Colors_Text2_,
                                                                                                                //       // fontWeight:
                                                                                                                //       //     FontWeight.bold,
                                                                                                                //       fontFamily: Font_.Fonts_T,
                                                                                                                //     ),
                                                                                                                //   ),
                                                                                                                // ),
                                                                                                              ],
                                                                                                            ),
                                                                                                            const SizedBox(
                                                                                                              height: 10,
                                                                                                            )
                                                                                                          ],
                                                                                                        ),
                                                                                                      ),
                                                                                                  ],
                                                                                                ),
                                                                                              ),
                                                                                          ],
                                                                                        ),
                                                                                      ),
                                                                                    );
                                                                                  },
                                                                                )),
                                                                          ],
                                                                        ),
                                                                ),
                                                              ],
                                                            ),
                                                          ),
                                                        );
                                                      }),
                                                  actions: <Widget>[
                                                    StreamBuilder(
                                                        stream: Stream.periodic(
                                                            const Duration(
                                                                seconds: 0)),
                                                        builder: (context,
                                                            snapshot) {
                                                          return Padding(
                                                            padding:
                                                                const EdgeInsets
                                                                        .fromLTRB(
                                                                    8,
                                                                    0,
                                                                    20,
                                                                    4),
                                                            child: Row(
                                                              mainAxisAlignment:
                                                                  MainAxisAlignment
                                                                      .end,
                                                              children: [
                                                                SizedBox(
                                                                  height: 120,
                                                                  width: 240,
                                                                  child: Column(
                                                                    children: [
                                                                      Row(
                                                                        children: [
                                                                          Expanded(
                                                                              child: Container(
                                                                            decoration:
                                                                                const BoxDecoration(
                                                                              color: AppbackgroundColor.TiTile_Colors,
                                                                              borderRadius: BorderRadius.only(topLeft: Radius.circular(5), topRight: Radius.circular(5), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                            ),
                                                                            child:
                                                                                const Center(
                                                                              child: Text(
                                                                                'รวม',
                                                                                maxLines: 1,
                                                                                textAlign: TextAlign.start,
                                                                                style: TextStyle(
                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                  fontWeight: FontWeight.bold,
                                                                                  fontFamily: FontWeight_.Fonts_T,
                                                                                ),
                                                                              ),
                                                                            ),
                                                                          ))
                                                                        ],
                                                                      ),
                                                                      Row(
                                                                        children: [
                                                                          Expanded(
                                                                            flex:
                                                                                1,
                                                                            child: Container(
                                                                                decoration: BoxDecoration(
                                                                                  color: Colors.grey[300],
                                                                                  borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                ),
                                                                                child: const Text(
                                                                                  'รวม 70%',
                                                                                  maxLines: 1,
                                                                                  textAlign: TextAlign.start,
                                                                                  style: TextStyle(
                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                    fontWeight: FontWeight.bold,
                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                  ),
                                                                                )),
                                                                          ),
                                                                          Expanded(
                                                                            flex:
                                                                                1,
                                                                            child: Container(
                                                                                color: Colors.grey[200],
                                                                                child: Text(
                                                                                  '${nFormat.format(Sum_Ramt_)}',
                                                                                  maxLines: 1,
                                                                                  textAlign: TextAlign.end,
                                                                                  style: const TextStyle(
                                                                                    color: ReportScreen_Color.Colors_Text2_,
                                                                                    fontWeight: FontWeight.bold,
                                                                                    fontFamily: Font_.Fonts_T,
                                                                                  ),
                                                                                )),
                                                                          ),
                                                                        ],
                                                                      ),
                                                                      Row(
                                                                        children: [
                                                                          Expanded(
                                                                            flex:
                                                                                1,
                                                                            child: Container(
                                                                                decoration: BoxDecoration(
                                                                                  color: Colors.grey[300],
                                                                                  borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                ),
                                                                                child: const Text(
                                                                                  'รวม 30%',
                                                                                  maxLines: 1,
                                                                                  textAlign: TextAlign.start,
                                                                                  style: TextStyle(
                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                    fontWeight: FontWeight.bold,
                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                  ),
                                                                                )),
                                                                          ),
                                                                          Expanded(
                                                                            flex:
                                                                                1,
                                                                            child: Container(
                                                                                color: Colors.grey[200],
                                                                                child: Text(
                                                                                  '${nFormat.format(Sum_Ramtd_)}',
                                                                                  maxLines: 1,
                                                                                  textAlign: TextAlign.end,
                                                                                  style: const TextStyle(
                                                                                    color: ReportScreen_Color.Colors_Text2_,
                                                                                    fontWeight: FontWeight.bold,
                                                                                    fontFamily: Font_.Fonts_T,
                                                                                  ),
                                                                                )),
                                                                          ),
                                                                        ],
                                                                      ),
                                                                      // Row(
                                                                      //   children: [
                                                                      //     Expanded(
                                                                      //       flex: 1,
                                                                      //       child: Container(
                                                                      //           decoration:
                                                                      //               BoxDecoration(
                                                                      //             color: Colors
                                                                      //                     .grey[
                                                                      //                 300],
                                                                      //             borderRadius: const BorderRadius
                                                                      //                     .only(
                                                                      //                 topLeft:
                                                                      //                     Radius.circular(
                                                                      //                         0),
                                                                      //                 topRight:
                                                                      //                     Radius.circular(
                                                                      //                         0),
                                                                      //                 bottomLeft:
                                                                      //                     Radius.circular(
                                                                      //                         0),
                                                                      //                 bottomRight:
                                                                      //                     Radius.circular(0)),
                                                                      //           ),
                                                                      //           child:
                                                                      //               const Text(
                                                                      //             'รวมราคาก่อน Vat',
                                                                      //             maxLines: 1,
                                                                      //             textAlign:
                                                                      //                 TextAlign
                                                                      //                     .start,
                                                                      //             style:
                                                                      //                 TextStyle(
                                                                      //               color: ReportScreen_Color
                                                                      //                   .Colors_Text1_,
                                                                      //               fontWeight:
                                                                      //                   FontWeight
                                                                      //                       .bold,
                                                                      //               fontFamily:
                                                                      //                   FontWeight_
                                                                      //                       .Fonts_T,
                                                                      //             ),
                                                                      //           )),
                                                                      //     ),
                                                                      //     Expanded(
                                                                      //       flex: 1,
                                                                      //       child: Container(
                                                                      //           color: Colors
                                                                      //                   .grey[
                                                                      //               200],
                                                                      //           child: Text(
                                                                      //             '${nFormat.format(Sum_Amt_)}',
                                                                      //             maxLines: 1,
                                                                      //             textAlign:
                                                                      //                 TextAlign
                                                                      //                     .end,
                                                                      //             style:
                                                                      //                 const TextStyle(
                                                                      //               color: ReportScreen_Color
                                                                      //                   .Colors_Text2_,
                                                                      //               fontWeight:
                                                                      //                   FontWeight
                                                                      //                       .bold,
                                                                      //               fontFamily:
                                                                      //                   Font_
                                                                      //                       .Fonts_T,
                                                                      //             ),
                                                                      //           )),
                                                                      //     ),
                                                                      //   ],
                                                                      // ),
                                                                      Row(
                                                                        children: [
                                                                          Expanded(
                                                                            flex:
                                                                                1,
                                                                            child: Container(
                                                                                decoration: BoxDecoration(
                                                                                  color: Colors.grey[300],
                                                                                  borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                ),
                                                                                child: const Text(
                                                                                  'รวม',
                                                                                  maxLines: 1,
                                                                                  textAlign: TextAlign.start,
                                                                                  style: TextStyle(
                                                                                    color: ReportScreen_Color.Colors_Text1_,
                                                                                    fontWeight: FontWeight.bold,
                                                                                    fontFamily: FontWeight_.Fonts_T,
                                                                                  ),
                                                                                )),
                                                                          ),
                                                                          Expanded(
                                                                            flex:
                                                                                1,
                                                                            child: Container(
                                                                                color: Colors.grey[200],
                                                                                child: Text(
                                                                                  '${nFormat.format(Sum_Total_)}',
                                                                                  maxLines: 1,
                                                                                  textAlign: TextAlign.end,
                                                                                  style: const TextStyle(
                                                                                    color: ReportScreen_Color.Colors_Text2_,
                                                                                    fontWeight: FontWeight.bold,
                                                                                    fontFamily: Font_.Fonts_T,
                                                                                  ),
                                                                                )),
                                                                          ),
                                                                        ],
                                                                      ),
                                                                    ],
                                                                  ),
                                                                )
                                                              ],
                                                            ),
                                                          );
                                                        }),
                                                    const SizedBox(height: 1),
                                                    const Divider(),
                                                    const SizedBox(height: 1),
                                                    Padding(
                                                      padding: const EdgeInsets
                                                          .fromLTRB(8, 4, 8, 4),
                                                      child:
                                                          SingleChildScrollView(
                                                        scrollDirection:
                                                            Axis.horizontal,
                                                        child: Row(
                                                          mainAxisAlignment:
                                                              MainAxisAlignment
                                                                  .end,
                                                          children: [
                                                            if (_TransReBillModels_cus
                                                                    .length !=
                                                                0)
                                                              Padding(
                                                                padding:
                                                                    const EdgeInsets
                                                                            .all(
                                                                        8.0),
                                                                child: InkWell(
                                                                  child:
                                                                      Container(
                                                                    width: 100,
                                                                    decoration:
                                                                        const BoxDecoration(
                                                                      color: Colors
                                                                          .blue,
                                                                      borderRadius: BorderRadius.only(
                                                                          topLeft: Radius.circular(
                                                                              10),
                                                                          topRight: Radius.circular(
                                                                              10),
                                                                          bottomLeft: Radius.circular(
                                                                              10),
                                                                          bottomRight:
                                                                              Radius.circular(10)),
                                                                    ),
                                                                    padding:
                                                                        const EdgeInsets.all(
                                                                            8.0),
                                                                    child:
                                                                        const Center(
                                                                      child:
                                                                          Text(
                                                                        'Export file',
                                                                        style:
                                                                            TextStyle(
                                                                          color:
                                                                              Colors.white,
                                                                          fontWeight:
                                                                              FontWeight.bold,
                                                                          fontFamily:
                                                                              Font_.Fonts_T,
                                                                        ),
                                                                      ),
                                                                    ),
                                                                  ),
                                                                  onTap: () {
                                                                    if (_TransReBillModels_cus
                                                                            .length ==
                                                                        0) {
                                                                    } else {
                                                                      setState(
                                                                          () {
                                                                        show_more =
                                                                            null;
                                                                        Value_Report =
                                                                            'รายงานประจำวันรายบุคคล';
                                                                        Pre_and_Dow =
                                                                            'Download';
                                                                      });
                                                                      // Navigator.of(
                                                                      //         context)
                                                                      //     .pop();
                                                                      _showMyDialog_SAVE();
                                                                    }
                                                                  },
                                                                ),
                                                              ),
                                                            // if (_TransReBillModels
                                                            //         .length !=
                                                            //     0)
                                                            //   Padding(
                                                            //     padding:
                                                            //         const EdgeInsets
                                                            //             .all(8.0),
                                                            //     child: InkWell(
                                                            //       child: Container(
                                                            //         width: 100,
                                                            //         decoration:
                                                            //             const BoxDecoration(
                                                            //           color: Colors
                                                            //               .green,
                                                            //           borderRadius: BorderRadius.only(
                                                            //               topLeft:
                                                            //                   Radius.circular(
                                                            //                       10),
                                                            //               topRight:
                                                            //                   Radius.circular(
                                                            //                       10),
                                                            //               bottomLeft:
                                                            //                   Radius.circular(
                                                            //                       10),
                                                            //               bottomRight:
                                                            //                   Radius.circular(
                                                            //                       10)),
                                                            //         ),
                                                            //         padding:
                                                            //             const EdgeInsets
                                                            //                     .all(
                                                            //                 8.0),
                                                            //         child:
                                                            //             const Center(
                                                            //           child: Text(
                                                            //             'Print',
                                                            //             style:
                                                            //                 TextStyle(
                                                            //               color: Colors
                                                            //                   .white,
                                                            //               fontWeight:
                                                            //                   FontWeight
                                                            //                       .bold,
                                                            //               fontFamily:
                                                            //                   Font_
                                                            //                       .Fonts_T,
                                                            //             ),
                                                            //           ),
                                                            //         ),
                                                            //       ),
                                                            //       onTap: () async {
                                                            //         if (_TransReBillModels
                                                            //                 .length ==
                                                            //             0) {
                                                            //         } else {
                                                            //           setState(() {
                                                            //             show_more =
                                                            //                 null;
                                                            //             Value_Report =
                                                            //                 'รายงานประจำวัน';
                                                            //             Pre_and_Dow =
                                                            //                 'Preview';
                                                            //           });
                                                            //           // Navigator.pop(context);
                                                            //           _displayPdf_();
                                                            //         }
                                                            //       },
                                                            //     ),
                                                            //   ),
                                                            Padding(
                                                              padding:
                                                                  const EdgeInsets
                                                                      .all(8.0),
                                                              child: InkWell(
                                                                child:
                                                                    Container(
                                                                  width: 100,
                                                                  decoration:
                                                                      const BoxDecoration(
                                                                    color: Colors
                                                                        .black,
                                                                    borderRadius: BorderRadius.only(
                                                                        topLeft:
                                                                            Radius.circular(
                                                                                10),
                                                                        topRight:
                                                                            Radius.circular(
                                                                                10),
                                                                        bottomLeft:
                                                                            Radius.circular(
                                                                                10),
                                                                        bottomRight:
                                                                            Radius.circular(10)),
                                                                  ),
                                                                  padding:
                                                                      const EdgeInsets
                                                                              .all(
                                                                          8.0),
                                                                  child:
                                                                      const Center(
                                                                    child: Text(
                                                                      'ปิด',
                                                                      style:
                                                                          TextStyle(
                                                                        color: Colors
                                                                            .white,
                                                                        fontWeight:
                                                                            FontWeight.bold,
                                                                        fontFamily:
                                                                            Font_.Fonts_T,
                                                                      ),
                                                                    ),
                                                                  ),
                                                                ),
                                                                onTap: () {
                                                                  setState(() {
                                                                    show_more =
                                                                        null;
                                                                  });
                                                                  Navigator.of(
                                                                          context)
                                                                      .pop();
                                                                },
                                                              ),
                                                            ),
                                                          ],
                                                        ),
                                                      ),
                                                    ),
                                                  ],
                                                );
                                              },
                                            );
                                          },
                          ),
                          // const Padding(
                          //   padding: EdgeInsets.all(8.0),
                          //   child: Text(
                          //     'รายงานประจำวัน',
                          //     style: TextStyle(
                          //       color: ReportScreen_Color.Colors_Text2_,
                          //       // fontWeight: FontWeight.bold,
                          //       fontFamily: Font_.Fonts_T,
                          //     ),
                          //   ),
                          // ),
                          (_TransReBillModels_cus.isEmpty ||
                                  Value_selectDate_daly_cus == null)
                              ? Padding(
                                  padding: const EdgeInsets.all(8.0),
                                  child: Text(
                                    (Value_selectDate_daly_cus != null &&
                                            TransReBillModels_cus.isEmpty &&
                                            Value_selectDate_daly_cus != null)
                                        ? 'รายงานประจำวันรายบุคคล (ไม่พบข้อมูล ✖️)'
                                        : 'รายงานประจำวันรายบุคคล',
                                    style: const TextStyle(
                                      color: ReportScreen_Color.Colors_Text2_,
                                      // fontWeight: FontWeight.bold,
                                      fontFamily: Font_.Fonts_T,
                                    ),
                                  ),
                                )
                              : (TransReBillModels_cus[
                                          _TransReBillModels_cus.length - 1]
                                      .isEmpty)
                                  ? SizedBox(
                                      // height: 20,
                                      child: Row(
                                      children: [
                                        Container(
                                            padding: const EdgeInsets.all(4.0),
                                            child:
                                                const CircularProgressIndicator()),
                                        const Padding(
                                          padding: EdgeInsets.all(8.0),
                                          child: Text(
                                            'กำลังโหลดรายงานประจำวันรายบุคคล...',
                                            style: TextStyle(
                                              color: ReportScreen_Color
                                                  .Colors_Text2_,
                                              // fontWeight: FontWeight.bold,
                                              fontFamily: Font_.Fonts_T,
                                            ),
                                          ),
                                        ),
                                      ],
                                    ))
                                  : const Padding(
                                      padding: EdgeInsets.all(8.0),
                                      child: Text(
                                        'รายงานประจำวันรายบุคคล ✔️',
                                        style: TextStyle(
                                          color:
                                              ReportScreen_Color.Colors_Text2_,
                                          // fontWeight: FontWeight.bold,
                                          fontFamily: Font_.Fonts_T,
                                        ),
                                      ),
                                    ),
                        ],
                      ),
                    ),

//////////////////////////////////----------------------------------------->(รายงานผู้เช่า)
                    const SizedBox(
                      height: 5.0,
                    ),
                    Row(
                      children: [
                        Container(
                          width: MediaQuery.of(context).size.width / 2,
                          height: 4.0,
                          child: Divider(
                            color: Colors.grey[300],
                            height: 4.0,
                          ),
                        ),
                      ],
                    ),
                    const SizedBox(
                      height: 5.0,
                    ),
                    Row(
                      children: [
                        const Padding(
                          padding: EdgeInsets.all(8.0),
                          child: Text(
                            'เดือน :',
                            style: TextStyle(
                              color: ReportScreen_Color.Colors_Text2_,
                              // fontWeight: FontWeight.bold,
                              fontFamily: Font_.Fonts_T,
                            ),
                          ),
                        ),
                        Padding(
                          padding: const EdgeInsets.all(8.0),
                          child: Container(
                            decoration: const BoxDecoration(
                              color: AppbackgroundColor.Sub_Abg_Colors,
                              borderRadius: BorderRadius.only(
                                  topLeft: Radius.circular(10),
                                  topRight: Radius.circular(10),
                                  bottomLeft: Radius.circular(10),
                                  bottomRight: Radius.circular(10)),
                              // border: Border.all(color: Colors.grey, width: 1),
                            ),
                            width: 120,
                            padding: const EdgeInsets.all(8.0),
                            child: DropdownButtonFormField2(
                              alignment: Alignment.center,
                              focusColor: Colors.white,
                              autofocus: false,
                              decoration: InputDecoration(
                                enabled: true,
                                hoverColor: Colors.brown,
                                prefixIconColor: Colors.blue,
                                fillColor: Colors.white.withOpacity(0.05),
                                filled: false,
                                isDense: true,
                                contentPadding: EdgeInsets.zero,
                                border: OutlineInputBorder(
                                  borderSide:
                                      const BorderSide(color: Colors.red),
                                  borderRadius: BorderRadius.circular(10),
                                ),
                                focusedBorder: const OutlineInputBorder(
                                  borderRadius: BorderRadius.only(
                                    topRight: Radius.circular(10),
                                    topLeft: Radius.circular(10),
                                    bottomRight: Radius.circular(10),
                                    bottomLeft: Radius.circular(10),
                                  ),
                                  borderSide: BorderSide(
                                    width: 1,
                                    color: Color.fromARGB(255, 231, 227, 227),
                                  ),
                                ),
                              ),
                              isExpanded: false,
                              hint: Text(
                                Mon_ == null ? 'เลือก' : '$Mon_',
                                maxLines: 2,
                                textAlign: TextAlign.center,
                                style: const TextStyle(
                                  overflow: TextOverflow.ellipsis,
                                  fontSize: 14,
                                  color: Colors.grey,
                                ),
                              ),
                              icon: const Icon(
                                Icons.arrow_drop_down,
                                color: Colors.black,
                              ),
                              style: const TextStyle(
                                color: Colors.grey,
                              ),
                              iconSize: 20,
                              buttonHeight: 40,
                              buttonWidth: 200,
                              // buttonPadding: const EdgeInsets.only(left: 20, right: 10),
                              dropdownDecoration: BoxDecoration(
                                // color: Colors
                                //     .amber,
                                borderRadius: BorderRadius.circular(10),
                                border:
                                    Border.all(color: Colors.white, width: 1),
                              ),
                              items: Mont_Th.map(
                                  (item) => DropdownMenuItem<String>(
                                        value: '${item}',
                                        child: Text(
                                          '${item}',
                                          textAlign: TextAlign.center,
                                          style: const TextStyle(
                                            overflow: TextOverflow.ellipsis,
                                            fontSize: 14,
                                            color: Colors.grey,
                                          ),
                                        ),
                                      )).toList(),

                              onChanged: (value) async {
                                setState(() {
                                  Mon_ = value;
                                });
                                if (YE_ == null) {
                                } else {
                                  GC_coutumer();
                                }
                                // read_GC_rentalAll();
                              },
                            ),
                          ),
                        ),
                        const Padding(
                          padding: EdgeInsets.all(8.0),
                          child: Text(
                            'ปี :',
                            style: TextStyle(
                              color: ReportScreen_Color.Colors_Text2_,
                              // fontWeight: FontWeight.bold,
                              fontFamily: Font_.Fonts_T,
                            ),
                          ),
                        ),
                        Padding(
                          padding: const EdgeInsets.all(8.0),
                          child: Container(
                            decoration: const BoxDecoration(
                              color: AppbackgroundColor.Sub_Abg_Colors,
                              borderRadius: BorderRadius.only(
                                  topLeft: Radius.circular(10),
                                  topRight: Radius.circular(10),
                                  bottomLeft: Radius.circular(10),
                                  bottomRight: Radius.circular(10)),
                              // border: Border.all(color: Colors.grey, width: 1),
                            ),
                            width: 120,
                            padding: const EdgeInsets.all(8.0),
                            child: DropdownButtonFormField2(
                              alignment: Alignment.center,
                              focusColor: Colors.white,
                              autofocus: false,
                              decoration: InputDecoration(
                                floatingLabelAlignment:
                                    FloatingLabelAlignment.center,
                                enabled: true,
                                hoverColor: Colors.brown,
                                prefixIconColor: Colors.blue,
                                fillColor: Colors.white.withOpacity(0.05),
                                filled: false,
                                isDense: true,
                                contentPadding: EdgeInsets.zero,
                                border: OutlineInputBorder(
                                  borderSide:
                                      const BorderSide(color: Colors.red),
                                  borderRadius: BorderRadius.circular(10),
                                ),
                                focusedBorder: const OutlineInputBorder(
                                  borderRadius: BorderRadius.only(
                                    topRight: Radius.circular(10),
                                    topLeft: Radius.circular(10),
                                    bottomRight: Radius.circular(10),
                                    bottomLeft: Radius.circular(10),
                                  ),
                                  borderSide: BorderSide(
                                    width: 1,
                                    color: Color.fromARGB(255, 231, 227, 227),
                                  ),
                                ),
                              ),
                              isExpanded: false,
                              hint: Text(
                                YE_ == null ? 'เลือก' : '$YE_',
                                maxLines: 2,
                                textAlign: TextAlign.center,
                                style: const TextStyle(
                                  overflow: TextOverflow.ellipsis,
                                  fontSize: 14,
                                  color: Colors.grey,
                                ),
                              ),
                              icon: const Icon(
                                Icons.arrow_drop_down,
                                color: Colors.black,
                              ),
                              style: const TextStyle(
                                color: Colors.grey,
                              ),
                              iconSize: 20,
                              buttonHeight: 40,
                              buttonWidth: 200,
                              // buttonPadding: const EdgeInsets.only(left: 20, right: 10),
                              dropdownDecoration: BoxDecoration(
                                // color: Colors
                                //     .amber,
                                borderRadius: BorderRadius.circular(10),
                                border:
                                    Border.all(color: Colors.white, width: 1),
                              ),
                              items:
                                  YE_Th.map((item) => DropdownMenuItem<String>(
                                        value: '${item}',
                                        child: Text(
                                          '${item}',
                                          textAlign: TextAlign.center,
                                          style: const TextStyle(
                                            overflow: TextOverflow.ellipsis,
                                            fontSize: 14,
                                            color: Colors.grey,
                                          ),
                                        ),
                                      )).toList(),

                              onChanged: (value) async {
                                setState(() {
                                  YE_ = value;
                                });
                                if (Mon_ == null) {
                                } else {
                                  GC_coutumer();
                                }

                                // read_GC_rentalAll();
                              },
                            ),
                          ),
                        ),
                      ],
                    ),

                    Padding(
                      padding: const EdgeInsets.all(8.0),
                      child: Row(
                        children: [
                          // if (Value_selectDate != null &&
                          //     _TransReBillModels.length != 0)
                          InkWell(
                            child: Container(
                              decoration: BoxDecoration(
                                color: Colors.yellow[600],
                                borderRadius: const BorderRadius.only(
                                    topLeft: Radius.circular(10),
                                    topRight: Radius.circular(10),
                                    bottomLeft: Radius.circular(10),
                                    bottomRight: Radius.circular(10)),
                                border:
                                    Border.all(color: Colors.grey, width: 1),
                              ),
                              padding: const EdgeInsets.all(8.0),
                              child: Center(
                                child: Row(
                                  mainAxisAlignment: MainAxisAlignment.center,
                                  children: const [
                                    Text(
                                      'เรียกดู',
                                      style: TextStyle(
                                        color: ReportScreen_Color.Colors_Text1_,
                                        fontWeight: FontWeight.bold,
                                        fontFamily: FontWeight_.Fonts_T,
                                      ),
                                    ),
                                    Icon(
                                      Icons.navigate_next,
                                      color: Colors.grey,
                                    )
                                  ],
                                ),
                              ),
                            ),
                            onTap: (YE_ == null ||
                                    Mon_ == null ||
                                    teNantModels.isEmpty ||
                                    coutumer_total_sum_CM[
                                            teNantModels.length - 1]
                                        .isEmpty)
                                ? null
                                : () async {
                                    Insert_log.Insert_logs(
                                        'รายงาน', 'กดดูรายงานผู้เช่า');
                                    int? show_more;
                                    showDialog<void>(
                                      context: context,
                                      barrierDismissible:
                                          false, // user must tap button!
                                      builder: (BuildContext context) {
                                        return AlertDialog(
                                          shape: const RoundedRectangleBorder(
                                              borderRadius: BorderRadius.all(
                                                  Radius.circular(20.0))),
                                          title: Column(
                                            children: [
                                              const Center(
                                                  child: Text(
                                                'รายงานผู้เช่า',
                                                style: TextStyle(
                                                  color: ReportScreen_Color
                                                      .Colors_Text1_,
                                                  fontWeight: FontWeight.bold,
                                                  fontFamily:
                                                      FontWeight_.Fonts_T,
                                                ),
                                              )),
                                              Row(
                                                children: [
                                                  Expanded(
                                                      flex: 1,
                                                      child: Text(
                                                        (YE_ == null ||
                                                                Mon_ == null)
                                                            ? 'เดือน : ? ( ปี : ? )'
                                                            : 'เดือน : $Mon_ ( ปี : $YE_ )',
                                                        textAlign:
                                                            TextAlign.start,
                                                        style: const TextStyle(
                                                          color:
                                                              ReportScreen_Color
                                                                  .Colors_Text1_,
                                                          fontSize: 14,
                                                          // fontWeight: FontWeight.bold,
                                                          fontFamily:
                                                              FontWeight_
                                                                  .Fonts_T,
                                                        ),
                                                      )),
                                                  Expanded(
                                                      flex: 1,
                                                      child: Text(
                                                        'ทั้งหมด: ${teNantModels.length}',
                                                        textAlign:
                                                            TextAlign.end,
                                                        style: const TextStyle(
                                                          fontSize: 14,
                                                          color:
                                                              ReportScreen_Color
                                                                  .Colors_Text1_,
                                                          // fontWeight: FontWeight.bold,
                                                          fontFamily:
                                                              FontWeight_
                                                                  .Fonts_T,
                                                        ),
                                                      )),
                                                ],
                                              ),
                                              const SizedBox(height: 1),
                                              const Divider(),
                                              const SizedBox(height: 1),
                                            ],
                                          ),
                                          content: StreamBuilder(
                                              stream: Stream.periodic(
                                                  const Duration(seconds: 0)),
                                              builder: (context, snapshot) {
                                                return ScrollConfiguration(
                                                  behavior: ScrollConfiguration
                                                          .of(context)
                                                      .copyWith(dragDevices: {
                                                    PointerDeviceKind.touch,
                                                    PointerDeviceKind.mouse,
                                                  }),
                                                  child: SingleChildScrollView(
                                                    scrollDirection:
                                                        Axis.horizontal,
                                                    child: Row(
                                                      children: [
                                                        Container(
                                                          // color: Colors.grey[50],
                                                          width: (Responsive
                                                                  .isDesktop(
                                                                      context))
                                                              ? MediaQuery.of(
                                                                          context)
                                                                      .size
                                                                      .width *
                                                                  0.9
                                                              : (teNantModels
                                                                          .length ==
                                                                      0)
                                                                  ? MediaQuery.of(
                                                                          context)
                                                                      .size
                                                                      .width
                                                                  : 800,
                                                          // height:
                                                          //     MediaQuery.of(context)
                                                          //             .size
                                                          //             .height *
                                                          //         0.3,
                                                          child: Column(
                                                            children: <Widget>[
                                                              // for (int index1 = 0;
                                                              //     index1 <
                                                              //         _TransReBillModels
                                                              //             .length;
                                                              //     index1++)
                                                              Container(
                                                                  height: MediaQuery.of(
                                                                              context)
                                                                          .size
                                                                          .height *
                                                                      0.58,
                                                                  child: ListView
                                                                      .builder(
                                                                    itemCount:
                                                                        teNantModels
                                                                            .length,
                                                                    itemBuilder:
                                                                        (BuildContext
                                                                                context,
                                                                            int index) {
                                                                      return ListTile(
                                                                        title:
                                                                            SizedBox(
                                                                          child:
                                                                              Column(
                                                                            children: [
                                                                              Container(
                                                                                child: Row(
                                                                                  mainAxisAlignment: MainAxisAlignment.start,
                                                                                  children: [
                                                                                    Container(
                                                                                      decoration: const BoxDecoration(
                                                                                        color: AppbackgroundColor.TiTile_Colors,
                                                                                        borderRadius: BorderRadius.only(topLeft: Radius.circular(5), topRight: Radius.circular(5), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                      ),
                                                                                      padding: const EdgeInsets.all(4.0),
                                                                                      child: Text(
                                                                                        teNantModels[index].cname == null
                                                                                            ? teNantModels[index].cname_q == null
                                                                                                ? ''
                                                                                                : '${index + 1}.${teNantModels[index].cname_q}'
                                                                                            : '${index + 1}.${teNantModels[index].cname}',
                                                                                        style: const TextStyle(
                                                                                          color: ReportScreen_Color.Colors_Text1_,
                                                                                          fontWeight: FontWeight.bold,
                                                                                          fontFamily: FontWeight_.Fonts_T,
                                                                                        ),
                                                                                      ),
                                                                                    ),
                                                                                  ],
                                                                                ),
                                                                              ),
                                                                              if (show_more != index)
                                                                                SizedBox(
                                                                                  child: Column(
                                                                                    children: [
                                                                                      Container(
                                                                                        decoration: BoxDecoration(
                                                                                          color: AppbackgroundColor.TiTile_Colors.withOpacity(0.7),
                                                                                          borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                        ),
                                                                                        // padding: const EdgeInsets.all(4.0),
                                                                                        child: Row(
                                                                                          children: const [
                                                                                            SizedBox(
                                                                                              width: 5,
                                                                                            ),
                                                                                            // Expanded(
                                                                                            //   flex: 1,
                                                                                            //   child: Text(
                                                                                            //     'ลำดับ',
                                                                                            //     //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                            //     //  '${_TransReBillModels[index1].ramtd}',
                                                                                            //     textAlign: TextAlign.center,
                                                                                            //     style: const TextStyle(
                                                                                            //       color: ReportScreen_Color.Colors_Text1_,
                                                                                            //       fontWeight: FontWeight.bold,
                                                                                            //       fontFamily: FontWeight_.Fonts_T,
                                                                                            //     ),
                                                                                            //   ),
                                                                                            // ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                'เลขสัญญา',
                                                                                                //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                //  '${_TransReBillModels[index1].ramtd}',
                                                                                                textAlign: TextAlign.center,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  fontWeight: FontWeight.bold,
                                                                                                  fontFamily: FontWeight_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                'โซน',
                                                                                                //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                //  '${_TransReBillModels[index1].ramtd}',
                                                                                                textAlign: TextAlign.center,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  fontWeight: FontWeight.bold,
                                                                                                  fontFamily: FontWeight_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),

                                                                                            Expanded(
                                                                                              child: Text(
                                                                                                'รหัสพื้นที่',
                                                                                                //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                //  '${_TransReBillModels[index1].ramtd}',
                                                                                                textAlign: TextAlign.center,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  fontWeight: FontWeight.bold,
                                                                                                  fontFamily: FontWeight_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                'ขนาดพื้นที่(ต.ร.ม.)',
                                                                                                //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                //  '${_TransReBillModels[index1].ramtd}',
                                                                                                textAlign: TextAlign.right,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  fontWeight: FontWeight.bold,
                                                                                                  fontFamily: FontWeight_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                'ค่าเช่ารายวัน',
                                                                                                textAlign: TextAlign.right,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  fontWeight: FontWeight.bold,
                                                                                                  fontFamily: FontWeight_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                'โม่',
                                                                                                textAlign: TextAlign.right,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  fontWeight: FontWeight.bold,
                                                                                                  fontFamily: FontWeight_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                'ถัง',
                                                                                                textAlign: TextAlign.right,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  fontWeight: FontWeight.bold,
                                                                                                  fontFamily: FontWeight_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                'เช่าพื้นที่',
                                                                                                textAlign: TextAlign.right,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  fontWeight: FontWeight.bold,
                                                                                                  fontFamily: FontWeight_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                'ค่าไฟ',
                                                                                                textAlign: TextAlign.right,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  fontWeight: FontWeight.bold,
                                                                                                  fontFamily: FontWeight_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),

                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                'รวม',
                                                                                                textAlign: TextAlign.right,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  fontWeight: FontWeight.bold,
                                                                                                  fontFamily: FontWeight_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                '...',
                                                                                                //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                //  '${_TransReBillModels[index1].ramtd}',
                                                                                                textAlign: TextAlign.center,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  fontWeight: FontWeight.bold,
                                                                                                  fontFamily: FontWeight_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                          ],
                                                                                        ),
                                                                                      ),
                                                                                      Container(
                                                                                        decoration: BoxDecoration(
                                                                                          color: Colors.grey[200],
                                                                                          borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                        ),
                                                                                        padding: const EdgeInsets.all(8.0),
                                                                                        child: Row(
                                                                                          children: [
                                                                                            const SizedBox(
                                                                                              width: 5,
                                                                                            ),
                                                                                            // Expanded(
                                                                                            //   flex: 1,
                                                                                            //   child: Text(
                                                                                            //     '${index + 1}',
                                                                                            //     //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                            //     //  '${_TransReBillModels[index1].ramtd}',
                                                                                            //     textAlign: TextAlign.center,
                                                                                            //     style: const TextStyle(
                                                                                            //       color: ReportScreen_Color.Colors_Text1_,
                                                                                            //       // fontWeight: FontWeight.bold,
                                                                                            //       fontFamily: Font_.Fonts_T,
                                                                                            //     ),
                                                                                            //   ),
                                                                                            // ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                '${teNantModels[index].cid}',
                                                                                                //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                //  '${_TransReBillModels[index1].ramtd}',
                                                                                                textAlign: TextAlign.center,
                                                                                                style: const TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  // fontWeight: FontWeight.bold,
                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                '${teNantModels[index].zn}',
                                                                                                //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                //  '${_TransReBillModels[index1].ramtd}',
                                                                                                textAlign: TextAlign.center,
                                                                                                style: const TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  // fontWeight: FontWeight.bold,
                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                teNantModels[index].ln_c == null
                                                                                                    ? teNantModels[index].ln_q == null
                                                                                                        ? ''
                                                                                                        : '${teNantModels[index].ln_q}'
                                                                                                    : '${teNantModels[index].ln_c}',
                                                                                                //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                //  '${_TransReBillModels[index1].ramtd}',
                                                                                                textAlign: TextAlign.center,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  // fontWeight: FontWeight.bold,
                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                teNantModels[index].area_c == null
                                                                                                    ? teNantModels[index].area_q == null
                                                                                                        ? ''
                                                                                                        : '${teNantModels[index].area_q}'
                                                                                                    : '${teNantModels[index].area_c}',
                                                                                                //'${nFormat.format(double.parse(_TransReBillModels[index1].ramtd!))}',
                                                                                                //  '${_TransReBillModels[index1].ramtd}',
                                                                                                textAlign: TextAlign.right,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  // fontWeight: FontWeight.bold,
                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                '${teNantModels[index].rent}',
                                                                                                // '${_TransReBillModels[index1].total_bill}',
                                                                                                textAlign: TextAlign.right,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  // fontWeight: FontWeight.bold,
                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            //                                                                                             late List<List<dynamic>> coutumer_rent_CM;
                                                                                            // late List<List<dynamic>> coutumer_tank_CM;
                                                                                            // late List<List<dynamic>> coutumer_electricity_CM;
                                                                                            // late List<List<dynamic>> coutumer_MOMO_CM;
                                                                                            // late List<List<dynamic>> coutumer_rent_area_CM;
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                (coutumer_MOMO_CM[index].isEmpty) ? '0.00' : '${nFormat.format(double.parse(coutumer_MOMO_CM[index][0]!))}',
                                                                                                // '${ coutumer_MOMO_CM[index]}',
                                                                                                // '0.00',
                                                                                                // '${_TransReBillModels[index1].total_bill}',
                                                                                                textAlign: TextAlign.right,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  // fontWeight: FontWeight.bold,
                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                (coutumer_tank_CM[index].isEmpty) ? '0.00' : '${nFormat.format(double.parse(coutumer_tank_CM[index][0]!))}',
                                                                                                // '${_TransReBillModels[index1].total_bill}',
                                                                                                textAlign: TextAlign.right,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  // fontWeight: FontWeight.bold,
                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                (coutumer_rent_area_CM[index].isEmpty) ? '0.00' : '${nFormat.format(double.parse(coutumer_rent_area_CM[index][0]!))}',
                                                                                                // '${_TransReBillModels[index1].total_bill}',
                                                                                                textAlign: TextAlign.right,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  // fontWeight: FontWeight.bold,
                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                (coutumer_electricity_CM[index].isEmpty) ? '0.00' : '${nFormat.format(double.parse(coutumer_electricity_CM[index][0]!))}',
                                                                                                // '${_TransReBillModels[index1].total_bill}',
                                                                                                textAlign: TextAlign.right,
                                                                                                style: TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  // fontWeight: FontWeight.bold,
                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),

                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Text(
                                                                                                (coutumer_total_sum_CM[index].isEmpty) ? '${nFormat.format(double.parse(teNantModels[index].rent!) + 0.00)}' : '${nFormat.format(double.parse(teNantModels[index].rent!) + double.parse(coutumer_total_sum_CM[index][0]!))}',
                                                                                                // '${_TransReBillModels[index1].total_bill}',
                                                                                                textAlign: TextAlign.right,
                                                                                                style: const TextStyle(
                                                                                                  color: ReportScreen_Color.Colors_Text1_,
                                                                                                  // fontWeight: FontWeight.bold,
                                                                                                  fontFamily: Font_.Fonts_T,
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                            Expanded(
                                                                                              flex: 1,
                                                                                              child: Padding(
                                                                                                padding: const EdgeInsets.all(8.0),
                                                                                                child: Row(
                                                                                                  mainAxisAlignment: MainAxisAlignment.center,
                                                                                                  children: [
                                                                                                    InkWell(
                                                                                                      onTap: () {
                                                                                                        setState(() {
                                                                                                          show_more = index;
                                                                                                        });
                                                                                                      },
                                                                                                      child: Container(
                                                                                                        width: 100,
                                                                                                        decoration: BoxDecoration(
                                                                                                          color: Colors.green[300],
                                                                                                          borderRadius: const BorderRadius.only(topLeft: Radius.circular(10), topRight: Radius.circular(10), bottomLeft: Radius.circular(10), bottomRight: Radius.circular(10)),
                                                                                                        ),
                                                                                                        padding: const EdgeInsets.all(4.0),
                                                                                                        child: const Center(
                                                                                                          child: Text(
                                                                                                            'ดูเพิ่มเติม',
                                                                                                            style: TextStyle(
                                                                                                              color: ReportScreen_Color.Colors_Text1_,
                                                                                                              // fontWeight: FontWeight.bold,
                                                                                                              fontFamily: Font_.Fonts_T,
                                                                                                            ),
                                                                                                          ),
                                                                                                        ),
                                                                                                      ),
                                                                                                    ),
                                                                                                  ],
                                                                                                ),
                                                                                              ),
                                                                                            ),
                                                                                          ],
                                                                                        ),
                                                                                      ),
                                                                                    ],
                                                                                  ),
                                                                                ),
                                                                              if (show_more == index)
                                                                                SizedBox(
                                                                                  child: Column(
                                                                                    children: [
                                                                                      Stack(
                                                                                        children: [
                                                                                          Container(
                                                                                            decoration: BoxDecoration(
                                                                                              color: AppbackgroundColor.TiTile_Colors.withOpacity(0.7),
                                                                                              borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                            ),
                                                                                            padding: const EdgeInsets.all(4.0),
                                                                                            child: Row(
                                                                                              children: [
                                                                                                for (int indax2 = 0; indax2 < 31; indax2++)
                                                                                                  Expanded(
                                                                                                    flex: 1,
                                                                                                    child: Text(
                                                                                                      '${indax2 + 1}',
                                                                                                      textAlign: TextAlign.center,
                                                                                                      style: TextStyle(
                                                                                                        color: ReportScreen_Color.Colors_Text1_,
                                                                                                        fontWeight: FontWeight.bold,
                                                                                                        fontFamily: FontWeight_.Fonts_T,
                                                                                                      ),
                                                                                                    ),
                                                                                                  ),
                                                                                              ],
                                                                                            ),
                                                                                          ),
                                                                                          Positioned(
                                                                                              top: 0,
                                                                                              right: 2,
                                                                                              child: InkWell(
                                                                                                onTap: () {
                                                                                                  setState(() {
                                                                                                    show_more = null;
                                                                                                  });
                                                                                                },
                                                                                                child: const Icon(
                                                                                                  Icons.cancel,
                                                                                                  color: Colors.red,
                                                                                                ),
                                                                                              ))
                                                                                        ],
                                                                                      ),
                                                                                      Container(
                                                                                        decoration: BoxDecoration(
                                                                                          color: Colors.grey[200],
                                                                                          borderRadius: const BorderRadius.only(topLeft: Radius.circular(0), topRight: Radius.circular(0), bottomLeft: Radius.circular(0), bottomRight: Radius.circular(0)),
                                                                                        ),
                                                                                        padding: const EdgeInsets.all(3.0),
                                                                                        child: Row(
                                                                                          children: [
                                                                                            // for (int indax = 0; indax < teNantModels.length; indax++)
                                                                                            for (int indax2 = 0; indax2 < 31; indax2++)
                                                                                              // for (int indax3 = 0; indax3 < custo_TransReBillHistoryModels[index].length; indax2++)
                                                                                              Expanded(
                                                                                                flex: 1,
                                                                                                child: Container(
                                                                                                  decoration: BoxDecoration(
                                                                                                    color: (indax2 % 2 == 0) ? Colors.grey[200] : AppbackgroundColor.Sub_Abg_Colors,

                                                                                                    borderRadius: BorderRadius.only(
                                                                                                      topLeft: Radius.circular(0),
                                                                                                      topRight: Radius.circular(0),
                                                                                                      bottomLeft: Radius.circular(0),
                                                                                                      bottomRight: Radius.circular(0),
                                                                                                    ),
                                                                                                    // border: Border.all(color: Colors.grey, width: 1),
                                                                                                  ),
                                                                                                  padding: const EdgeInsets.all(8.0),
                                                                                                  child: Text(
                                                                                                    (custo_TransReBillHistoryModels[index].isEmpty)
                                                                                                        ? '❌'
                                                                                                        : (indax2 >= custo_TransReBillHistoryModels[index].length)
                                                                                                            ? '❌'
                                                                                                            : '✔️',
                                                                                                    textAlign: TextAlign.center,
                                                                                                    style: TextStyle(
                                                                                                      color: (custo_TransReBillHistoryModels[index].isEmpty)
                                                                                                          ? Colors.red
                                                                                                          : (indax2 >= custo_TransReBillHistoryModels[index].length)
                                                                                                              ? Colors.red
                                                                                                              : Colors.green,
                                                                                                      // fontWeight: FontWeight.bold,
                                                                                                      fontFamily: Font_.Fonts_T,
                                                                                                    ),
                                                                                                  ),
                                                                                                ),
                                                                                              ),
                                                                                          ],
                                                                                        ),
                                                                                      ),
                                                                                    ],
                                                                                  ),
                                                                                )
                                                                            ],
                                                                          ),
                                                                        ),
                                                                      );
                                                                    },
                                                                  )),
                                                            ],
                                                          ),
                                                        ),
                                                      ],
                                                    ),
                                                  ),
                                                );
                                              }),
                                          actions: <Widget>[
                                            const SizedBox(height: 1),
                                            const Divider(),
                                            const SizedBox(height: 1),
                                            Padding(
                                              padding:
                                                  const EdgeInsets.fromLTRB(
                                                      8, 4, 8, 4),
                                              child: SingleChildScrollView(
                                                scrollDirection:
                                                    Axis.horizontal,
                                                child: Row(
                                                  mainAxisAlignment:
                                                      MainAxisAlignment.end,
                                                  children: [
                                                    if (teNantModels.length !=
                                                        0)
                                                      Padding(
                                                        padding:
                                                            const EdgeInsets
                                                                .all(8.0),
                                                        child: InkWell(
                                                          child: Container(
                                                            width: 100,
                                                            decoration:
                                                                const BoxDecoration(
                                                              color:
                                                                  Colors.blue,
                                                              borderRadius: BorderRadius.only(
                                                                  topLeft: Radius
                                                                      .circular(
                                                                          10),
                                                                  topRight: Radius
                                                                      .circular(
                                                                          10),
                                                                  bottomLeft: Radius
                                                                      .circular(
                                                                          10),
                                                                  bottomRight: Radius
                                                                      .circular(
                                                                          10)),
                                                            ),
                                                            padding:
                                                                const EdgeInsets
                                                                    .all(8.0),
                                                            child: const Center(
                                                              child: Text(
                                                                'Export file',
                                                                style:
                                                                    TextStyle(
                                                                  color: Colors
                                                                      .white,
                                                                  fontWeight:
                                                                      FontWeight
                                                                          .bold,
                                                                  fontFamily: Font_
                                                                      .Fonts_T,
                                                                ),
                                                              ),
                                                            ),
                                                          ),
                                                          onTap: () {
                                                            if (teNantModels
                                                                    .length ==
                                                                0) {
                                                            } else {
                                                              setState(() {
                                                                show_more =
                                                                    null;
                                                                Value_Report =
                                                                    'รายงานผู้เช่า';
                                                                Pre_and_Dow =
                                                                    'Download';
                                                              });
                                                              // Navigator.of(
                                                              //         context)
                                                              //     .pop();
                                                              _showMyDialog_SAVE();
                                                            }
                                                          },
                                                        ),
                                                      ),
                                                    Padding(
                                                      padding:
                                                          const EdgeInsets.all(
                                                              8.0),
                                                      child: InkWell(
                                                        child: Container(
                                                          width: 100,
                                                          decoration:
                                                              const BoxDecoration(
                                                            color: Colors.black,
                                                            borderRadius: BorderRadius.only(
                                                                topLeft: Radius
                                                                    .circular(
                                                                        10),
                                                                topRight: Radius
                                                                    .circular(
                                                                        10),
                                                                bottomLeft: Radius
                                                                    .circular(
                                                                        10),
                                                                bottomRight: Radius
                                                                    .circular(
                                                                        10)),
                                                          ),
                                                          padding:
                                                              const EdgeInsets
                                                                  .all(8.0),
                                                          child: const Center(
                                                            child: Text(
                                                              'ปิด',
                                                              style: TextStyle(
                                                                color: Colors
                                                                    .white,
                                                                fontWeight:
                                                                    FontWeight
                                                                        .bold,
                                                                fontFamily: Font_
                                                                    .Fonts_T,
                                                              ),
                                                            ),
                                                          ),
                                                        ),
                                                        onTap: () {
                                                          Navigator.of(context)
                                                              .pop();
                                                        },
                                                      ),
                                                    ),
                                                  ],
                                                ),
                                              ),
                                            ),
                                          ],
                                        );
                                      },
                                    );
                                  },
                          ),
                          // const Padding(
                          //   padding: EdgeInsets.all(8.0),
                          //   child: Text(
                          //     'รายชื่อผู้เช่าประจำปี',
                          //     style: TextStyle(
                          //       color: ReportScreen_Color.Colors_Text2_,
                          //       // fontWeight: FontWeight.bold,
                          //       fontFamily: Font_.Fonts_T,
                          //     ),
                          //   ),
                          // ),
                          (YE_ == null ||
                                  Mon_ == null ||
                                  teNantModels.isEmpty ||
                                  coutumer_total_sum_CM[teNantModels.length - 1]
                                      .isEmpty)
                              ? Padding(
                                  padding: const EdgeInsets.all(8.0),
                                  child: Text(
                                    (YE_ != null &&
                                            teNantModels.isEmpty &&
                                            Mon_ != null)
                                        ? 'รายงานผู้เช่า (ไม่พบข้อมูล ✖️)'
                                        : 'รายงานผู้เช่า',
                                    style: const TextStyle(
                                      color: ReportScreen_Color.Colors_Text2_,
                                      // fontWeight: FontWeight.bold,
                                      fontFamily: Font_.Fonts_T,
                                    ),
                                  ),
                                )
                              : (coutumer_total_sum_CM[teNantModels.length - 1]
                                      .isEmpty)
                                  ? SizedBox(
                                      // height: 20,
                                      child: Row(
                                      children: [
                                        Container(
                                            padding: const EdgeInsets.all(4.0),
                                            child:
                                                const CircularProgressIndicator()),
                                        const Padding(
                                          padding: EdgeInsets.all(8.0),
                                          child: Text(
                                            'กำลังโหลดรายงานผู้เช่า...',
                                            style: TextStyle(
                                              color: ReportScreen_Color
                                                  .Colors_Text2_,
                                              // fontWeight: FontWeight.bold,
                                              fontFamily: Font_.Fonts_T,
                                            ),
                                          ),
                                        ),
                                      ],
                                    ))
                                  : const Padding(
                                      padding: EdgeInsets.all(8.0),
                                      child: Text(
                                        'รายงานผู้เช่า ✔️',
                                        style: TextStyle(
                                          color:
                                              ReportScreen_Color.Colors_Text2_,
                                          // fontWeight: FontWeight.bold,
                                          fontFamily: Font_.Fonts_T,
                                        ),
                                      ),
                                    ),
                        ],
                      ),
                    ),
                  ],
                ),
              ),
            ),
          ],
        ),
      ),
    );
  }

  Widget BodyHome_Web() {
    return Column(
      children: [
        Padding(
          padding: const EdgeInsets.fromLTRB(8, 0, 8, 8),
          child: Row(
            children: [
              Expanded(
                flex: 2,
                child: Padding(
                  padding: const EdgeInsets.all(8.0),
                  child: Container(
                    height: 260,
                    decoration: const BoxDecoration(
                      color: AppbackgroundColor.TiTile_Colors,
                      borderRadius: BorderRadius.only(
                          topLeft: Radius.circular(10),
                          topRight: Radius.circular(10),
                          bottomLeft: Radius.circular(10),
                          bottomRight: Radius.circular(10)),
                    ),
                    padding: const EdgeInsets.all(8.0),
                    child: Column(children: [
                      Row(
                        children: [
                          const Icon(
                            Icons.map,
                            // Icons.next_plan,
                            color: ReportScreen_Color.Colors_Text1_,
                          ),
                          const Padding(
                            padding: EdgeInsets.fromLTRB(8, 8, 2, 8),
                            child: Text(
                              'พื้นที่ให้เช่า',
                              style: TextStyle(
                                color: ReportScreen_Color.Colors_Text1_,
                                fontWeight: FontWeight.bold,
                                fontFamily: FontWeight_.Fonts_T,
                              ),
                            ),
                          ),
                          Padding(
                            padding: const EdgeInsets.fromLTRB(2, 8, 8, 8),
                            child: AutoSizeText(
                              '( พื้นที่เช่าทั้งหมด ${areaModels.length})',
                              minFontSize: 8,
                              maxFontSize: 15,
                              style: const TextStyle(
                                decoration: TextDecoration.underline,
                                color: Colors.black,
                                fontWeight: FontWeight.bold,
                                fontFamily: FontWeight_.Fonts_T,
                              ),
                            ),
                          ),
                        ],
                      ),
                      Row(
                        children: [
                          Expanded(
                            flex: 1,
                            child: Padding(
                              padding: const EdgeInsets.all(8.0),
                              child: Container(
                                height: 180,
                                decoration: const BoxDecoration(
                                  color: Colors.white,
                                  borderRadius: BorderRadius.only(
                                      topLeft: Radius.circular(10),
                                      topRight: Radius.circular(10),
                                      bottomLeft: Radius.circular(10),
                                      bottomRight: Radius.circular(10)),
                                ),
                                padding: const EdgeInsets.all(8.0),
                                child: Column(children: [
                                  const Padding(
                                    padding: EdgeInsets.all(4.0),
                                    child: Text(
                                      'ใกล้หมดสัญญา',
                                      style: TextStyle(
                                        color: ReportScreen_Color.Colors_Text1_,
                                        fontWeight: FontWeight.bold,
                                        fontFamily: FontWeight_.Fonts_T,
                                      ),
                                    ),
                                  ),
                                  const Padding(
                                    padding: EdgeInsets.all(4.0),
                                    child: Text(
                                      '( ภายใน 3 เดือน )',
                                      style: TextStyle(
                                        color: Colors.grey,
                                        // fontWeight: FontWeight.bold,
                                        fontFamily: Font_.Fonts_T,
                                      ),
                                    ),
                                  ),
                                  areaModels1.isEmpty
                                      ? SizedBox(
                                          // height: 50,
                                          child: Column(
                                            mainAxisAlignment:
                                                MainAxisAlignment.center,
                                            children: [
                                              StreamBuilder(
                                                stream: Stream.periodic(
                                                    const Duration(
                                                        milliseconds: 50),
                                                    (i) => i),
                                                builder: (context, snapshot) {
                                                  if (!snapshot.hasData)
                                                    return const Text('');
                                                  double elapsed = double.parse(
                                                          snapshot.data
                                                              .toString()) *
                                                      0.05;
                                                  return Padding(
                                                    padding:
                                                        const EdgeInsets.all(
                                                            8.0),
                                                    child: (elapsed > 2.00)
                                                        ? const Text(
                                                            'ไม่พบข้อมูล',
                                                            style: TextStyle(
                                                                color: ReportScreen_Color
                                                                    .Colors_Text2_,
                                                                fontFamily: Font_
                                                                    .Fonts_T,
                                                                fontSize: 12.0),
                                                          )
                                                        : Column(
                                                            children: [
                                                              Container(
                                                                  // height: 20,
                                                                  child:
                                                                      const CircularProgressIndicator()),
                                                              // Text(
                                                              //   'Time : ${elapsed.toStringAsFixed(2)} seconds',
                                                              //   style: const TextStyle(
                                                              //       color: ReportScreen_Color
                                                              //           .Colors_Text2_,
                                                              //       fontFamily:
                                                              //           Font_
                                                              //               .Fonts_T,
                                                              //       fontSize:
                                                              //           12.0),
                                                              // ),
                                                            ],
                                                          ),
                                                  );
                                                },
                                              ),
                                            ],
                                          ),
                                        )
                                      : SizedBox(
                                          child: Column(
                                            children: [
                                              Padding(
                                                padding:
                                                    const EdgeInsets.all(4.0),
                                                child: Text(
                                                  '${areaModels1.length}',
                                                  maxLines: 1,
                                                  overflow:
                                                      TextOverflow.ellipsis,
                                                  style: const TextStyle(
                                                    fontSize: 20,
                                                    decoration: TextDecoration
                                                        .underline,
                                                    color: Colors.green,
                                                    fontWeight: FontWeight.bold,
                                                    fontFamily:
                                                        FontWeight_.Fonts_T,
                                                  ),
                                                ),
                                              ),
                                              const Padding(
                                                padding: EdgeInsets.all(4.0),
                                                child: Text(
                                                  'พื้นที่',
                                                  style: TextStyle(
                                                    color: Colors.green,
                                                    fontWeight: FontWeight.bold,
                                                    fontFamily:
                                                        FontWeight_.Fonts_T,
                                                  ),
                                                ),
                                              ),
                                            ],
                                          ),
                                        ),
                                ]),
                              ),
                            ),
                          ),
                          Expanded(
                            flex: 1,
                            child: Padding(
                              padding: const EdgeInsets.all(8.0),
                              child: Container(
                                height: 180,
                                decoration: const BoxDecoration(
                                  color: Colors.white,
                                  borderRadius: BorderRadius.only(
                                      topLeft: Radius.circular(10),
                                      topRight: Radius.circular(10),
                                      bottomLeft: Radius.circular(10),
                                      bottomRight: Radius.circular(10)),
                                ),
                                padding: const EdgeInsets.all(8.0),
                                child: Column(children: [
                                  const Padding(
                                    padding: EdgeInsets.all(4.0),
                                    child: Text(
                                      'ว่าง',
                                      style: TextStyle(
                                        color: ReportScreen_Color.Colors_Text1_,
                                        fontWeight: FontWeight.bold,
                                        fontFamily: FontWeight_.Fonts_T,
                                      ),
                                    ),
                                  ),
                                  const Padding(
                                    padding: EdgeInsets.all(4.0),
                                    child: Text(
                                      '( ให้เช่า )',
                                      style: TextStyle(
                                        color: Colors.grey,
                                        // fontWeight: FontWeight.bold,
                                        fontFamily: Font_.Fonts_T,
                                      ),
                                    ),
                                  ),
                                  areaModels2.isEmpty
                                      ? SizedBox(
                                          // height: 50,
                                          child: Column(
                                            mainAxisAlignment:
                                                MainAxisAlignment.center,
                                            children: [
                                              StreamBuilder(
                                                stream: Stream.periodic(
                                                    const Duration(
                                                        milliseconds: 50),
                                                    (i) => i),
                                                builder: (context, snapshot) {
                                                  if (!snapshot.hasData)
                                                    return const Text('');
                                                  double elapsed = double.parse(
                                                          snapshot.data
                                                              .toString()) *
                                                      0.05;
                                                  return Padding(
                                                    padding:
                                                        const EdgeInsets.all(
                                                            8.0),
                                                    child: (elapsed > 2.00)
                                                        ? const Text(
                                                            'ไม่พบข้อมูล',
                                                            style: TextStyle(
                                                                color: ReportScreen_Color
                                                                    .Colors_Text2_,
                                                                fontFamily: Font_
                                                                    .Fonts_T,
                                                                fontSize: 12.0),
                                                          )
                                                        : Column(
                                                            children: [
                                                              Container(
                                                                  // height: 20,
                                                                  child:
                                                                      const CircularProgressIndicator()),
                                                              // Text(
                                                              //   'Time : ${elapsed.toStringAsFixed(2)} seconds',
                                                              //   style: const TextStyle(
                                                              //       color: ReportScreen_Color
                                                              //           .Colors_Text2_,
                                                              //       fontFamily:
                                                              //           Font_
                                                              //               .Fonts_T,
                                                              //       fontSize:
                                                              //           12.0),
                                                              // ),
                                                            ],
                                                          ),
                                                  );
                                                },
                                              ),
                                            ],
                                          ),
                                        )
                                      : SizedBox(
                                          child: Column(
                                            children: [
                                              Padding(
                                                padding:
                                                    const EdgeInsets.all(4.0),
                                                child: Text(
                                                  '${areaModels2.length}',
                                                  maxLines: 1,
                                                  overflow:
                                                      TextOverflow.ellipsis,
                                                  style: const TextStyle(
                                                    fontSize: 20,
                                                    decoration: TextDecoration
                                                        .underline,
                                                    color: Colors.green,
                                                    fontWeight: FontWeight.bold,
                                                    fontFamily:
                                                        FontWeight_.Fonts_T,
                                                  ),
                                                ),
                                              ),
                                              const Padding(
                                                padding: EdgeInsets.all(4.0),
                                                child: Text(
                                                  'พื้นที่',
                                                  style: TextStyle(
                                                    color: Colors.green,
                                                    fontWeight: FontWeight.bold,
                                                    fontFamily:
                                                        FontWeight_.Fonts_T,
                                                  ),
                                                ),
                                              ),
                                            ],
                                          ),
                                        ),
                                ]),
                              ),
                            ),
                          ),
                        ],
                      )
                    ]),
                  ),
                ),
              ),
              Expanded(
                flex: 2,
                child: Padding(
                  padding: const EdgeInsets.all(8.0),
                  child: Container(
                    height: 260,
                    decoration: const BoxDecoration(
                      color: AppbackgroundColor.TiTile_Colors,
                      borderRadius: BorderRadius.only(
                          topLeft: Radius.circular(10),
                          topRight: Radius.circular(10),
                          bottomLeft: Radius.circular(10),
                          bottomRight: Radius.circular(10)),
                    ),
                    padding: const EdgeInsets.all(8.0),
                    child: Column(children: [
                      Row(
                        children: const [
                          Icon(
                            Icons.monetization_on_rounded,
                            // Icons.next_plan,
                            color: ReportScreen_Color.Colors_Text1_,
                          ),
                          Padding(
                            padding: EdgeInsets.all(8.0),
                            child: Text(
                              'ภาพรวมการเงิน',
                              style: TextStyle(
                                color: ReportScreen_Color.Colors_Text1_,
                                fontWeight: FontWeight.bold,
                                fontFamily: FontWeight_.Fonts_T,
                              ),
                            ),
                          ),
                        ],
                      ),
                      Row(
                        children: [
                          Expanded(
                            flex: 1,
                            child: Padding(
                              padding: const EdgeInsets.all(8.0),
                              child: Container(
                                height: 180,
                                decoration: const BoxDecoration(
                                  color: Colors.white,
                                  borderRadius: BorderRadius.only(
                                      topLeft: Radius.circular(10),
                                      topRight: Radius.circular(10),
                                      bottomLeft: Radius.circular(10),
                                      bottomRight: Radius.circular(10)),
                                ),
                                padding: const EdgeInsets.all(8.0),
                                child: Column(children: [
                                  const Padding(
                                    padding: EdgeInsets.all(4.0),
                                    child: Text(
                                      'รวมรายรับ',
                                      style: TextStyle(
                                        color: ReportScreen_Color.Colors_Text1_,
                                        fontWeight: FontWeight.bold,
                                        fontFamily: FontWeight_.Fonts_T,
                                      ),
                                    ),
                                  ),
                                  const Padding(
                                    padding: EdgeInsets.all(4.0),
                                    child: Text(
                                      '( ชำระแล้ว)',
                                      style: TextStyle(
                                        color: Colors.grey,
                                        // fontWeight: FontWeight.bold,
                                        fontFamily: Font_.Fonts_T,
                                      ),
                                    ),
                                  ),
                                  sCReportTotalModels.isEmpty
                                      ? SizedBox(
                                          // height: 50,
                                          child: Column(
                                            mainAxisAlignment:
                                                MainAxisAlignment.center,
                                            children: [
                                              StreamBuilder(
                                                stream: Stream.periodic(
                                                    const Duration(
                                                        milliseconds: 50),
                                                    (i) => i),
                                                builder: (context, snapshot) {
                                                  if (!snapshot.hasData)
                                                    return const Text('');
                                                  double elapsed = double.parse(
                                                          snapshot.data
                                                              .toString()) *
                                                      0.05;
                                                  return Padding(
                                                    padding:
                                                        const EdgeInsets.all(
                                                            8.0),
                                                    child: (elapsed > 2.00)
                                                        ? const Text(
                                                            'ไม่พบข้อมูล',
                                                            style: TextStyle(
                                                                color: ReportScreen_Color
                                                                    .Colors_Text2_,
                                                                fontFamily: Font_
                                                                    .Fonts_T,
                                                                fontSize: 12.0),
                                                          )
                                                        : Column(
                                                            children: [
                                                              Container(
                                                                  // height: 20,
                                                                  child:
                                                                      const CircularProgressIndicator()),
                                                              // Text(
                                                              //   'Time : ${elapsed.toStringAsFixed(2)} seconds',
                                                              //   style: const TextStyle(
                                                              //       color: ReportScreen_Color
                                                              //           .Colors_Text2_,
                                                              //       fontFamily:
                                                              //           Font_
                                                              //               .Fonts_T,
                                                              //       fontSize:
                                                              //           12.0),
                                                              // ),
                                                            ],
                                                          ),
                                                  );
                                                },
                                              ),
                                            ],
                                          ),
                                        )
                                      : SizedBox(
                                          child: Column(
                                            children: [
                                              Padding(
                                                padding:
                                                    const EdgeInsets.all(4.0),
                                                child: Text(
                                                  '${nFormat.format(double.parse(total1_.toString()))}',
                                                  maxLines: 1,
                                                  overflow:
                                                      TextOverflow.ellipsis,
                                                  style: const TextStyle(
                                                    fontSize: 20,
                                                    decoration: TextDecoration
                                                        .underline,
                                                    color: Colors.green,
                                                    fontWeight: FontWeight.bold,
                                                    fontFamily:
                                                        FontWeight_.Fonts_T,
                                                  ),
                                                ),
                                              ),
                                              const Padding(
                                                padding: EdgeInsets.all(4.0),
                                                child: Text(
                                                  'บาท',
                                                  style: TextStyle(
                                                    color: Colors.green,
                                                    fontWeight: FontWeight.bold,
                                                    fontFamily:
                                                        FontWeight_.Fonts_T,
                                                  ),
                                                ),
                                              ),
                                            ],
                                          ),
                                        ),
                                ]),
                              ),
                            ),
                          ),
                          Expanded(
                            flex: 1,
                            child: Padding(
                              padding: const EdgeInsets.all(8.0),
                              child: Container(
                                height: 180,
                                decoration: const BoxDecoration(
                                  color: Colors.white,
                                  borderRadius: BorderRadius.only(
                                      topLeft: Radius.circular(10),
                                      topRight: Radius.circular(10),
                                      bottomLeft: Radius.circular(10),
                                      bottomRight: Radius.circular(10)),
                                ),
                                padding: const EdgeInsets.all(8.0),
                                child: Column(children: [
                                  const Padding(
                                    padding: EdgeInsets.all(4.0),
                                    child: Text(
                                      'รวมรายรับ',
                                      style: TextStyle(
                                        color: ReportScreen_Color.Colors_Text1_,
                                        fontWeight: FontWeight.bold,
                                        fontFamily: FontWeight_.Fonts_T,
                                      ),
                                    ),
                                  ),
                                  const Padding(
                                    padding: EdgeInsets.all(4.0),
                                    child: Text(
                                      '( ทั้งหมด)',
                                      style: TextStyle(
                                        color: Colors.grey,
                                        // fontWeight: FontWeight.bold,
                                        fontFamily: Font_.Fonts_T,
                                      ),
                                    ),
                                  ),
                                  sCReportTotalModels2.isEmpty
                                      ? SizedBox(
                                          // height: 50,
                                          child: Column(
                                            mainAxisAlignment:
                                                MainAxisAlignment.center,
                                            children: [
                                              StreamBuilder(
                                                stream: Stream.periodic(
                                                    const Duration(
                                                        milliseconds: 50),
                                                    (i) => i),
                                                builder: (context, snapshot) {
                                                  if (!snapshot.hasData)
                                                    return const Text('');
                                                  double elapsed = double.parse(
                                                          snapshot.data
                                                              .toString()) *
                                                      0.05;
                                                  return Padding(
                                                    padding:
                                                        const EdgeInsets.all(
                                                            8.0),
                                                    child: (elapsed > 2.00)
                                                        ? const Text(
                                                            'ไม่พบข้อมูล',
                                                            style: TextStyle(
                                                                color: ReportScreen_Color
                                                                    .Colors_Text2_,
                                                                fontFamily: Font_
                                                                    .Fonts_T,
                                                                fontSize: 12.0),
                                                          )
                                                        : Column(
                                                            children: [
                                                              Container(
                                                                  // height: 20,
                                                                  child:
                                                                      const CircularProgressIndicator()),
                                                              // Text(
                                                              //   'Time : ${elapsed.toStringAsFixed(2)} seconds',
                                                              //   style: const TextStyle(
                                                              //       color: ReportScreen_Color
                                                              //           .Colors_Text2_,
                                                              //       fontFamily:
                                                              //           Font_
                                                              //               .Fonts_T,
                                                              //       fontSize:
                                                              //           12.0),
                                                              // ),
                                                            ],
                                                          ),
                                                  );
                                                },
                                              ),
                                            ],
                                          ),
                                        )
                                      : SizedBox(
                                          child: Column(
                                            children: [
                                              Padding(
                                                padding:
                                                    const EdgeInsets.all(4.0),
                                                child: Text(
                                                  '${nFormat.format(double.parse(total2_.toString()))}',
                                                  // '${sCReportTotalModels[0].total}',
                                                  maxLines: 1,
                                                  overflow:
                                                      TextOverflow.ellipsis,
                                                  style: const TextStyle(
                                                    fontSize: 20,
                                                    decoration: TextDecoration
                                                        .underline,
                                                    color: Colors.green,
                                                    fontWeight: FontWeight.bold,
                                                    fontFamily:
                                                        FontWeight_.Fonts_T,
                                                  ),
                                                ),
                                              ),
                                              const Padding(
                                                padding: EdgeInsets.all(4.0),
                                                child: Text(
                                                  'บาท',
                                                  style: TextStyle(
                                                    color: Colors.green,
                                                    fontWeight: FontWeight.bold,
                                                    fontFamily:
                                                        FontWeight_.Fonts_T,
                                                  ),
                                                ),
                                              ),
                                            ],
                                          ),
                                        ),
                                ]),
                              ),
                            ),
                          ),
                        ],
                      )
                    ]),
                  ),
                ),
              ),
            ],
          ),
        ),
      ],
    );
  }

  Widget BodyHome_mobile() {
    return Column(
      children: [
        Padding(
          padding: const EdgeInsets.all(8.0),
          child: Container(
            height: 500,
            decoration: const BoxDecoration(
              color: AppbackgroundColor.TiTile_Colors,
              borderRadius: BorderRadius.only(
                  topLeft: Radius.circular(10),
                  topRight: Radius.circular(10),
                  bottomLeft: Radius.circular(10),
                  bottomRight: Radius.circular(10)),
            ),
            padding: const EdgeInsets.all(8.0),
            child: Column(children: [
              Row(
                children: [
                  const Icon(
                    Icons.map,
                    // Icons.next_plan,
                    color: ReportScreen_Color.Colors_Text1_,
                  ),
                  const Padding(
                    padding: EdgeInsets.fromLTRB(8, 8, 2, 8),
                    child: Text(
                      'พื้นที่ให้เช่า',
                      style: TextStyle(
                        color: ReportScreen_Color.Colors_Text1_,
                        fontWeight: FontWeight.bold,
                        fontFamily: FontWeight_.Fonts_T,
                      ),
                    ),
                  ),
                  Padding(
                    padding: const EdgeInsets.fromLTRB(2, 8, 8, 8),
                    child: AutoSizeText(
                      '( พื้นที่เช่าทั้งหมด ${areaModels.length})',
                      minFontSize: 8,
                      maxFontSize: 15,
                      style: const TextStyle(
                        decoration: TextDecoration.underline,
                        color: Colors.black,
                        fontWeight: FontWeight.bold,
                        fontFamily: FontWeight_.Fonts_T,
                      ),
                    ),
                  ),
                ],
              ),
              Row(
                children: [
                  Expanded(
                    flex: 1,
                    child: Padding(
                      padding: const EdgeInsets.all(8.0),
                      child: Container(
                        height: 180,
                        decoration: const BoxDecoration(
                          color: Colors.white,
                          borderRadius: BorderRadius.only(
                              topLeft: Radius.circular(10),
                              topRight: Radius.circular(10),
                              bottomLeft: Radius.circular(10),
                              bottomRight: Radius.circular(10)),
                        ),
                        padding: const EdgeInsets.all(8.0),
                        child: Column(children: [
                          const Padding(
                            padding: EdgeInsets.all(4.0),
                            child: Text(
                              'ใกล้หมดสัญญา',
                              style: TextStyle(
                                color: ReportScreen_Color.Colors_Text1_,
                                fontWeight: FontWeight.bold,
                                fontFamily: FontWeight_.Fonts_T,
                              ),
                            ),
                          ),
                          const Padding(
                            padding: EdgeInsets.all(4.0),
                            child: Text(
                              '( ภายใน 3 เดือน )',
                              style: TextStyle(
                                color: Colors.grey,
                                // fontWeight: FontWeight.bold,
                                fontFamily: Font_.Fonts_T,
                              ),
                            ),
                          ),
                          areaModels1.isEmpty
                              ? SizedBox(
                                  // height: 50,
                                  child: Column(
                                    mainAxisAlignment: MainAxisAlignment.center,
                                    children: [
                                      StreamBuilder(
                                        stream: Stream.periodic(
                                            const Duration(milliseconds: 50),
                                            (i) => i),
                                        builder: (context, snapshot) {
                                          if (!snapshot.hasData)
                                            return const Text('');
                                          double elapsed = double.parse(
                                                  snapshot.data.toString()) *
                                              0.05;
                                          return Padding(
                                            padding: const EdgeInsets.all(8.0),
                                            child: (elapsed > 2.00)
                                                ? const Text(
                                                    'ไม่พบข้อมูล',
                                                    style: TextStyle(
                                                        color:
                                                            ReportScreen_Color
                                                                .Colors_Text2_,
                                                        fontFamily:
                                                            Font_.Fonts_T,
                                                        fontSize: 12.0),
                                                  )
                                                : Column(
                                                    children: [
                                                      Container(
                                                          // height: 20,
                                                          child:
                                                              const CircularProgressIndicator()),
                                                      // Text(
                                                      //   'Time : ${elapsed.toStringAsFixed(2)} seconds',
                                                      //   style: const TextStyle(
                                                      //       color: ReportScreen_Color
                                                      //           .Colors_Text2_,
                                                      //       fontFamily:
                                                      //           Font_.Fonts_T,
                                                      //       fontSize: 12.0),
                                                      // ),
                                                    ],
                                                  ),
                                          );
                                        },
                                      ),
                                    ],
                                  ),
                                )
                              : SizedBox(
                                  child: Column(
                                    children: [
                                      Padding(
                                        padding: const EdgeInsets.all(4.0),
                                        child: Text(
                                          '${areaModels1.length}',
                                          maxLines: 1,
                                          overflow: TextOverflow.ellipsis,
                                          style: const TextStyle(
                                            fontSize: 20,
                                            decoration:
                                                TextDecoration.underline,
                                            color: Colors.green,
                                            fontWeight: FontWeight.bold,
                                            fontFamily: FontWeight_.Fonts_T,
                                          ),
                                        ),
                                      ),
                                      const Padding(
                                        padding: EdgeInsets.all(4.0),
                                        child: Text(
                                          'พื้นที่',
                                          style: TextStyle(
                                            color: Colors.green,
                                            fontWeight: FontWeight.bold,
                                            fontFamily: FontWeight_.Fonts_T,
                                          ),
                                        ),
                                      ),
                                    ],
                                  ),
                                ),
                        ]),
                      ),
                    ),
                  ),
                  Expanded(
                    flex: 1,
                    child: Padding(
                      padding: const EdgeInsets.all(8.0),
                      child: Container(
                        height: 180,
                        decoration: const BoxDecoration(
                          color: Colors.white,
                          borderRadius: BorderRadius.only(
                              topLeft: Radius.circular(10),
                              topRight: Radius.circular(10),
                              bottomLeft: Radius.circular(10),
                              bottomRight: Radius.circular(10)),
                        ),
                        padding: const EdgeInsets.all(8.0),
                        child: Column(children: [
                          const Padding(
                            padding: EdgeInsets.all(4.0),
                            child: Text(
                              'ว่าง',
                              style: TextStyle(
                                color: ReportScreen_Color.Colors_Text1_,
                                fontWeight: FontWeight.bold,
                                fontFamily: FontWeight_.Fonts_T,
                              ),
                            ),
                          ),
                          const Padding(
                            padding: EdgeInsets.all(4.0),
                            child: Text(
                              '( ให้เช่า )',
                              style: TextStyle(
                                color: Colors.grey,
                                // fontWeight: FontWeight.bold,
                                fontFamily: Font_.Fonts_T,
                              ),
                            ),
                          ),
                          areaModels2.isEmpty
                              ? SizedBox(
                                  // height: 50,
                                  child: Column(
                                    mainAxisAlignment: MainAxisAlignment.center,
                                    children: [
                                      StreamBuilder(
                                        stream: Stream.periodic(
                                            const Duration(milliseconds: 50),
                                            (i) => i),
                                        builder: (context, snapshot) {
                                          if (!snapshot.hasData)
                                            return const Text('');
                                          double elapsed = double.parse(
                                                  snapshot.data.toString()) *
                                              0.05;
                                          return Padding(
                                            padding: const EdgeInsets.all(8.0),
                                            child: (elapsed > 2.00)
                                                ? const Text(
                                                    'ไม่พบข้อมูล',
                                                    style: TextStyle(
                                                        color:
                                                            ReportScreen_Color
                                                                .Colors_Text2_,
                                                        fontFamily:
                                                            Font_.Fonts_T,
                                                        fontSize: 12.0),
                                                  )
                                                : Column(
                                                    children: [
                                                      Container(
                                                          // height: 20,
                                                          child:
                                                              const CircularProgressIndicator()),
                                                      // Text(
                                                      //   'Time : ${elapsed.toStringAsFixed(2)} seconds',
                                                      //   style: const TextStyle(
                                                      //       color: ReportScreen_Color
                                                      //           .Colors_Text2_,
                                                      //       fontFamily:
                                                      //           Font_.Fonts_T,
                                                      //       fontSize: 12.0),
                                                      // ),
                                                    ],
                                                  ),
                                          );
                                        },
                                      ),
                                    ],
                                  ),
                                )
                              : SizedBox(
                                  child: Column(
                                    children: [
                                      Padding(
                                        padding: const EdgeInsets.all(4.0),
                                        child: Text(
                                          '${areaModels2.length}',
                                          maxLines: 1,
                                          overflow: TextOverflow.ellipsis,
                                          style: const TextStyle(
                                            fontSize: 20,
                                            decoration:
                                                TextDecoration.underline,
                                            color: Colors.green,
                                            fontWeight: FontWeight.bold,
                                            fontFamily: FontWeight_.Fonts_T,
                                          ),
                                        ),
                                      ),
                                      const Padding(
                                        padding: EdgeInsets.all(4.0),
                                        child: Text(
                                          'พื้นที่',
                                          style: TextStyle(
                                            color: Colors.green,
                                            fontWeight: FontWeight.bold,
                                            fontFamily: FontWeight_.Fonts_T,
                                          ),
                                        ),
                                      ),
                                    ],
                                  ),
                                ),
                        ]),
                      ),
                    ),
                  ),
                ],
              ),
              Row(
                children: const [
                  Icon(
                    Icons.monetization_on_rounded,
                    // Icons.next_plan,
                    color: ReportScreen_Color.Colors_Text1_,
                  ),
                  Padding(
                    padding: EdgeInsets.all(8.0),
                    child: Text(
                      'ภาพรวมการเงิน',
                      style: TextStyle(
                        color: ReportScreen_Color.Colors_Text1_,
                        fontWeight: FontWeight.bold,
                        fontFamily: FontWeight_.Fonts_T,
                      ),
                    ),
                  ),
                ],
              ),
              Row(
                children: [
                  Expanded(
                    flex: 1,
                    child: Padding(
                      padding: const EdgeInsets.all(8.0),
                      child: Container(
                        height: 180,
                        decoration: const BoxDecoration(
                          color: Colors.white,
                          borderRadius: BorderRadius.only(
                              topLeft: Radius.circular(10),
                              topRight: Radius.circular(10),
                              bottomLeft: Radius.circular(10),
                              bottomRight: Radius.circular(10)),
                        ),
                        padding: const EdgeInsets.all(8.0),
                        child: Column(children: [
                          const Padding(
                            padding: EdgeInsets.all(4.0),
                            child: Text(
                              'รวมรายรับ',
                              style: TextStyle(
                                color: ReportScreen_Color.Colors_Text1_,
                                fontWeight: FontWeight.bold,
                                fontFamily: FontWeight_.Fonts_T,
                              ),
                            ),
                          ),
                          const Padding(
                            padding: EdgeInsets.all(4.0),
                            child: Text(
                              '( ชำระแล้ว)',
                              style: TextStyle(
                                color: Colors.grey,
                                // fontWeight: FontWeight.bold,
                                fontFamily: Font_.Fonts_T,
                              ),
                            ),
                          ),
                          sCReportTotalModels.isEmpty
                              ? SizedBox(
                                  // height: 50,
                                  child: Column(
                                    mainAxisAlignment: MainAxisAlignment.center,
                                    children: [
                                      StreamBuilder(
                                        stream: Stream.periodic(
                                            const Duration(milliseconds: 50),
                                            (i) => i),
                                        builder: (context, snapshot) {
                                          if (!snapshot.hasData)
                                            return const Text('');
                                          double elapsed = double.parse(
                                                  snapshot.data.toString()) *
                                              0.05;
                                          return Padding(
                                            padding: const EdgeInsets.all(8.0),
                                            child: (elapsed > 2.00)
                                                ? const Text(
                                                    'ไม่พบข้อมูล',
                                                    style: TextStyle(
                                                        color:
                                                            ReportScreen_Color
                                                                .Colors_Text2_,
                                                        fontFamily:
                                                            Font_.Fonts_T,
                                                        fontSize: 12.0),
                                                  )
                                                : Column(
                                                    children: [
                                                      Container(
                                                          // height: 20,
                                                          child:
                                                              const CircularProgressIndicator()),
                                                      // Text(
                                                      //   'Time : ${elapsed.toStringAsFixed(2)} seconds',
                                                      //   style: const TextStyle(
                                                      //       color: ReportScreen_Color
                                                      //           .Colors_Text2_,
                                                      //       fontFamily:
                                                      //           Font_.Fonts_T,
                                                      //       fontSize: 12.0),
                                                      // ),
                                                    ],
                                                  ),
                                          );
                                        },
                                      ),
                                    ],
                                  ),
                                )
                              : SizedBox(
                                  child: Column(
                                    children: [
                                      Padding(
                                        padding: const EdgeInsets.all(4.0),
                                        child: Text(
                                          '${nFormat.format(double.parse(total1_.toString()))}',
                                          maxLines: 1,
                                          overflow: TextOverflow.ellipsis,
                                          style: const TextStyle(
                                            fontSize: 20,
                                            decoration:
                                                TextDecoration.underline,
                                            color: Colors.green,
                                            fontWeight: FontWeight.bold,
                                            fontFamily: FontWeight_.Fonts_T,
                                          ),
                                        ),
                                      ),
                                      const Padding(
                                        padding: EdgeInsets.all(4.0),
                                        child: Text(
                                          'บาท',
                                          style: TextStyle(
                                            color: Colors.green,
                                            fontWeight: FontWeight.bold,
                                            fontFamily: FontWeight_.Fonts_T,
                                          ),
                                        ),
                                      ),
                                    ],
                                  ),
                                ),
                        ]),
                      ),
                    ),
                  ),
                  Expanded(
                    flex: 1,
                    child: Padding(
                      padding: const EdgeInsets.all(8.0),
                      child: Container(
                        height: 180,
                        decoration: const BoxDecoration(
                          color: Colors.white,
                          borderRadius: BorderRadius.only(
                              topLeft: Radius.circular(10),
                              topRight: Radius.circular(10),
                              bottomLeft: Radius.circular(10),
                              bottomRight: Radius.circular(10)),
                        ),
                        padding: const EdgeInsets.all(8.0),
                        child: Column(children: [
                          const Padding(
                            padding: EdgeInsets.all(4.0),
                            child: Text(
                              'รวมรายรับ',
                              style: TextStyle(
                                color: ReportScreen_Color.Colors_Text1_,
                                fontWeight: FontWeight.bold,
                                fontFamily: FontWeight_.Fonts_T,
                              ),
                            ),
                          ),
                          const Padding(
                            padding: EdgeInsets.all(4.0),
                            child: Text(
                              '( ทั้งหมด)',
                              style: TextStyle(
                                color: Colors.grey,
                                // fontWeight: FontWeight.bold,
                                fontFamily: Font_.Fonts_T,
                              ),
                            ),
                          ),
                          sCReportTotalModels2.isEmpty
                              ? SizedBox(
                                  // height: 50,
                                  child: Column(
                                    mainAxisAlignment: MainAxisAlignment.center,
                                    children: [
                                      StreamBuilder(
                                        stream: Stream.periodic(
                                            const Duration(milliseconds: 50),
                                            (i) => i),
                                        builder: (context, snapshot) {
                                          if (!snapshot.hasData)
                                            return const Text('');
                                          double elapsed = double.parse(
                                                  snapshot.data.toString()) *
                                              0.05;
                                          return Padding(
                                            padding: const EdgeInsets.all(8.0),
                                            child: (elapsed > 2.00)
                                                ? const Text(
                                                    'ไม่พบข้อมูล',
                                                    style: TextStyle(
                                                        color:
                                                            ReportScreen_Color
                                                                .Colors_Text2_,
                                                        fontFamily:
                                                            Font_.Fonts_T,
                                                        fontSize: 12.0),
                                                  )
                                                : Column(
                                                    children: [
                                                      Container(
                                                          // height: 20,
                                                          child:
                                                              const CircularProgressIndicator()),
                                                      // Text(
                                                      //   'Time : ${elapsed.toStringAsFixed(2)} seconds',
                                                      //   style: const TextStyle(
                                                      //       color: ReportScreen_Color
                                                      //           .Colors_Text2_,
                                                      //       fontFamily:
                                                      //           Font_.Fonts_T,
                                                      //       fontSize: 12.0),
                                                      // ),
                                                    ],
                                                  ),
                                          );
                                        },
                                      ),
                                    ],
                                  ),
                                )
                              : SizedBox(
                                  child: Column(
                                    children: [
                                      Padding(
                                        padding: const EdgeInsets.all(4.0),
                                        child: Text(
                                          '${nFormat.format(double.parse(total2_.toString()))}',
                                          maxLines: 1,
                                          overflow: TextOverflow.ellipsis,
                                          style: const TextStyle(
                                            fontSize: 20,
                                            decoration:
                                                TextDecoration.underline,
                                            color: Colors.green,
                                            fontWeight: FontWeight.bold,
                                            fontFamily: FontWeight_.Fonts_T,
                                          ),
                                        ),
                                      ),
                                      const Padding(
                                        padding: EdgeInsets.all(4.0),
                                        child: Text(
                                          'บาท',
                                          style: TextStyle(
                                            color: Colors.green,
                                            fontWeight: FontWeight.bold,
                                            fontFamily: FontWeight_.Fonts_T,
                                          ),
                                        ),
                                      ),
                                    ],
                                  ),
                                ),
                        ]),
                      ),
                    ),
                  ),
                ],
              ),
            ]),
          ),
        ),
      ],
    );
  }
}

///////////----------------------------------------->
class PreviewReportScreen extends StatelessWidget {
  final pw.Document doc;
  final Status_;
  PreviewReportScreen({super.key, required this.doc, this.Status_});

  static const customSwatch = MaterialColor(
    0xFF8DB95A,
    <int, Color>{
      50: Color(0xFFC2FD7F),
      100: Color(0xFFB6EE77),
      200: Color(0xFFB2E875),
      300: Color(0xFFACDF71),
      400: Color(0xFFA7DA6E),
      500: Color(0xFFA1D16A),
      600: Color(0xFF94BF62),
      700: Color(0xFF90B961),
      800: Color(0xFF85AB5A),
      900: Color(0xFF7A9B54),
    },
  );
  String day_ =
      '${DateTime.now().day}-${DateTime.now().month}-${DateTime.now().year}';

  String Tim_ =
      '${DateTime.now().hour}.${DateTime.now().minute}.${DateTime.now().second}';
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      // title: 'Flutter Demo',
      theme: ThemeData(
        primarySwatch: customSwatch,
      ),
      debugShowCheckedModeBanner: false,
      home: Scaffold(
        appBar: AppBar(
          // backgroundColor: Color.fromARGB(255, 141, 185, 90),
          leading: IconButton(
            onPressed: () async {
              SharedPreferences preferences =
                  await SharedPreferences.getInstance();

              String? _route = preferences.getString('route');
              MaterialPageRoute materialPageRoute = MaterialPageRoute(
                  builder: (BuildContext context) =>
                      AdminScafScreen(route: _route));
              Navigator.pushAndRemoveUntil(
                  context, materialPageRoute, (route) => false);
            },
            icon: const Icon(
              Icons.arrow_back_outlined,
              color: Colors.white,
            ),
          ),
          centerTitle: true,
          title: Text(
            "${Status_}",
            style: const TextStyle(
                color: Colors.white, fontFamily: FontWeight_.Fonts_T),
          ),
        ),
        body: PdfPreview(
          build: (format) => doc.save(),
          allowSharing: false,
          allowPrinting: true, canChangePageFormat: false,
          canChangeOrientation: false, canDebug: false,
          maxPageWidth: MediaQuery.of(context).size.width * 0.6,
          // scrollViewDecoration:,
          initialPageFormat: PdfPageFormat.a4,
          pdfFileName: "${Status_}[$day_].pdf",
        ),
      ),
    );
  }
}

// เฉพาะของ user: กาดประตูเชียงใหม่

// สิ่งที่ต้องเพิ่ม:
// (เดี๋ยวพี่ทำไฟล์ตัวอย่างรายงานไปให้)
// 1. รายงานสรุปรายวัน /
// 2. สรุปรายรับรายวันแยกตาม user 
// 3. รายงานประจำสัปดาห์ (ทุก 5 วัน)
// 4. รายงานประจำเดือน (ทุกเดือน)
// 5. รายงานสรุปผู้เช่า (รายเดือน) /

// คำถามจากลูกค้า:
// 1. สามารถปริ๊นเป็น QR Code ไปติดหน้าแผงร้านค้าได้มั้ย > ตอนจะเดินเก็บค่าแผง ให้ใช้ระบบสแกน QR  พอสแกนแล้วเด้งไปที่หน้า รับชำระ ของ
